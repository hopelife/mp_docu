Problem Books in Mathematics

Edited by K. Bencsath\ P.R. Halmos

Springer\ *New York*\ *Berlin*\ *Heidelberg*\ *Barcelona*\ *Hong Kong*\ *London*\ *Milan*\ *Paris*\ *Singapore*\ *Tokyo*

![](media/image3.png){width="5.0152777777777775in"
height="8.382154418197725in"}

Problem Books in Mathematics

**Series Editors: K. Bencsdth and P.R. Halmos**

**Polynomials**\ by *Edward J. Barbeau*

**Problems in Geometry**\ by *Marcel Berger, Pierre Pansu, Jean-Pic Berry, and Xavier Saint-Raymond*

**Problem Book for First Year Calculus** by *George W. Bluman*

**Exercises in Probability**\ by *T. CacouUos*

**An Introduction to HUbert Space and Quantum Logic** by *David W.
Cohen*

**Unsolved Problems in Geometry**\ by *Mallard T. Croft, Kenneth J. Falconer, and Richard K. Guy*

**Problem-Solving Strategies**\ by *Arthur Engel*

**Problems in Analysis**\ by *Bernard R. Gelbaum*

**Problems in Real and Complex Analysis** by *Bernard R. Gelbaum*

**Theorems and Counterexamples in Mathematics** by *Bernard R. Gelbaum and John M.H. Olmsted*

**Exercises in Integration**\ by *Claude George*

**Algebraic Logic**\ by *S.G. Gindikin*

**Unsolved Problems in Number Theory (2nd ed.)** by *Richard K. Guy*

*(continued after index)*

Arthur Engel

**Problem-Solving Strategies**

With 223 Figures

1 3

Angel Engel\ Institut f¨ur Didaktik der Mathematik\ Johann Wolfgang Goethe--Universit¨at Frankfurt am Main Senckenberganlage 9--11\ 60054 Frankfurt am Main 11\ Germany

*Series Editor:*\ Paul R. Halmos\ Department of Mathematics\ Santa Clara University\ Santa Clara, CA 95053\ USA

Mathematics Subject Classification (1991): 00A07

Library of Congress Cataloging-in-Publication Data

Engel, Arthur.

Problem-solving strategies/Arthur Engel.

p. cm. --- (Problem books in mathematics)\ Includes index.

ISBN 0-387-98219-1 (softcover: alk. paper)\ 1. Problem solving. I. Title. II. Series.

1997 QA63.E54\ 510′.76---dc21 97-10090

© 1998 Springer-Verlag New York, Inc.

All rights reserved. This work may not be translated or copied in whole or in part without the written permission of the publisher (Springer-Verlag New York, Inc., 175 Fifth Avenue, New York, NY 10010, USA), except for brief excerpts in connection with reviews or scholarly analysis. Use in connection with any form of information storage and retrieval, electronic adaptation, computer software, or by similar or dissimilar methodology now known or hereafter developed is forbidden.

The use of general descriptive names, trade names, trademarks, etc., in this publication, even if the former are not especially identified, is not to be taken as a sign that such names, as understood by the Trade Marks and Merchandise Marks Act, may accordinly be used freely by anyone.

ISBN 0--387--98219--1 Springer-Verlag New York Berlin Heidelburg SPIN 10557554

Preface

This book is an outgrowth of the training of the German IMO team from a time when we had only a short training time of 14 days, including 6 half-day tests. This has forced upon us a training of enormous compactness. "Great Ideas" were the leading principles. A huge number of problems were selected to illustrate these principles. Not only topics but also ideas were efficient means of classification. For whom is this book written?

• For trainers and participants of contests of all kinds up to the highest level of international competitions, including the IMO and the Putnam Competition.

• For the regular high school teacher, who is conducting a mathematics club and is looking for ideas and problems for his/her club. Here, he/she will find problems of any level from very simple ones to the most difficult problems ever proposed at any competition.

• For high school teachers who want to pose *the problem of the week, problem ofthemonth,* and*researchproblemsoftheyear.* Thisisnotsoeasy.Manyfail, but some persevere, and after a while they succeed and generate a creative atmosphere with continuous discussions of mathematical problems.

• For the regular high school teacher, who is just looking for ideas to enrich his/her teaching by some interesting nonroutine problems.

• For all those who are interested in solving tough and interesting problems.

The book is organized into chapters. Each chapter starts with typical examples illustrating the main ideas followed by many problems and their solutions. The

vi Preface

solutions are sometimes just hints, giving away the main idea leading to the solution. In this way, it was possible to increase the number of examples and problems to over 1300. The reader can increase the effectiveness of the book even more by trying to solve the examples.

The problems are almost exclusively competition problems from all over the world. Most of them are from the former USSR, some from Hungary, and some from Western countries, especially from the German National Competition. The competition problems are usually variations of problems from journals with problem sections. So it is not always easy to give credit to the originators of the problem. If you see a beautiful problem, you first wonder at the creativity of the problem proposer.
Later you discover the result in an earlier source. For this reason, the references to competitions are somewhat sporadic. Usually no source is given if I have known the problem for more than 25 years. Anyway, most of the problems are results that are known to experts in the respective fields.

There is a huge literature of mathematical problems. But, as a trainer, I know that there can never be enough problems. You are always in desperate need of new problems or old problems with new solutions. Any new problem book has some new problems, and a big book, as this one, usually has quite a few problems that are new to the reader.

The problems are arranged in no particular order, and especially not in increasing order of difficulty. We do not know how to rate a problem's difficulty. Even the IMO jury, now consisting of 75 highly skilled problem solvers, commits grave errors in rating the difficulty of the problems it selects. The over 400 IMO contestants are also an unreliable guide. Too much depends on the previous training by an ever-changing set of hundreds of trainers. A problem changes from impossible to trivial if a related problem was solved in training.

I would like to thank Dr. Manfred Grathwohl for his help in implementing various LaTEX versions on the workstation at the institute and on my PC at home. When difficulties arose, he was a competent and friendly advisor.

There will be some errors in the proofs, for which I take full responsibility, since none of my colleagues has read the manuscript before. Readers will miss important strategies. So do I, but I have set myself a limit to the size of the book. Especially, advanced methods are missing. Still, it is probably the most complete training book on the market. The gravest gap is the absence of new topics like probability and algorithmics to counter the conservative mood of the IMO jury. One exception is Chapter 13 on games, a topic almost nonexistent in the IMO, but very popular in Russia.

Frankfurt am Main, Germany Arthur Engel

Contents

+-----------------------+-----------------------+-----------------------+
| Preface *··· ···  |                       | v                     |
| ··· ··· ··· . . |                       |                       |
| ··· ··· ··· . . |                       |                       |
| ··· ··· ··· . . |                       |                       |
| ··· ··· ··· . . |                       |                       |
| ··· ··· ··· .*  |                       |                       |
+=======================+=======================+=======================+
| Abbreviations and     |                       | ix                    |
| Notations *··· . .  |                       |                       |
| ··· ··· ··· . . |                       |                       |
| ··· ··· ··· . . |                       |                       |
| ··· ··· ··· . . |                       |                       |
| ···*                |                       |                       |
+-----------------------+-----------------------+-----------------------+
| > 1                   | The Invariance        | 1                     |
|                       | Principle*··· ··· |                       |
|                       | ··· ··· ··· . . |                       |
|                       | ··· ··· ··· . . |                       |
|                       | ··· ··· ··· . . |                       |
|                       | ···*                |                       |
+-----------------------+-----------------------+-----------------------+
| > 2                   | Coloring Proofs *. .  | 25                    |
|                       | ··· ··· ··· . . |                       |
|                       | ··· ··· ··· . . |                       |
|                       | ··· ··· ··· . . |                       |
|                       | ··· ··· ··· . . |                       |
|                       | ···*                |                       |
+-----------------------+-----------------------+-----------------------+
| > 3                   | The Extremal          | 39                    |
|                       | Principle*··· ··· |                       |
|                       | ··· ··· ··· . . |                       |
|                       | ··· ··· ··· . . |                       |
|                       | ··· ··· ··· . . |                       |
|                       | ··· .*              |                       |
+-----------------------+-----------------------+-----------------------+
| > 4                   | The Box Principle *.  | 59                    |
|                       | ··· ··· ··· . . |                       |
|                       | ··· ··· ··· . . |                       |
|                       | ··· ··· ··· . . |                       |
|                       | ··· ··· ··· . . |                       |
|                       | . .*                  |                       |
+-----------------------+-----------------------+-----------------------+
| > 5                   | Enumerative           | 85                    |
|                       | Combinatorics *···  |                       |
|                       | ··· ··· ··· . . |                       |
|                       | ··· ··· ··· . . |                       |
|                       | ··· ··· ··· . . |                       |
|                       | . .*                  |                       |
+-----------------------+-----------------------+-----------------------+
| > 6                   | Number Theory *···  | 117                   |
|                       | ··· ··· ··· . . |                       |
|                       | ··· ··· ··· . . |                       |
|                       | ··· ··· ··· . . |                       |
|                       | ··· ··· ··· . . |                       |
|                       | . .*                  |                       |
+-----------------------+-----------------------+-----------------------+
| > 7                   | Inequalities *··· . | 161                   |
|                       | ··· ··· ··· . . |                       |
|                       | ··· ··· ··· . . |                       |
|                       | ··· ··· ··· . . |                       |
|                       | ··· ··· ··· . . |                       |
|                       | ··· . .*            |                       |
+-----------------------+-----------------------+-----------------------+
| > 8                   | The Induction         | 205                   |
|                       | Principle *··· . .  |                       |
|                       | ··· ··· ··· . . |                       |
|                       | ··· ··· ··· . . |                       |
|                       | ··· ··· ··· . . |                       |
|                       | ··· .*              |                       |
+-----------------------+-----------------------+-----------------------+
| > 9                   | Sequences *··· . .  | 221                   |
|                       | ··· ··· ··· . . |                       |
|                       | ··· ··· ··· . . |                       |
|                       | ··· ··· ··· . . |                       |
|                       | ··· ··· ··· . . |                       |
|                       | ··· . .*            |                       |
+-----------------------+-----------------------+-----------------------+
| > 10 Polynomials *. . |                       | 245                   |
| > ··· ··· ··· . |                       |                       |
| > ··· ··· ··· . |                       |                       |
| > ··· ··· ··· . |                       |                       |
| > ··· ··· ··· . |                       |                       |
| > ··· ··· ···   |                       |                       |
| > .*                  |                       |                       |
+-----------------------+-----------------------+-----------------------+
| > 11 Functional       |                       | 271                   |
| > Equations *··· .  |                       |                       |
| > ··· ··· ··· . |                       |                       |
| > ··· ··· ··· . |                       |                       |
| > ··· ··· ··· . |                       |                       |
| > ··· ··· ···   |                       |                       |
| > .*                  |                       |                       |
+-----------------------+-----------------------+-----------------------+

+-----------------------+-----------------------+-----------------------+
| viii                  | > Contents            | 289                   |
+=======================+=======================+=======================+
| 12 Geometry*··· . . |                       |                       |
| ··· ··· ··· . . |                       |                       |
| ··· ··· ··· . . |                       |                       |
| ··· ··· ··· . . |                       |                       |
| ··· ··· ··· . . |                       |                       |
| ··· ···*          |                       |                       |
+-----------------------+-----------------------+-----------------------+
| 13 Games*··· ···  |                       | 361                   |
| ··· ··· ··· . . |                       |                       |
| ··· ··· ··· . . |                       |                       |
| ··· ··· ··· . . |                       |                       |
| ··· ··· ··· . . |                       |                       |
| ··· ··· . .*      |                       |                       |
+-----------------------+-----------------------+-----------------------+
| 14 Further            |                       | 373                   |
| Strategies*··· . .  |                       |                       |
| ··· ··· ··· . . |                       |                       |
| ··· ··· ··· . . |                       |                       |
| ··· ··· ··· . . |                       |                       |
| ··· ··· ··· .*  |                       |                       |
+-----------------------+-----------------------+-----------------------+
| References *··· . . |                       | 397                   |
| ··· ··· ··· . . |                       |                       |
| ··· ··· ··· . . |                       |                       |
| ··· ··· ··· . . |                       |                       |
| ··· ··· ··· . . |                       |                       |
| ··· ··· . .*      |                       |                       |
+-----------------------+-----------------------+-----------------------+
| Index *··· ··· .  |                       | 401                   |
| ··· ··· ··· . . |                       |                       |
| ··· ··· ··· . . |                       |                       |
| ··· ··· ··· . . |                       |                       |
| ··· ··· ··· . . |                       |                       |
| ··· ··· ··· .   |                       |                       |
| .*                    |                       |                       |
+-----------------------+-----------------------+-----------------------+

Abbreviations and Notations

Abbreviations

ARO Allrussian Mathematical Olympiad

ATMO Austrian Mathematical Olympiad

AuMO Australian Mathematical Olympiad

AUO Allunion Mathematical Olympiad

BrMO British Mathematical Olympiad

BWM German National Olympiad

BMO Balkan Mathematical Olympiad

ChNO Chinese National Olympiad

HMO Hungarian Mathematical Olympiad (K˝urschak Competition)

IIM International Intellectual Marathon (Mathematics/Physics Competition)

IMO International Mathematical Olympiad

LMO Leningrad Mathematical Olympiad

MMO Moskov Mathematical Olympiad

PAMO Polish-Austrian Mathematical Olympiad

x Abbreviations and Notations

PMO Polish Mathematical Olympiad

RO Russian Olympiad (ARO from 1994 on)

SPMO St. Petersburg Mathematical Olympiad

TT Tournament of the Towns

USO US Olympiad

Notations for Numerical Sets

N or Z+the positive integers (natural numbers), i.e., {1,2,3, *···* }

N0 the nonnegative integers, {0,1,2, *···* }

Z the integers

Q the rational numbers

Q+the positive rational numbers

Q+ 0the nonnegative rational numbers

R the real numbers

R+the positive real numbers

C the complex numbers

Z*n* the integers modulo *n*

1 *. . n* the integers 1*,* 2*, ··· , n*

Notations from Sets, Logic, and Geometry

⇐⇒ iff, if and only if

=⇒ implies

*A* ⊂ *B A* is a subset of *B*

*A* \\ *B A* without *B*

*A* ∩ *B* the intersection of *A* and *B*

*A* ∪ *B* the union of *A* and *B*

*a* ∈ *A* the element *a* belongs to the set *A*

\|*AB*\| also *AB*, the distance between the points *A* and *B*

box parallelepiped, solid bounded by three pairs of parallel planes

1

The Invariance Principle

We present our first *Higher Problem-Solving Strategy*. It is extremely useful in solving certain types of difficult problems, which are easily recognizable. We will teach it by solving problems which use this strategy. In fact, **problem solving can be learned only by solving problems.** But it must be supported by strategies provided by the trainer.

Our first strategy is the *search for invariants*, and it is called the **Invariance Principle**. The principle is applicable to algorithms (games, transformations). Some task is repeatedly performed. **What stays the same? What remains invariant?**

Here is a saying easy to remember:

**If there is repetition, look for what does not change!**

In algorithms there is a starting state *S* and a sequence of legal steps (moves, transformations). One looks for answers to the following questions:

1. Can a given end state be reached?

2. Find all reachable end states.

3. Is there convergence to an end state?

4. Find all periods with or without tails, if any.

Since the Invariance Principle is a *heuristic principle*, it is best learned by experience, which we will gain by solving the key examples **E1** to **E10**.

2 1. The Invariance Principle

*sequence of points* (*xn, yn*) *according to the rule***E1.** *Starting with a point S* = (*a, b*) *of the plane with* 0 *\< b \< a, we generate a*

*x*0 = *a,* *y*0 = *b,* *xn*+1 =*xn* ~~+~~ *yn,* *yn*+1 =2*xnyn* *.* 2 *xn* + *yn*

Here it is easy to find an *invariant*. From *xn*+1*yn*+1 = *xnyn*, for all *n* we deduce *xnyn* = *ab* for all *n*. This is the *invariant* we are looking for. Initially, we have *y*0 *\< x*0. This relation also remains invariant. Indeed, suppose *yn \< xn* for some *n*. Then *xn*+1 is the midpoint of the segment with endpoints *yn, xn*.
Moreover, *yn*+1 *\< xn*+1 since the harmonic mean is strictly less than the arithmetic mean.

Thus,\ 0 *\< xn*+1 − *yn*+1 =*xn* ~~−~~ *ynxn* + *yn*·*xn* − *yn\< xn* − *yn*2\ for all *n*. So we have lim *xn* = lim *yn* = *x* with *x*2= *ab* or *x* =_sqrt_\ *ab*. Here the invariant helped us very much, but its recognition was not yet the solution, although the completion of the solution was trivial.

**E2.** *Suppose the positive integer n is odd. First Al writes the numbers* 1*,* 2*, ··· ,* 2*n on the blackboard. Then he picks any two numbers a, b, erases them, and writes, instead,* \|*a* − *b*\|*. Prove that an odd number will remain at the end.*

**Solution.** Suppose *S* is the sum of all the numbers still on the blackboard. Initially this sum is *S* = 1+2+...+2*n* = *n*(2*n*+1), an odd number. Each step reduces *S* by 2 min(*a, b*), which is an even number. So the parity of *S* is an *invariant*. During the whole reduction process we have *S* ≡ 1 mod 2. Initially the parity is odd.
So, it will also be odd at the end.

**E3.** *A circle is divided into six sectors. Then the numbers* 1*,* 0*,* 1*,* 0*,* 0*,* 0 *are written into the sectors (counterclockwise, say). You may increase two neighboring numbers by 1. Is it possible to equalize all numbers by a sequence of such steps?*

**Solution.** Suppose *a*1*, ··· , a*6 are the numbers currently on the sectors. Then *I* =*a*1 − *a*2 + *a*3 − *a*4 + *a*5 − *a*6 is an *invariant*. Initially *I* = 2. The goal *I* = 0 cannot be reached.

**E4.** *In the Parliament of Sikinia, each member has* **at most three enemies.** *Prove that the house can be separated into two houses, so that each member has* **at most one enemy** *in his own house.*

**Solution.** Initially, we separate the members in any way into the two houses. Let *H* be the total sum of all the enemies each member has in his own house. Now suppose *A* has at least two enemies in his own house. Then he has at most one enemy in the other house. If *A* switches houses, the number *H* will decrease. This decrease cannot go on forever. At some time, *H* reaches its absolute minimum. Then we have reached the required distribution.

1. The Invariance Principle 3

Here we have a new idea. We construct a positive integral function which decreases at each step of the algorithm. So we know that our algorithm will terminate. There is no strictly decreasing infinite sequence of positive integers. *H* is not strictly an invariant, but decreases monotonically until it becomes constant. Here, the monotonicity relation is the invariant.

**E5.** *Suppose not all four integers a, b, c, d are equal. Start with* (*a, b, c, d*) *and repeatedly replace* (*a, b, c, d*) *by* (*a* − *b, b* − *c, c* − *d, d* − *a*)*. Then at least one number of the quadruple will eventually become arbitrarily large.*

**Solution.** Let *Pn* = (*an, bn, cn, dn*) be the quadruple after *n* iterations. Then we have *an* + *bn* + *cn* + *dn* = 0 for *n* ≥ 1. We do not see yet how to use this invariant. But geometric interpretation is mostly helpful. A very important function for the point *Pn* in 4-space is the square of its distance from the origin (0*,* 0*,* 0*,* 0), which is *a*2 *n*+ *b*2 *n*+ *c*2 *n*+ *d*2 *n.* If we could prove that it has no upper bound, we would be finished.

We try to find a relation between *Pn*+1 and *Pn*:

*a*2 *n*+1+ *b*2 *n*+1+ *c*2 *n*+1+ *d*2 *n*+1= (*an* − *bn*)2 + (*bn* − *cn*)2 + (*cn* − *dn*)2 + (*dn* − *an*)2 = 2(*a*2 *n*+ *b*2 *n*+ *c*2 *n*+ *d*2 *n*)\ − 2*anbn* − 2*bncn* − 2*cndn* − 2*dnan.*

Now we can use *an* + *bn* + *cn* + *dn* = 0 or rather its square:

0 = (*an*+*bn*+*cn*+*dn*)2= (*an*+*cn*)2+(*bn*+*dn*)2+2*anbn*+2*andn*+2*bncn*+2*cndn.* (1) Adding (1) and (2), for *a*2 *n*+1+ *b*2 *n*+1+ *c*2 *n*+1+ *d*2 *n*+1, we get

2(*a*2 *n*+ *b*2 *n*+ *c*2 *n*+ *d*2 *n*) + (*an* + *cn*)2 + (*bn* + *dn*)2 ≥ 2(*a*2 *n*+ *b*2 *n*+ *c*2 *n*+ *d*2 *n*)*.*

From this invariant inequality relationship we conclude that, for *n* ≥ 2,

*a*2 *n*+ *b*2 *n*+ *c*2 *n*+ *d*2 *n*≥ 2*n*−1(*a*2 1+ *b*2 1+ *c*2 1+ *d*2 1)*.* (2)

The distance of the points *Pn* from the origin increases without bound, which means that at least one component must become arbitrarily large. Can you always have equality in (2)?

**Here we learned that the distance from the origin is a very important function. Each time you have a sequence of points you should consider it.**

**E6.** *An algorithm is defined as follows:*

+-----------------+-----------------+-----------------+-----------------+
| *Start:*        | > (*x*0*, y*0)  |                 |                 |
|                 | > *with* 0 *\<  |                 |                 |
|                 | > x*0 *\<       |                 |                 |
|                 | > y*0*.*        |                 |                 |
+=================+=================+=================+=================+
| *Step:*         | *xn*+1 =*xn* +  | > *,*           | > *yn*+1 =      |
|                 | *yn*            |                 | > _sqrt_*xn*+1*yn.*  |
+-----------------+-----------------+-----------------+-----------------+

6 1. The Invariance Principle

*B*′*A*′**s s**

**ss** *BA*

Fig. 1.3. Invert arc *A*′*B*.

**s s**\ *B*′*B*

**ss** *A*′*A*

Fig. 1.4

*Remark.* This problem is similar to **E4**, but considerably harder. It is the following theorem in graph theory: *Let G be a linear graph with n vertices. Then G has a Hamiltonian path if the sum of the degrees of any two vertices is equal to or larger than n* − 1*.* In our special case, we have proved that there is even a Hamiltonian circuit.

*If x, y, z are the numbers assigned to three successive vertices and if y \<* 0*, then we replace* (*x, y, z*) *by* (*x* + *y,* −*y, y* + *z*)*.
This step is repeated as long as there is a y \<* 0*. Decide if the algorithm always stops.* (Most difficult problem of IMO 1986.)

**Solution.** The algorithm always stops. The key to the proof is (as in Examples 4 and 8) to find an integer-valued, nonnegative function *f* (*x*1*, ··· , x*5) of the vertex labels whose value decreases when the given operation is performed. All but one of the eleven students who solved the problem found the same function

5\ *f* (*x*1*, x*2*, x*3*, x*4*, x*5) ==(*xi* − *xi*+2)2*,* *x*6 = *x*1*,* *x*7 = *x*2*.* *i*=1\ Suppose *y* = *x*4 *\<* 0. Then *fnew* − *fold* = 2*sx*4 *\<* 0, since *s \>* 0. If the algorithm does not stop, we can find an infinite decreasing sequence *f*0 *\> f*1 *\> f*2 *\>* ... of nonnegative integers. Such a sequence does not exist.

Bernard Chazelle (Princeton) asked: How many steps are needed until stop? He considered the infinite multiset *S* of all sums defined by *s*(*i, j*) = *xi* + ... + *xj*−1 with 1 ≤ *i* ≤ 5 and *j \> i.* A multiset is a set which can have equal elements. In this set, all elements but one either remain invariant or are switched with others.
Only *s*(4*,* 5) = *x*4 changes to −*x*4*.* Thus, exactly one negative element of *S* changes to positive at each step. There are only finitely many negative elements in *S*, since *s \>* 0*.* The number of steps until stop is equal to the number of negative elements of *S.* We see that the *xi* need not be integers.

*Remark.* It is interesting to find a formula with the computer, which, for input *a, b, c, d, e*, gives the number of steps until stop. This can be done without much effort if *s* = 1*.* For instance, the input (*n, n,* 1 − 4*n, n, n*) gives the step number *f* (*n*) = 20*n* − 10*.*

1. The Invariance Principle 7

**E10. Shrinking squares. An empirical exploration.** *Start with a sequence S* =(*a, b, c, d*) *of positive integers and find the derived sequence S*1 = *T* (*S*) = (\|*a* −*b*\|*,* \|*b* −*c*\|*,* \|*c* −*d*\|*,* \|*d* −*a*\|)*. Does the sequence S, S*1*, S*2 = *T* (*S*1)*, S*3 = *T* (*S*2)*, ··· always end up with* (0*,* 0*,* 0*,* 0)*?*

Let us collect material for solution hints:

(0*,* 3*,* 10*,* 13) =→ (3*,* 7*,* 3*,* 13) =→ (4*,* 4*,* 10*,* 10) =→ (0*,* 6*,* 0*,* 6) =→ (6*,* 6*,* 6*,* 6) =→ (0*,* 0*,* 0*,* 0)*,*

(8*,* 17*,* 3*,* 107) =→ (9*,* 14*,* 104*,* 99) =→ (5*,* 90*,* 5*,* 90) =→\ (85*,* 85*,* 85*,* 85) =→ (0*,* 0*,* 0*,* 0)*,*\ (91*,* 108*,* 95*,* 294) =→ (17*,* 13*,* 99*,* 203) =→ (4*,* 86*,* 104*,* 186) =→ (82*,* 18*,* 82*,* 182) =→ (64*,* 64*,* 100*,* 100) =→ (0*,* 36*,* 0*,* 36) =→ (36*,* 36*,* 36*,* 36) =→ (0*,* 0*,* 0*,* 0)*.*

Observations:

1. Let max *S* be the maximal element of *S.* Then max *Si*+1 ≤ max *Si*, and max *Si*+4 *\<* max *Si* as long as max *Si \>* 0*.* Verify these observations. This gives a proof of our conjecture.

2. *S* and *tS* have the same life expectancy.

3. After four steps at most, all four terms of the sequence become even. Indeed, it is sufficient to calculate modulo 2*.* Because of cyclic symmetry, we need to test just six sequences 0001 =→ 0011 =→ 0101 =→ 1111 =→ 0000 and 1110 =→ 0011. Thus, we have proved our conjecture. After four steps at most, each term is divisible by 2, after 8 steps at most, by 22*, ··· ,* after 4*k* steps at most, by 2*k*. As soon as max *S \<* 2*k*, all terms must be 0.

In observation 1, we used another strategy, the **Extremal Principle:
Pick the maximal element!** Chapter 3 is devoted to this principle.

In observation 3, we used **symmetry.** You should always think of this strategy, although we did not devote a chapter to this idea.

Generalizations:

\(a\) Start with four real numbers, e.g.,

<table>
<colgroup>
<col style="width: 9%" />
<col style="width: 9%" />
<col style="width: 9%" />
<col style="width: 9%" />
<col style="width: 9%" />
<col style="width: 9%" />
<col style="width: 9%" />
<col style="width: 9%" />
<col style="width: 9%" />
<col style="width: 9%" />
<col style="width: 9%" />
</colgroup>
<thead>
<tr class="header">
<th rowspan="2"><em>π</em> − <em>e</em> −</th>
<th rowspan="2">_sqrt__sqrt_<em>π</em> −3 −3 +</th>
<th><blockquote>
<p>_sqrt_2 _sqrt_2 _sqrt_2 _sqrt_2</p>
</blockquote></th>
<th rowspan="2"><blockquote>
<p><em>π</em> − <em>e</em> −</p>
</blockquote></th>
<th rowspan="2"><blockquote>
<p><em>π</em><br />
<em>π</em> −<br />
_sqrt_3 _sqrt_3 +<em>π</em> − <em>e</em>_sqrt_2 0</p>
</blockquote></th>
<th rowspan="2"><blockquote>
<p><em>π</em> − <em>e</em> −</p>
</blockquote></th>
<th rowspan="2"><p>_sqrt_</p>
<p>_sqrt_</p></th>
<th rowspan="2"><p><em>e</em> −</p>
<p>3 −</p>
<p>3 +</p></th>
<th><blockquote>
<p>_sqrt_3 _sqrt_3 _sqrt_2 _sqrt_2</p>
</blockquote></th>
<th rowspan="2"><blockquote>
<p><em>π</em> − <em>e</em> −</p>
</blockquote></th>
<th rowspan="2"><blockquote>
<p><em>e</em><br />
<em>e</em> −<br />
_sqrt_2_sqrt_3 +<em>π</em> − <em>e</em> _sqrt_2 0.</p>
</blockquote></th>
</tr>
<tr class="odd">
<th>0</th>
<th>0</th>
</tr>
</thead>
<tbody>
</tbody>
</table>

8 1. The Invariance Principle

Some more trials suggest that, even for all nonnegative real quadruples, we always end up with (0*,* 0*,* 0*,* 0)*.* But with *t
\>* 1 and *S* = (1*, t, t*2*, t*3) we have

*T* (*S*) = \[*t* − 1*,* (*t* − 1)*t,* (*t* − 1)*t*2*,* (*t* − 1)(*t*2+ *t* + 1)\]*.*

If *t*3= *t*2+*t* +1, i.e., *t* = 1*.*8392867552 *···*, then the process never stops because of the second observation. This *t* is unique up to a transformation *f* (*t*) = *at* + *b.*

\(b\) Start with *S* = (*a*0*, a*1*, ··· , an*−1), *ai* nonnegative integers. For *n* = 2, we reach (0*,* 0) after 2 steps at most. For *n* = 3, we get, for 011, a pure cycle of length 3: 011 =→ 101 =→ 110 =→ 011. For *n* = 5 we get 00011 =→ 00101 =→ 01111 =→10001 =→ 10010 =→ 10111 =→ 11000 =→ 01001 =→ 11011 =→ 01100 =→10100 =→ 11101 =→ 00110 =→ 01010 =→ 11110 =→ 00011*,* which has a pure cycle of length 15.

1. Find the periods for *n* = 6 (*n* = 7) starting with 000011 (0000011).

2. Prove that, for *n* = 8, the algorithm stops starting with 00000011.

3. Prove that, for *n* = 2*r*, we always reach (0*,* 0*, ··· ,* 0), and, for *n* ̸= 2*r*, we get (up to some exceptions) a cycle containing just two numbers: 0 and evenly often some number *a \>* 0.
Because of observation 2, we may assume that *a* = 1*.* Then \| *a* − *b* \|= *a* + *b* mod 2, and we do our calculations in GF(2), i.e., the finite field with two elements 0 and 1.

4. Let *n* ̸= 2*r*and *c*(*n*) be the cycle length. Prove that *c*(2*n*) = 2*c*(*n*) (up to some exceptions).

5. Prove that, for odd *n*, *S* = (0*,* 0*, ··· ,* 1*,* 1) always lies on a cycle.

6. *Algebraization.* To the sequence (*a*0*, ··· , an*−1), we assign the polynomial *p*(*x*) = *an*−1 + ... + *a*0*xn*−1with coefficients from GF(2), and *xn*= 1. The polynomial (1+*x*)*p*(*x*) belongs to *T* (*S*). Use this algebraization if you can.

7. The following table was generated by means of a computer. Guess as many properties of *c*(*n*) as you can, and prove those you can.

+-----------------------------------+-----------------------------------+
| *n*                               | > 3 5 7 9 11 13 15 17 19 21 23 25 |
+===================================+===================================+
| *c*(*n*)                          | > 3 15 7 63 341 819 15 255 9709   |
|                                   | > 63 2047 25575                   |
+-----------------------------------+-----------------------------------+

+-----------------------------------+-----------------------------------+
| *n*                               | > 27 29 31 33 35 37 39 41 43      |
+===================================+===================================+
| *c*(*n*)                          | > 13797 47507 31 1023 4095        |
|                                   | > 3233097 4095 41943 5461         |
+-----------------------------------+-----------------------------------+

Problems

1. Start with the positive integers 1*, ··· ,* 4*n* − 1. In one move you may replace any two integers by their difference. Prove that an even integer will be left after 4*n* − 2 steps.

10 1. The Invariance Principle

12. There is a row of 1000 integers. There is a second row below, which is constructed as follows. Under each number *a* of the first row, there is a positive integer *f* (*a*) such that *f* (*a*) equals the number of occurrences of *a* in the first row. In the same way, we get the 3rd row from the 2nd row, and so on. Prove that, finally, one of the rows is identical to the next row.

13. There is an integer in each square of an 8 × 8 chessboard. In one move, you may choose any 4 × 4 or 3 × 3 square and add 1 to each integer of the chosen square. Can you always get a table with each entry divisible by (a) 2, (b) 3?

14. We strike the first digit of the number 71996, and then add it to the remaining number. This is repeated until a number with 10 digits remains. Prove that this number has two equal digits.

15. There is a checker at point (1*,* 1) of the lattice (*x, y*) with *x, y* positive integers. It moves as follows. At any move it may double one coordinate, or it may subtract the smaller coordinate from the larger . Which points of the lattice can the checker reach?

16. Each term in a sequence 1*,* 0*,* 1*,* 0*,* 1*,* 0*, ···* starting with the seventh is the sum of the last 6 terms mod 10. Prove that the sequence *··· ,* 0*,* 1*,* 0*,* 1*,* 0*,* 1*, ···* never occurs.

17. Starting with any 35 integers, you may select 23 of them and add 1 to each. By repeating this step, one can make all 35 integers equal.
Prove this. Now replace 35 and 23 by *m* and *n*, respectively. What condition must *m* and *n* satisfy to make the equalization still possible?

18. The integers 1*, ··· ,* 2*n* are arranged in any order on 2*n* places numbered 1*, ··· ,* 2*n*. Now we add its place number to each integer. Prove that there are two among the sums which have the same remainder mod 2*n*.

19. The *n* holes of a socket are arranged along a circle at equal (unit) distances and numbered 1*, ··· , n*.For what *n*canthe prongs ofa plugfitting the socket be numbered such that at least one prong in each plug-in goes into a hole of the same number (good numbering)?

20. A game for computing gcd(*a, b*) and lcm(*a, b*).

We start with *x* = *a, y* = *b, u* = *a, v* = *b* and move as follows:\ if *x \< y* then, set *y* ← *y* − *x* and *v* ← *v* + *u*\ if *x \> y*, then set *x* ← *x* − *y* and *u* ← *u* + *v*\ The game ends with *x* = *y* = gcd(*a, b*) and (*u* + *v*)*/*2 = lcm(*a, b*). Show this.

21. Three integers *a, b, c* are written on a blackboard. Then one of the integers is erased and replaced by the sum of the other two diminished by 1. This operation is repeated many times with the final result 17*,* 1967*,* 1983. Could the initial numbers be (a) 2, 2, 2 (b) 3, 3, 3?

22. There is a chip on each dot in Fig. 1.6. In one move, you may simultaneously move any two chips by one place in opposite directions.
The goal is to get all chips into one dot. When can this goal be reached?

+-------------+-------------+-------------+-------------+-------------+
| **r**       | **r**       | > **r**\    | **r** 2     | > **r** 1   |
|             |             | > 3         |             |             |
+=============+=============+=============+=============+=============+
|             | **r**       |             | **r**       | **r** *n*   |
|             |             |             |             |             |
|             |             |             | Fig. 1.6    |             |
+-------------+-------------+-------------+-------------+-------------+

1. The Invariance Principle 11

23. Start with *n* pairwise different integers *x*1*, x*2*, ··· , xn,* (*n \>* 2) and repeat the fol lowing step:

*T* : (*x*1*, ··· , xn*) =→=*x*1 ~~+~~ *x*2*, x*2 ~~+~~ *x*32 *, . .
. , xn* + *x*12

Show that *T, T*2*, ···* finally leads to nonintegral components.

=*.*

24. Start with an *m* × *n* table of integers. In one step, you may change the sign of all numbers in any row or column. Show that you can achieve a nonnegative sum of any row or column. (Construct an integral function which increases at each step, but is bounded above. Then it must become constant at some step, reaching its maximum.)

25. Assume a convex 2*m*-gon *A*1*, ··· , A*2*m*. In its interior we choose a point *P* , which does not lie on any diagonal. Show that *P* lies inside an even number of triangles with vertices among *A*1*,
··· , A*2*m*.

26. Three automata *I, H, T* print pairs of positive integers on tickets. For input (*a, b*), *I* and *H* give (*a* + 1*, b* + 1) and (*a/*2*, b/*2), respectively. *H* accepts only even *a, b*. *T* needs two pairs (*a, b*) and (*b, c*) as input and yields output (*a, c*).
Starting with (5*,* 19) can you reach the ticket (a) (1*,* 50) (b) (1*,* 100)? Initially, we have (*a, b*)*, a \< b.* For what *n* is (1*, n*) reachable?

27. Three automata *I, R, S* print pairs of positive integers on tickets. For entry (*x, y*), the automata *I, R, S* give tickets (*x* − *y, y*)*,* (*x* + *y, y*)*,* (*y, x*), respectively, as outputs.
Initially, we have the ticket (1*,* 2). With these automata, can I get the tickets (a) (19*,* 79) (b) (819*,* 357)? Find an invariant. What pairs (*p, q*) can I get starting with (*a, b*)? Via which pair should I best go?

28. *n* numbers are written on a blackboard. In one step you may erase any two of the numbers, say *a* and *b*, and write, instead (*a* + *b*)*/*4. Repeating this step *n* − 1 times, there is one number left. Prove that, initially, if there were *n* ones on the board, at the end, a number, which is not less than 1*/n* will remain.

29. The following operation is performed with a nonconvex non-self-intersecting polygon *P* . Let *A, B* be two nonneighboring vertices. Suppose *P* lies on the same side of *AB*. Reﬂect one part of the polygon connecting *A* with *B* at the midpoint *O* of *AB*.
Prove that the polygon becomes convex after finitely many such reﬂections.

30. Solve the equation (*x*2− 3*x* + 3)2− 3(*x*2− 3*x* + 3) + 3 = *x*.

31. Let *a*1*, a*2*, ··· , an* be a permutation of 1*,* 2*, ··· , n*. If *n* is odd, then the product *P* = (*a*1 − 1)(*a*2 − 2) *···* (*an* − *n*) is even. Prove this.

32. Many handshakes are exchanged at a big international congress. We call a person an *odd person* if he has exchanged an odd number of handshakes. Otherwise he will be called an *even person.* Show that, at any moment, there is an even number of odd persons.

33. Start with two points on a line labeled 0*,* 1 in that order. In one move you may add or delete two *neighboring* points (0*,* 0) or (1*,* 1). Your goal is to reach a single pair of points labeled (1*,* 0) in that order. Can you reach this goal?

34. Is it possible to transform *f* (*x*) = *x*2+ 4*x* + 3 into *g*(*x*) = *x*2+ 10*x* + 9 by a sequence of transformations of the form

*f* (*x*) =→ *x*2*f* (1*/x* + 1) or *f* (*x*) =→ (*x* − 1)2*f*
\[1*/*(*x* − 1)\]?

12 1. The Invariance Principle

35. Does the sequence of squares contain an infinite arithmetic subsequence?

36. The integers 1*, ··· , n* are arranged in any order. In one step you may switch any two neighboring integers. Prove that you can never reach the initial order after an odd number of steps.

37. One step in the preceding problem consists of an interchange of any two integers. Prove that the assertion is still true.

38. The integers 1*, ··· , n* are arranged in order. In one step you may take any four integers and interchange the first with the fourth and the second with the third. Prove that, if *n*(*n* − 1)*/*2 is even, then by means of such steps you may reach the arrangement *n, n* − 1*, ··· ,* 1. But if *n*(*n* − 1)*/*2 is odd, you cannot reach this arrangement.

39. Consider all lattice squares (*x, y*) with *x, y* nonnegative integers. Assign to each its lower left corner as a label. We shade the squares (0*,* 0), (1*,* 0), (0*,* 1), (2*,* 0), (1*,* 1), (0*,* 2). (a) There is a chip on each of the six squares (b) There is only one chip on (0*,* 0).

*Step:* If (*x, y*) is occupied, but (*x* + 1*, y*) and (*x, y* + 1) are free, you may remove the chip from (*x, y*) and place a chip on each of (*x* + 1*, y*) and (*x, y* + 1). The goal is to remove the chips from the shaded squares. Is this possible in the cases (a) or (b)? (Kontsevich, TT 1981.)

40. In any way you please, fill up the lattice points below or on the *x*-axis by chips. By solitaire jumps try to get one chip to (0*,* 5) with all other chips cleared off. (J. H. Conway.) The preceding problem of Kontsevich might have been suggested by this problem.

A solitaire jump is a horizontal or vertical jump of any chip over its neighbor to a free point with the chip jumped over removed. For instance, with (*x, y*) and (*x, y* + 1) occupied and (*x, y* + 2) free, a jump consists in removing the two chips on (*x, y*) and (*x, y* + 1) and placing a chip onto (*x, y* + 2).

41. We may extend a set *S* of space points by reﬂecting any point *X* of *S* at any space point *A, A* ̸= *X*. Initially, *S* consists of the 7 vertices of a cube. Can you ever get the eight vertex of the cube into *S*?

42. The following game is played on an infinite chessboard. Initially, each cell of an *n*×*n* square is occupied by a chip. A move consists in a jump of a chip over a chip in a horizontal or vertical direction onto a free cell directly behind it. The chip jumped over is removed.
Find all values of *n*, for which the game ends with one chip left over (IMO 1993 and AUO 1992!).

43. Nine 1 × 1 cells of a 10 × 10 square are infected. In one time unit, the cells with at least two infected neighbors (having a common side) become infected. Can the infection spread to the whole square?

44. Can you get the polynomial *h*(*x*) = *x* from the polynomials *f* (*x*) and *g*(*x*) by the operations **addition, subtraction, multiplication** if\ (a) *f* (*x*) = *x*2+ *x*, *g*(*x*) = *x*2+ 2; (b) *f* (*x*) = 2*x*2+ *x*, *g*(*x*) = 2*x*;\ (c) *f* (*x*) = *x*2+ *x*, *g*(*x*) = *x*2− 2?

45. **Accumulation of your computer rounding errors.** Start with *x*0 = 1, *y*0 = 0, and, with your computer, generate the sequences

*xn*+1 =5*xn* ~~−~~ 12*yn,* *yn*+1 =12*xn* ~~+~~ 5*yn.* 13 13

1. The Invariance Principle 13

Find *x*2 *n*+ *y*2 *n*for *n* = 102*,* 103*,* 104*,* 105*,* 106, and 107.

46. Start with two numbers 18 and 19 on the blackboard. In one step you may add another number equal to the sum of two preceding numbers.
Can you reach the number 1994 (IIM)?

47. In a regular (a) pentagon (b) hexagon all diagonals are drawn.
Initially each vertex and each point of intersection of the diagonals is labeled by the number 1. In one step it is permitted to change the signs of all numbers of a side or diagonal. Is it possible to change the signs of all labels to −1 by a sequence of steps (IIM)?

48. In Fig. 1.7, two squares are neighbors if they have a common boundary. Consider the following operation *T* : Choose any two neighboring numbers and add the same integer to them. Can you transform Fig. 1.7 into Fig. 1.8 by iteration of *T* ?

  -----------------------------------------------------------------------
  1                       2                       3   ----------------------- ----------------------- -----------------------
  4                       5                       6

  7                       8                       9   -----------------------------------------------------------------------

Fig. 1.7

  -----------------------------------------------------------------------
  7                       8                       9   ----------------------- ----------------------- -----------------------
  6                       2                       4

  3                       5                       1   -----------------------------------------------------------------------

Fig. 1.8

49. There are several signs + and − on a blackboard. You may erase two signs and write, instead, + if they are equal and − if they are unequal.
Then, the last sign on the board does not depend on the order of erasure.

50. There are several letters *e*, *a* and *b* on a blackboard. We may replace two *e*′*s* by one *e*, two *a*′*s* by one *b*, two *b*′*s* by one *a*, an *a* and a *b* by one *e*, an *a* and an *e* by one *a*, a *b*, and an *e* by one *b*. Prove that the last letter does not depend on the order of erasure.

51. A dragon has 100 heads. A knight can cut off 15, 17, 20, or 5 heads, respectively, with one blow of his sword. In each of these cases, 24, 2, 14, or 17 new heads grow on its shoulders. If all heads are blown off, the dragon dies. Can the dragon ever die?

52. Is it possible to arrange the integers 1*,* 1*,* 2*,* 2*, ··· ,* 1998*,* 1998 such that there are exactly *i* − 1 other numbers between any two *i*′*s*?

53. The following operations are permitted with the quadratic polynomial *ax*2+*bx* +*c*: (a) switch *a* and *c*, (b) replace *x* by *x* + *t* where *t* is any real. By repeating these operations, can you transform *x*2− *x* − 2 into *x*2− *x* − 1?

54. Initially, we have three piles with *a*, *b*, and *c* chips, respectively. In one step, you may transfer one chip from any pile with *x* chips onto any other pile with *y* chips. Let *d* = *y* − *x* + 1.
If *d \>* 0, the bank pays you *d* dollars. If *d \<* 0, you pay the bank \|*d*\| dollars. Repeating this step several times you observe that the original distribution of chips has been restored. What maximum amount can you have gained at this stage?

55. Let *d*(*n*) be the digital sum of *n* ∈ N. Solve *n* + *d*(*n*) + *d*(*d*(*n*)) = 1997.

56. Start with four congruent right triangles. In one step you may take any triangle and cut it in two with the altitude from the right angle.
Prove that you can never get rid of congruent triangles (MMO 1995).

57. Starting with a point *S*(*a, b*) of the plane with 0 *\< a \< b*, we generate a sequence (*xn, yn*) of points according to the rule

*x*0 = *a,* *y*0 = *b,* *xn*+1 = _sqrt_*xnyn*+1*,* *yn*+1 = _sqrt_*xnyn.*

14 1. The Invariance Principle

Prove that there is a limiting point with *x* = *y*. Find this limit.

58. Consider any binary word *W* = *a*1*a*2 ... *an*. It can be transformed by inserting, deleting or appending any word *XXX*, *X* being any binary word. Our goal is to transform *W* from 01 to 10 by a sequence of such transformations. Can the goal be attained (LMO 1988, oral round)?

59. Seven vertices of a cube are marked by 0 and one by 1. You may repeatedly select an edge and increase by 1 the numbers at the ends of that edge. Your goal is to reach (a) 8 equal numbers, (b) 8 numbers divisible by 3.

60. Start with a point *S*(*a, b*) of the plane with 0 *\< b \< a*, and generate a sequence of points *Sn*(*xn, yn*) according to the rule

+-----------+-----------+-----------+-----------+-----------+-----------+
| *x*0 =    | *y*0 =    | > *xn*+1  | > *,*     | > *yn*+1  | > *.*     |
| *a,*      | *b,*      | > =       |           | > =2*xn*+ |           |
|           |           | 2*xnynxn* |           | 1*ynxn*+1 |           |
|           |           | > + *yn*  |           | > + *yn*  |           |
+===========+===========+===========+===========+===========+===========+
| > Prove   |           |           |           |           |           |
| > that    |           |           |           |           |           |
| > there   |           |           |           |           |           |
| > is a    |           |           |           |           |           |
| >         |           |           |           |           |           |
|  limiting |           |           |           |           |           |
| > point   |           |           |           |           |           |
| > with    |           |           |           |           |           |
| > *x* =   |           |           |           |           |           |
| > *y*.    |           |           |           |           |           |
| > Find    |           |           |           |           |           |
| > this    |           |           |           |           |           |
| > limit.  |           |           |           |           |           |
+-----------+-----------+-----------+-----------+-----------+-----------+

Solutions

1. In one move the number of integers always decreases by one. After (4*n* − 2) steps, just one integer will be left. Initially, there are 2*n* even integers, which is an even number. If two odd integers are replaced, the number of odd integers decreases by 2. If one of them is odd or both are even, then the number of odd numbers remains the same.
Thus, the number of odd integers remains even after each move. Since it is initially even, it will remain even to the end. Hence, one even number will remain.

2. (a)(0*.*6*a*−0*.*8*b*)2+(0*.*8*a*+0*.*6*b*)2= *a*2+*b*2.Since*a*2+*b*2+*c*2= 32+42+122= 132, 142, the goal lies on the sphere around *O* with radius 14. The goal cannot be reached. the point (*a, b, c*) lies on the sphere around *O* with radius 13.
Because 42+62+122=(b) (*x* − 4)2+ (*y* − 6)2+ (*z* − 12)2*\<* 1. The goal cannot be reached.

The important invariant, here, is the distance of the point (*a, b, c*) from *O*.

3. (a) Repainting a row or column with *b* black and 8−*b* white squares, you get (8−*b*) black and *b* white squares. The number of black squares changes by \|(8 − *b*) − *b*\| =\|8 − 2*b*\|, that is an even number. The parity of the number of black squares does not change. Initially, it was even. So, it always remains even. One black square is unattainable. The reasoning for (b) is similar.

4. Here is a solution valid for natural, rational and irrational numbers. With the invariant *a* + *b* = *n* the algorithm can be reformulated as follows:

If *a \< n/*2, replace *a* by 2*a*.

If *a* ≥ *n/*2, replace *a* by *a* − *b* = *a* − (*n* − *a*) = 2*a* − *n* ≡ 2*a* (mod *n*).

Thus, we double *a* repeatedly modulo *n* and get the sequence

*a,* 2*a,* 22*a,* 23*a, ···* (mod *n*)*.* (1)

Divide *a* by *n* in base 2. There are three cases.

\(a\) The result is terminating: *a/n* = 0*.d*1*d*2*d*3 *··· dk,* *di* ∈ {0*,* 1}*.* Then 2*k*≡ 0

1. The Invariance Principle 15

(mod *n*), but 2*i*̸≡ 0 (mod *n*) for *i \< k*. Thus, the algorithm stops after exactly *k* steps.

\(b\) The result is nonterminating and periodic.

*a/n* = 0*.a*1*a*2 *··· apd*1*d*2 *··· dkd*1*d*2 *··· dk ··· .*

The algorithm will not stop, but the sequence (1) has period *k* with tail *p*.

the algorithm will not stop, and the sequence (1) is not periodic.(c) The result is nonterminating and nonperiodic: *a/n* = 0*.d*1*d*2*d*3 *···*. In this case,

5. This is a special case of problem **E10** on *shrinking squares*.
Addition is done mod 2: 0 + 0 = 1 + 1 = 0, 1 + 0 = 0 + 1 = 1. Let (*x*1*, x*2*, ··· , xn*) be the original distribution of zeros and ones around the circle. One step consists of the replacement (*x*1*, .
. . , xn*) ← (*x*1 + *x*2*, x*2 + *x*3*, ··· , xn* + *x*1). There are two special distributions *E* = (1*,* 1*, ··· ,* 1) and *I* = (0*,* 0*, ··· ,* 0). Here, we must **work backwards**. Suppose we finally reach *I*. Then the preceding state must be *E*, and before that an alternating *n*-tuple (1*,* 0*,* 1*,* 0*, ···*). Since *n* is odd such an *n*-tuple does not exist.

Now suppose that *n* = 2*kq*, *q* odd. The following iteration

(*x*1*, ··· , xn*) ← (*x*1 + *x*2*, x*2 + *x*3*, ···* + *xn* + *x*1) ← (*x*1 + *x*3*, x*2 + *x*4*, ··· xn* + *x*2)

← (*x*1 + *x*2 + *x*3 + *x*4*, x*2 + *x*3 + *x*4 + *x*5*, ···*) ← (*x*1 + *x*5*, x*2 + *x*6*, ···*) ← ...

shows that, for *q* = 1, the iteration ends up with *I*. For *q \>* 1, we eventually arrive at *I* iff we ever get *q* identical blocks of length 2*k*, i.e., we have period 2*k*. Try to prove this.

The **problem-solving strategy** of **working backwards** will be treated in Chapter 14.

6. All three numbers *a*, *b*, *c* change their parity in one step.
If one of the numbers has different parity from the other two, it will retain this property to the end. This will be the one which remains.

7. (*a, b, c*) will be transformed into one of the three triples (*a* + 2*, b* − 1*, c* − 1), (*a* − 1*, b* + 2*, c* − 1), (*a* − 1*, b* − 1*, c* + 2). In each case, *I* = *a* − *b* mod 3 is an invariant. But *b* − *c* = 0 mod 3 and *a* − *c* = 0 mod 3 are also invariant. So *I* = 0 mod 3 combined with *a* + *b* + *c* = 0 mod 3 is the condition for reaching a monochromatic state.

8. If there are numbers equal to 1 in the first column, then we double the corresponding rows and subtract 1 from all elements of the first column. This operation decreases the sum of the numbers in the first column until we get a column of ones, which is changed to a column of zeros by subtracting 1. Then we go to the next column, etc.

9. Consider the remainder mod 9. It is an invariant. Since 106= 1 mod 9 the number of ones is by one more than the number of twos.

10. From (*a* − *d*)(*b* − *c*) *\<* 0, we get *ab* + *cd \< ac* + *bd*. The switching operation increases the sum *S* of the products of neighboring terms. In our case *ab* + *bc* + *cd* But *S* can take only finitely many values.is replaced by *ac* + *cb* + *bd*. Because of *ab* + *cd \< ac* + *bd* the sum *S* increases.

11. The product *I* of the eight boundary squares (except the four corners) is −1 and remains invariant.

16 1. The Invariance Principle

12. The numbers starting with the second in each column are an increasing and bounded sequence of integers.

13. (a)Let*S* bethesumofallnumbersexceptthethirdandsixthrow.*S* mod 2isinvariant. If *S* ̸≡ 0 (mod 2) initially, then odd numbers will remain on the chessboard. (b) Let *S* be the sum of all numbers, except the fourth and eight row. Then *I* = *S* mod 3 is an invariant.
If, initially, *I* ̸≡ 0 (mod 3) there will always be numbers on the chessboard which are not divisible by 3.

14. We have 73= 1 mod 9 ⇒ 71996≡ 71mod 9. This digital sum remains invariant. At the end all digits cannot be distinct, else the digital sum would be 0+1+...+9 = 45, which is 0 mod 9.

15. The point (*x, y*) can be reached from (1*,* 1) iff gcd(*x, y*) = 2*n, n* ∈ N*.* The permitted moves either leave gcd(*x, y*) invariant or double it.

16. Here, *I*(*x*1*, x*2*, ··· , x*6) = 2*x*1 + 4*x*2 + 6*x*3 + 8*x*4 + 10*x*5 + 12*x*6 mod 10 is the invariant. Starting with *I*(1*,* 0*,* 1*,* 0*,* 1*,* 0) = 8, the goal *I*(0*,* 1*,* 0*,* 1*,* 0*,* 1) = 4 cannot be reached.

17. Suppose gcd(*m, n*) = 1. Then, in Chapter 4, **E5**, we prove that *nx* = *my* + 1 has a solution with *x* and *y* from {1*,* 2*, .
. . , m* − 1}. We rewrite this equation in the form *nx* = *m*(*y* − 1) + *m* + 1. Now we place any *m* positive integers *x*1*, ··· , xm* around a circle assuming that *x*1 is the smallest number. We proceed as follows. Go around the circle in blocks of *n* and increase each number of a block by 1. If you do this *n* times you get around the circle *m* times, and, in addition, the first number becomes one more then the others. In this way, \|*xmax* − *xmin*\| decreases by one. This is repeated each time placing a minimal element in front until the difference between the maximal and minimal element is reduced to zero.

But if gcd(*x, y*) = *d \>* 1, then such a reduction is not always possible. Let one of the *m* numbers be 2 and all the others be 1.
Suppose that, applying the same operation *k* times we get equidistribution of the (*m* + 1 + *kn*) units to the *m* numbers.
This means *m* + 1 + *kn* ≡ 0 mod *m*. But *d* does not divide *m* + *kn* + 1 since *d \>* 1. Hence *m* does not divide *m* + 1 + *kn*.
Contradiction!

18. We proceed by contradiction. Suppose all the remainders 0*,* 1*,
··· ,* 2*n* − 1 occur. The sum of all integers and their place numbers is

*S*1 = 2 (1 + 2 + *···* + 2*n*) = 2*n* (2*n* + 1) ≡ 0 (mod 2*n*)*.*

The sum of all remainders is

*S*2 = 0 + 1 + *···* + 2*n* − 1 = *n* (2*n* − 1) ≡ *n* (mod 2*n*)*.*

Contradiction!

19. Let the numbering of the prongs be *i*1*, i*2*, ··· , in*.
Clearly *i*1 + · + *in* = *n*(*n* + 1)*/*2. If *n* is odd, then the numbering *ij* = *n* + 1 − *j* works. Suppose the numbering is good.
The prong and hole with number *ij* coincide if the plug is rotated by *ij* − *j* (or *ij* − *j* + *n*) units ahead. This means that (*i*1 − 1) + ... + (*in* − *n*) = 1 + 2 + ... *n* (mod *n*). The LHS is 0.
The RHS is *n*(*n* + 1)*/*2. This is divisible by *n* if *n* is odd.

20. Invariants of this transformation are

*P* : gcd(*x, y*) = gcd(*x* − *y, x*) = gcd(*x, y* − *x*),

1. The Invariance Principle 17

*Q* : *xv* + *yu* = 2*ab*, *R* : *x \>* 0*, y \>* 0.

*P* and *R* are obviously invariant. We show the invariance of *Q*.
Initially, we have *ab* + *ab* = 2*ab*, and this is obviously correct.
After one step, the left side of *Q* becomes either *x*(*v*+*u*)+(*y*−*x*)*u* = *xv*+*yu* or (*x*−*y*)*v*+*y*(*u*+*v*) = *xv*+*yu*, that is, the left side of *Q* does not change. At the end of the game, we have *x* = *y* = gcd(*a, b*) and

*x*(*u* + *v*) = 2*ab* → (*u* + *v*)*/*2 = *ab/x* = *ab/* gcd(*a, b*) = lcm(*a, b*)*.*

21. Initially, if all components are greater than 1, then they will remain greater than 1. Starting with the second triple the largest component is always the sum of the other two components diminished by 1. If, after some step, we get (*a, b, c*) with *a* ≤*b* ≤ *c*, then *c* = *a* + *b* − 1, and a backward step yields the triple (*a, b, b* − *a* + 1). Thus, we can retrace the last state (17*,* 1967*,* 1983) uniquely until the next to last step: (17*,* 1967*,* 1983) ← (17*,* 1967*,* 1951) ← (17*,* 1935*,* 1951) ← ... ←(17*,* 15*,* 31) ← (17*,* 15*,* 3) ← (13*,* 15*,* 3) ← ... ← (5*,* 7*,* 3) ← (5*,* 3*,* 3). The preceding triple should be (1*,* 3*,* 3) containing 1, which is impossible. Thus the triple (5*,* 3*,* 3) is generated at the first step. We can get from (3*,* 3*,* 3) to (5*,* 3*,* 3) in one step, but not from (2*,* 2*,* 2).

22. Let *ai* be the number of chips on the circle \#*i*. We consider the sum *S* ==*iai*. *k* ∈ {1*,* 2*, ··· , n*}. Each move changes *S* by 0, or *n*, or −*n*, that is, *S* is invariant mod *n*. At the end, *S* ≡ 0 mod *n*. Hence, at the beginning, we must have *S* ≡ 0 mod *n*. This is the case for odd *n*. Reaching the goal is trivial in the case of an odd *n*.

23. **Solution 1.** Suppose we get only integer *n*-tuples from (*x*1*, ··· , xn*). Then the difference between the maximal and minimal term decreases. Since the difference is integer, from some time on it will be zero. Indeed, if the maximum *x* occurs *k* times in a row, then it will become smaller than *x* after *k* steps. If the minimum *y* occurs *m* times in a row, then it will become larger after *m* steps. In a finite number of steps, we arrive at an integral *n*-tuple (*a, a, ··· , a*).
We will show that we cannot get equal numbers from pairwise different numbers. Supppose *z*1*, ··· , zn* are not all equal, but (*z*1 + *z*2)*/*2 = (*z*2 + *z*3)*/*2 = ... = (*zn* + *z*1)*/*2. Then *z*1 = *z*3 = *z*5 = ... and *z*2 = *z*4 = *z*6 = .... If *n* is odd then all *zi* are equal, contradicting our assumption. For even *n* = 2*k*, we must eliminate the case (*a, b, ··· , a, b*) with *a* ̸= *b*.
Suppose

*y*1 ~~+~~ *y*22 =*y*3 + *y*4= ... =*yn*−1 + *yn*= *a, y*2 + *y*3= ·
· · =*yn* + *y*1= *b.*

But the sums of the left sides of the two equation chains are equal, i.e., *a* = *b*, that is, we cannot get the *n*-tuple (*a, b, ··· , a, b*) with *a* ̸= *b*.

**Solution 2.** Let ⃗*x* = (*x*1*, ··· , xn*), *T* ⃗*x* = ⃗*y* = (*y*1*, ··· , yn*). With *n* + 1 = 1,

+-----------+-----------+-----------+-----------+-----------+-----------+
| > *n*\    | *y*2 *i*= | > *n*\    | > *n*\    | > *n*\    | *x*2 *i.* |
| > =       | 1         | > =       | > =(*x*2  | > =       |           |
|           |           | > *i*+1+  | > *i*+    |           |           |
|           |           | > 2       | > *x*2    |           |           |
|           |           | *xixi*+1) | > *i*+1+  |           |           |
|           |           | > ≤       | > *x*2    |           |           |
|           |           | > 1(*x*2  | > *i*+    |           |           |
|           |           | > *i*+    | > *x*2    |           |           |
|           |           | > *x*2    | > *i*+1)  |           |           |
|           |           | > 4*i*=1  | > =*i*=1  |           |           |
+===========+===========+===========+===========+===========+===========+ +-----------+-----------+-----------+-----------+-----------+-----------+

We have equality if and only if *xi* = *xi*+1 for all *i*. Suppose the components remain integers. Then the sum of squares is a strictly decreasing sequence of positive integers until all integers become equal after a finite number of steps. Then we show as in

18 1. The Invariance Principle

solution 1 that, from unequal numbers, you cannot get only equal numbers in a finite number of steps.

*Another Solution Sketch.* Try a geometric solution from the fact that the sum of the components is invariant, which means that the centroid of the *n* points is the same at each step.

24. If you find a negative sum in any row or column, change the signs of all numbers in that row or column. Then the sum of all numbers in the table strictly increases. The sum cannot increase indefinitely.
Thus, at the end, all rows and columns will have nonnegative signs.

25. The diagonals partition the interior of the polygon into convex polygons. Consider two neighboring polygons *P*1*, P*2 having a common side on a diagonal or side *XY*. Then *P*1*, P*2 both belong or do not belong to the triangles without the common side *XY*. Thus, if *P* goes from *P*1 to *P*2, the number of triangles changes by *t*1 −*t*2, where *t*1 and *t*2 are the numbers of vertices of the polygon on the two sides of *XY*. Since *t*1 + *t*2 = 2*m* + 2, the number *t*1 − *t*2 is also even.

26. You cannot get rid of an odd divisor of the difference *b* − *a*, that is, you can reach (1*,* 50) from (5*,* 19), but not (1*,* 100).

27. The three automata leave gcd(*x, y*) unchanged. We can reach (19*,* 79) from (1*,* 2), but not (819*,* 357). We can reach (*p, q*) from (*a, b*) iff gcd(*p, q*) = gcd(*a, b*) = *d.* Go from (*a, b*) down to (1*, d* + 1), then, up to (*p, q*).

28. From the inequality 1*/a* + 1*/b* ≥ 4*/*(*a* + *b*) which is equivalent to (*a* + *b*)*/*2 ≥2*ab/*(*a* + *b*), we conclude that the sum *S* of the inverses of the numbers does not increase. Initially, we have *S* = *n*. Hence, at the end, we have *S* ≤ *n*. For the last number 1*/S*, we have 1*/S* ≥ 1*/n*.

29. The permissible transformations leave the sides of the polygon and their directions *invariant*. Hence, there are only a finite number of polygons. In addition, the area strictly increases after each reﬂection. So the process is finite.

*Remark.* The corresponding problem for line reﬂections in AB is considerably harder. The theorem is still valid, but the proof is no more elementary. The sides still remain the same, but their direction changes. So the finiteness of the process cannot be easily deduced. (In the case of line reﬂections, there is a conjecture that 2*n* reﬂections suffice to reach a convex polygon.)

30. Let *f* (*x*) = *x*2− 3*x* + 3*.* We are asked to solve the equation *f* (*f* (*x*)) = *x*, that is to find the fixed or invariant points of the function *f* ◦ *f* . First, let us look at *f* (*x*) = *x*, i.e. the fixed points of *f* . Every fixed point of *f* is also a fixed point of *f* ◦*f* . Indeed,

*f* (*x*) = *x* ⇒ *f* (*f* (*x*)) = *f* (*x*) ⇒ *f* (*f* (*x*)) = *x.*

First, we solve the quadratic *f* (*x*) = *x*, or *x*2− 4*x* + 3 = 0 with solutions *x*1 = 3, *x*2 = 1. *f* \[*f* (*x*)\] = *x* leads to the fourth degree equation *x*4−6*x*3+12*x*2−10*x*+3 =0, of which we already know two solutions 3 and 1. So the left side is divisible by will be proved in the chapter on polynomials, but the reader may know this from *x* − 3 and *x* − 1 and, hence, by the product (*x* − 3)(*x* − 1) = *x*2− 4*x* + 3. This high school. Dividing the left side of the 4th-degree equation by *x*2− 4*x* + 3 we get *x*2− 2*x* + 1. Now *x*2− 2*x* + 1 = 0 is equivalent to (*x* − 1)2= 0. So the two other solutions are *x*3 = *x*4 = 1. We get no additional solutions in this case, but usually, the number of solutions is doubled by going from *f* \[*x*\] = *x* to *f* \[*f* (*x*)\] = *x*.

1. The Invariance Principle 19

31. Suppose the product *P* is odd. Then, each of its factors must be odd. Consider the sum *S* of these numbers. Obviously *S* is odd as an odd number of odd summands. On the other hand, *S* ==(*ai* −*i*) ==*ai* −=*i* = 0, since the *ai* are a permutation

32. We partition the participants into the set *E* of even persons and the set *O* of odd persons. We observe that, during the hand shaking ceremony, the set *O* cannot change its parity. Indeed, if two odd persons shake hands, *O* increases by 2. If two even persons shake hands, *O* decreases by 2, and, if an even and an odd person shake hands, \|*O*\| does not change. Since, initially, \|*O*\| = 0, the parity of the set is preserved.

33. Consider the number *U* of inversions, computed as follows: Below each 1, write the number of zeros to the right of it, and add up these numbers. Initially *U* = 0. *U* does not change at all after each move, or it increases or decreases by 2. Thus *U* always remains even.
But we have *U* = 1 for the goal. Thus, the goal cannot be reached.

34. Consider the trinomial *f* (*x*) = *ax*2+ *bx* + *c*. It has discriminant *b*2− 4*ac*. The first transformation changes *f* (*x*) into (*a* + *b* + *c*)*x*2+ (*b* + 2*a*)*x* + *a* with discriminant (*b* + 2*a*)2− 4(*a* + *b* + *c*) · *a* = *b*2− 4*ac*, and, applying the second transformation, we get the trinomial *cx*2+ (*b* − 2*c*)*x* + (*a* − *b* + *c*) with discriminant *b*2− 4*ac*. Thus the discriminant remains invariant. But *x*2+ 4*x* + 3 has discriminant 4, and *x*2+ 10*x* + 9 has discriminant 64. Hence, one cannot get the second trinomial from the first.

35. For three squares in arithmetic progression, we have *a*2 3− *a*2 2= *a*2 2− *a*2 1or (*a*3 −*a*2)(*a*3 + *a*2) = (*a*2 − *a*1)(*a*2 + *a*1). Since *a*2 + *a*1 *\< a*3 + *a*2, we must have *a*2 − *a*1 *\>
a*3 − *a*2. Suppose that *a*2 1*, a*2 2*, a*2 3*, ···* is an infinite arithmetic progression. Then

*a*2 − *a*1 *\> a*3 − *a*2 *\> a*4 − *a*3 *\>* ... *.*

This is a contradiction since there is no infinite decreasing sequence of positive integers.

36. Suppose the integers 1*, ··· , n* are arranged in any order. We will say that the numbers *i* and *k* are out of order if the larger of the two is to the left of the smaller. In that case, they form an *inversion*. Prove that interchange of two neighbors changes the parity of the number of inversions.

37. Interchange of any two integers can be replaced by an odd number of interchanges of neighboring integers.

38. The number of inversions in *n, ··· ,* 1 is *n*(*n* − 1)*/*2.
Prove that one step does not change the parity of the inversions. If *n*(*n* − 1)*/*2 is even, then split the *n* integers into pairs of neighbors (leaving the middle integer unmatched for odd *n*). Then form quadruplets from the first, last, second, second from behind, etc.

39. We assign the weight 1*/*2*x*+*y*to the square with label (*x, y*). We observe that the total weight of the squares covered by chips does not change if a chip is replaced by two neighbors. The total weight of the first column is

1 +12+ 14+ ... = 2*.*

+-------------+-------------+-------------+-------------+-------------+
| <table>     | **dd d t**  | 1. The     |             | 21          |
| <colgroup>  |             | Invariance  |             |             |
| <col        |             | Principle   |             |             |
|  style="wid |             |             |             |             |
| th: 50%" /> |             |             |             |             |
| <col        |             |             |             |             |
|  style="wid |             |             |             |             |
| th: 50%" /> |             |             |             |             |
| </colgroup> |             |             |             |             |
| <thead>     |             |             |             |             |
| <tr clas    |             |             |             |             |
| s="header"> |             |             |             |             |
| <th>Fi      |             |             |             |             |
| g. 1.9</th> |             |             |             |             |
| <th><       |             |             |             |             |
| blockquote> |             |             |             |             |
| <p><stro    |             |             |             |             |
| ng>===</str |             |             |             |             |
| ong> <stron |             |             |             |             |
| g>=======</ |             |             |             |             |
| strong></p> |             |             |             |             |
| </block     |             |             |             |             |
| quote></th> |             |             |             |             |
| </tr>       |             |             |             |             |
| </thead>    |             |             |             |             |
| <tbody>     |             |             |             |             |
| </tbody>    |             |             |             |             |
| </table>    |             |             |             |             |
+=============+=============+=============+=============+=============+
|             |             | > **t**     | **t**       |             |
|             |             | > **dd**    |             |             |
|             |             | > Fig.      |             |             |
|             |             | > 1.10**t** |             |             |
|             |             | > **d**     |             |             |
+-------------+-------------+-------------+-------------+-------------+

  --- --- --- --- --- --- --- --- --- --- --- --- --- --- --- --- --- --- ---
                                                                          

                                                                          

                                                                          

                                                                          

                                                                          

                                                                          

                                                                          

                                                                          

                                                                          

                                                                          

                                                                          

                                                                          

                                                                          

                                                                          

                                                                          

                                                                             --- --- --- --- --- --- --- --- --- --- --- --- --- --- --- --- --- --- ---

  ----------------------- ----------------------- -----------------------
                                                  

                                                     ----------------------- ----------------------- -----------------------

  ----------------------- ----------------------- -----------------------
                                                  

                                                     ----------------------- ----------------------- -----------------------

  ----------------------- ----------------------- -----------------------
                                                  

                                                     ----------------------- ----------------------- -----------------------

  ----------------------- ----------------------- -----------------------
                                                  

                                                     ----------------------- ----------------------- -----------------------

Denote the number of occupied cells of colors *A, B, C* by *a, b, c*, respectively. Initially, *a* = *b* = *c*, i.e., *a* ≡ *b* ≡ *c* mod 2.
That is, all three numbers have the same parity. If we make a jump, two of these numbers are decreased by 1, and one is increased by 1.
After the jump, all three numbers change parity, i.e., they still have the same parity. Thus, we have found the invariant *a* ≡ *b* ≡ *c* mod 2. This relation is violated if only one chip remains on the board. We can even say more. If two chips remain on the board, they must be on squares of the same color.

43. By looking at a healthy cell with 2, 3, or 4 infected neighbors, we observe that the perimeter of the contaminated area does not increase, although it may well decrease. Initially, the perimeter of the contaminated area is at most 4 × 9 = 36. The goal 4 × 10 = 40 will never be reached.

44. By applying these three operations on *f* and *g*, we get a polynomial

*P* (*f* (*x*)*, g*(*x*)) = *x,* (1)which should be valid for all *x*.
In (a) and (b), we give a specific value of *x*, for which (1) is not true. In (a) *f* (2) = *g*(2) = 6. By repeated application of the three operations on 6 we get again a multiple of 6. But the right side of (1) is 2.

In (b) *f* (1*/*2) = *g*(1*/*2) = 1. The left-hand side of (1) is an integer, and the right-hand side 1*/*2 is a fractional number.

In (c) we succeed in finding a polynomial in *f* and *g* which is equal to *x*:

(*f* − *g*)2+ 2*g* − 3*f* = *x.*

45. We should get *x*2 the significant digits. One gets the table below.
This is a very robust computation. No*n*+ *y*2 *n*= 1 for all *n*, but rounding errors corrupt more and more of "catastrophic cancellations"
ever occur. Quite often one does not get such precise results. In computations involving millions of operations, one should use double precision to get single precision results.

46. Since 1994 = 18 + 19 · 104, we get 18 + 19 = 37, 37 + 19 = 56*, ··· ,* 1975 + 19 =1994. It is not so easy to find all numbers which can be reached starting from 18 and 19. See Chapter 6, especially the Frobenius Problem for *n* = 3 at the end of the chapter.

2

Coloring Proofs

The problems of this chapter are concerned with the partitioning of a set into a finite number of subsets. The partitioning is done by *coloring* each element of a subset by the same color. The prototypical example runs as follows.

In 1961, the British theoretical physicist M.E. Fisher solved a famous and very tough problem. He showed that an 8 × 8 chessboard can be covered by 2 × 1 dominoes in 24× 9012or 12,988,816 ways. Now let us cut out two diagonally opposite corners of the board. In how many ways can you cover the 62 squares of the mutilated chessboard with 31 dominoes?

The problem looks even more complicated than the problem solved by Fisher, but this is not so. The problem is trivial. There is no way to cover the mutilated chessboard. Indeed, each domino covers one black and one white square. If a covering of the board existed, it would cover 31 black and 31 white squares. But the mutilated chessboard has 30 squares of one color and 32 squares of the other color.

The following problems are mostly ingenious impossibility proofs based on coloring or parity. Some really belong to Chapter 3 or Chapter 4, but they use coloring, so I put them in this chapter. A few also belong to the closely related Chapter 1. The mutilated chessboard required two colors. The problems of this chapter often require more than two colors.

2. Coloring Proofs 27

13. Every point of the plane is colored *red* or *blue*. Show that there exists a rectangle with vertices of the same color. Generalize.

14. Every space point is colored either *red* or *blue*. Show that among the squares with side 1 in this space there is at least one with three red vertices or at least one with four blue vertices.

15. Show that there is no curve which intersects every segment in Fig.
2.6 exactly once.

  ----------------- ----------------- ----------------- -----------------
                                                        

  ----------------- ----------------- ----------------- -----------------

Fig. 2.6

16. On one square of a 5 × 5 chessboard, we write −1 and on the other 24 squares +1. In one move, you may reverse the signs of one *a* ×*a* subsquare with *a \>* 1. My goal is to reach +1 on each square. On which squares should −1 be to reach the goal?

17. The points of a plane are colored *red* or *blue*. Then one of the two colors contains points with any distance.

18. The points of a plane are colored with three colors. Show that there exist two points with distance 1 both having the same color.

19. All vertices of a convex pentagon are lattice points, and its sides have integral length. Show that its perimeter is even.

20. *n* points (*n* ≥ 5) of the plane can be colored by two colors so that no line can separate the points of one color from those of the other color.

21. You have many 1 × 1 squares. You may color their edges with one of four colors and glue them together along edges of the same color.
Your aim is to get an *m* × *n* rectangle. For which *m* and *n* is this possible?

22. You have many unit cubes and six colors. You may color each cube with 6 colors and glue together faces of the same color. Your aim is to get a *r* × *s* × *t* box, each face having different color. For which *r*, *s*, *t* is this possible?

23. Consider three vertices *A* = (0*,* 0), *B* = (0*,* 1), *C* = (1*,* 0) in a plane lattice. Can points previously reﬂected?you reach the fourth vertex *D* = (1*,* 1) of the square by reﬂections at *A*, *B*, *C* or at

24. Every space point is colored with exactly one of the colors *red*, *green*, or *blue*. The sets *R*, *G*, *B* consist of the lengths of those segments in space with both endpoints *red*, *green*, and *blue*, respectively. Show that at least one of these sets contains all nonnegative real numbers.

25. *The Art Gallery Problem*. An art gallery has the shape of a simple *n*-gon. Find the minimum number of watchmen needed to survey the building, no matter how complicated its shape.

26. A 7×7 square is covered by sixteen 3×1 and one 1×1 tiles. What are the permissible positions of the 1 × 1 tile?

27. The vertices of a regular 2*n*-gon *A*1*, ··· , A*2*n* are partitioned into *n* pairs. Prove that, if *n* = 4*m* + 2 or *n* = 4*m* + 3, then two pairs of vertices are endpoints of congruent segments.

28. A 6×6 rectangle is tiled by 2×1 dominoes. Then it has always at least one *fault-line*, i.e., a line cutting the rectangle without cutting any domino.

28 2. Coloring Proofs

29. Each element of a 25 × 25 matrix is either +1 or −1. Let *ai* be the product of all elements of the *i*th row and *bj* be the product of all elements of the *j*th column. Prove that *a*1 + *b*1 + ... + *a*25 + *b*25 ̸= 0.

30. Can you pack 53 bricks of dimensions 1 × 1 × 4 into a 6 × 6 × 6 box? The faces of the bricks are parallel to the faces of the box.

31. Three pucks *A*, *B*, *C* are in a plane. An ice hockey player hits the pucks so that any one glides through the other two in a straight line. Can all pucks return to their original spots after 1001 hits?

32. A 23 × 23 square is completely tiled by 1 × 1, 2 × 2 and 3 × 3 tiles. What minimum number of 1 × 1 tiles are needed (AUO 1989)?

33. The vertices and midpoints of the faces are marked on a cube, and all face diagonals aredrawn.Isitpossibletovisitallmarkedpointsbywalkingalongthefacediagonals?

34. There is no closed knight's tour of a (4 × *n*) board.

35. The plane is colored with two colors. Prove that there exist three points of the same color, which are vertices of a regular triangle.

36. A sphere is colored in two colors. Prove that there exist on this sphere three points of the same color, which are vertices of a regular triangle.

37. Given an *m* × *n* rectangle, what minimum number of cells (1 × 1 squares) must be colored, such that there is no place on the remaining cells for an L-tromino?

38. The positive integers are colored black and white. The sum of two differently colored numbers is black, and their product is white. What is the product of two white numbers? Find all such colorings.

Solutions

1. Color the ﬂoor as in Fig. 2.7. A 4 × 1 tile always covers 0 or 2 black squares. A 2 × 2 tile always covers one black square. It follows immediately from this that it is impossible to exchange one tile for a tile of the other kind.

  ----------------- ----------------- ----------------- -----------------
                                                        

                                                        

                                                        

                                                        

                                                           ----------------- ----------------- ----------------- -----------------

Fig. 2.7

2. Any rectangle with 20 squares can be colored like a chessboard with 10 black and 10 white squares. Four of the tetrominoes will cover 2 black and 2 white squares each. The remaining 2 black and 2 white squares cannot be covered by the T-tetromino. A T-tetromino always covers 3 black and one white squares or 3 white and one black squares.

3. A T-tetromino either covers one white and three black squares or three white and one blacksquares.See Fig.2.8.Tocoveritcompletely,we need equally many tetrominoes of each kind. But 25 is an odd number.
Contradiction!

2. Coloring Proofs 29

4. The square tetromino covers two black and two white squares. The remaining 30 black and 30 white squares would require an equal number of tetrominoes of each kind. On the other hand, one needs 15 tetrominoes for 60 squares. Since 15 is odd, a covering is not possible.

5. Color the board diagonally in four colors 0, 1, 2, 3 as shown in Fig. 2.10. No matter how you place a straight tetromino on this board, it always covers one square of each color. 25 straight tetrominoes would cover 25 squares of each color. But there are 26 squares with color 1.

  ----------------- ----------------- ----------------- -----------------
                                                        

  ----------------- ----------------- ----------------- -----------------

30 2. Coloring Proofs

<table style="width:100%;">
<colgroup>
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 10%" />
</colgroup>
<thead>
<tr class="header">
<th colspan="10"><blockquote>
<p>1 2 3 0 1 2 3 0 1 20 1 2 3 0 1 2 3 0 1 3 0 1 2 3 0 1 2 3 0 2 3 0 1 2 3 0 1 2 3 1 2 3 0 1 2 3 0 1 2 0 1 2 3 0 1 2 3 0 1 3 0 1 2 3 0 1 2 3 0 2 3 0 1 2 3 0 1 2 3 1 2 3 0 1 2 3 0 1 2 0 1 2 3 0 1 2 3 0 1</p>
</blockquote></th>
</tr>
</thead>
<tbody>
</tbody>
</table>

Fig. 2.10

7. Assign coordinates (*x, y, z*) to the cells of the box, 1 ≤ *x, y, z* ≤ 10. Color the cells in four colors denoted by 0, 1, 2, 3. The cell (*x, y, z*) is assigned color *i* if *x* + *y* + *z* ≡ *i* mod 4.
This coloring has the property that a 1 × 1 × 4 brick always occupies one cell of each color no matter how it is placed in the box. Thus, if the box could be filled with two hundred fifty 1 × 1 × 4 bricks, there would have to be 250 cells of each of the colors 0, 1, 2, 3, respectively. Let us see if this necessary packing condition is satisfied. Fig. 2.10 shows the lowest level of cells with the corresponding coloring. There are 26, 25, 24, 25 cells with color 0, 1, 2, 3 respectively. The coloring of the next layer is obtained from that of the preceding layer by adding 1 mod 4. Thus the second layer has 26, 25, 24, 25 cells with colors 1, 2, 3, 0, respectively. The third layer has 26, 25, 24, 25 cells with colors 2, 3, 0, 1, respectively, the fourth layer has 26, 25, 24, 25 cells with colors 3, 0, 1, 2, respectively, and so on. Thus there are (26 + 25 + 24 + 25) ·
2 + 26 + 25 = 251 cells of color 0. Hence there is no packing of the 10 × 10 × 10 box by 1 × 1 × 4 bricks.

8. If *n*\|*a* or *n*\|*b*, the board can be covered by 1 × *n* tiles in an obvious way. Suppose *n* ̸ \| *a*, i.e., *a* = *q* · *n* + *r,* 0 *\< r \< n*. Color the board as indicated in Fig. 2.9. There are *bq* + *b* squares of each of the colors 1*,* 2*, ··· , r*, and there are *bq* squares of each of the colors 1*, ··· , n*. The *h* horizontal 1 × *n* tiles of a covering each cover one square of each color. Each vertical 1 × *n* tile covers *n* squares of the same color. After the *h* horizontal tiles are placed, there will remain (*bq* + *b* − *h*) squares of each of the colors 1*, ··· , r* and *bq* − *h* of each of the colors *r* + 1*, ··· , n*. Thus *n*\|*bq* + *b* − *h* and *n*\|*bq* − *h*. But if *n* divides two numbers, it also divides their difference: (*bq* + *b* − *h*) − (*bq* − *h*) = *b*. Thus, *n*\|*b*. Space analogue: *If an a* × *b* × *c box can be tiled with n* × 1 × 1 *bricks, then n*\|*a or n*\|*b or n*\|*c*.

  ----------------------------------- -----------------------------------
  Fig. 2.11                           Fig. 2.12

  ----------------------------------- -----------------------------------

  --- --- --- --- --- --- --- --- --- --- --- --- --- --- --- --- --- --- --- ---
                                                                              

                                                                              

                                                                              

                                                                              

                                                                              

                                                                              

                                                                              

                                                                              

                                                                                 --- --- --- --- --- --- --- --- --- --- --- --- --- --- --- --- --- --- --- ---

  ----- ----- ----- ----- ----- ----- ----- ----- ----- ----- ----- ----- ----- -----
                                                                                

                                                                                

                                                                                

                                                                                

                                                                                

                                                                                   ----- ----- ----- ----- ----- ----- ----- ----- ----- ----- ----- ----- ----- -----

  -------------- -------------- -------------- -------------- --------------

  -------------- -------------- -------------- -------------- --------------

~~⊤ ⊣ ⊤ ⊤ ⊤~~

Fig. 2.13

2. Coloring Proofs 31

9. Color the board as in Fig. 2.12. There are 2*n*2+ *n* white squares and 2*n*2+ 3*n* black squares, a total of 4*n*2+ 4*n* squares.
2*n*2+ 2*n* dominoes will be required to cover all of these squares.
Since one half of these dominoes are to be horizontal, there will be *n*2+ *n* vertical and *n*2+ *n* horizontal dominoes. Each vertical domino covers one black and one white square. When all the vertical dominoes are placed, they cover *n*2+ *n* white squares and *n*2+ *n* black squares. The remaining *n*2white squares and *n*2+2*n* black squares must be covered by horizontal dominoes. A horizontal domino covers only squares of the same color. To cover the *n*2white squares *n*2, i.e., *n* must be even. One easily shows by actual construction that this necessary condition is also sufficient. Thus, the required covering is possible for a (4*n* + 1) × (4*n* + 1) board and is impossible for a (4*n* − 1) × (4*n* − 1) board.

10. Suppose the ﬂoor is ruled into squares colored black and white like a chessboard. Further suppose that the central box of the cross covers a black square. Then the four other boxes stand on white squares. It is easy to see that the transition ⊤ → ⊤requires an even number of ﬂips whereas a transition ⊤ →⊢ requires an odd number of
ﬂips. Hence the boxes #1, 3, 4, 5 in Fig. 2.13 originally stand on squares of the same color. Now the squares occupied by boxes #1*,* 3*,* 5 are the same color, and so boxes #1*,* 3*,* 5 must have originated on squares of the same color. Since there are not three boxes which originated on black squares, these boxes must stand on white squares. Box #2 must have been ﬂipped an odd number of times. It is now on a black square. Hence it was originally on a white square.
Box #4 is now on a black square. Since it was ﬂipped an even number of times, it was originally on a black square. Thus #4 is the central box.

11. Color the cities black and white so that neighboring cities have different colors as shown in Fig. 2.14. Every path through the 14 cities has the color pattern bwbwbwbwbwbwbw or wbwbwbwbwbwbwb. So it passes through seven black and seven white cities. But the map has six black and eight white cities. Hence, there is no path passing through each city exactly once.

**d** **t** **d** **t**

2. Coloring Proofs 33

Rotating Fig. 2.17 about *r* we get a circle of red points *r*′. This circle contains a chord of length 1. Contradiction!

*Alternate solution*. For Fig. 2.18 consisting of 11 unit rods, you need at least four colors, if vertices of distance 1 are to have distinct colors.

19. Color the lattices as in a chess board. Erect right triangles on the sides of the pentagon as longest sides. With the two other sides along the sides of the squares, trace the ten shorter sides. Since, at the end, we return to the vertex we left, we must have traced an even number of lattice points (on transition from one lattice point to the next the color of the lattice point changes). Hence the sum of shorter sides is even. The parity of the longer sides (i.e., the sides of the pentagon) is equivalent to the parity of the sums of the shorter sides.
Hence the perimeter of the pentagon has the same parity as the sum of the shorter sides.

20. Of *n* ≥ 5 points, it is always possible to choose four vertices of a convex polygon. If we color two opposite vertices the same color, then no line will separate the two sets of points.

21. *Result*: We can glue together an *m* × *n* rectangle iff *m* and *n* have the same parity. (a) *m* and *n* are both odd. Then we can glue together an 1 × *n* rectangle as in Fig. 2.19. From these strips, we can glue together the rectangle in Fig. 2.20.

\(b\) *m* and *n* are even. Consider the rectangles with odd side lengths of dimensions (*m* − 1) × (*n* − 1), 1 × (*n* − 1), (*m* − 1)
× 1, and 1 × 1, respectively. They can be assembled into the rectangle *m* × *n*.

\(c\) *m* is even, and *n* is odd. Suppose we succeeded in gluing together a rectangle rectangle with odd length. Suppose it is colored red. Let us count the total number *m* × *n* satisfying the conditions of the problem. Consider one of the sides of the of red sides of the squares. On the perimeter of the rectangle, there are *n* and in the interior there is an even number, since another red neighbor belongs to one red side of a square. Thus the total number of red sides is odd. The total number of squares is the same as the number of red sides, i.e., odd. On the other hand this number is *m n*, that is, an even number. Contradiction!

<table style="width:100%;">
<colgroup>
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 10%" />
</colgroup>
<thead>
<tr class="header">
<th colspan="2" rowspan="2"><blockquote>
<p><strong>"b""" b</strong><br />
<strong>bbb</strong></p>
</blockquote></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
</tr>
<tr class="odd">
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>

34 2. Coloring Proofs

of the same color. Thus it is not possible to reach the opposite vertex of the square *ABCD*.

24. Let *P*1*, P*2*, P*3 be the three sets. We assume on the contrary that *a*1 is not assumed by *P*1, *a*2 is not assumed by *P*2, and *a*3 is not assumed by *P*3. We may assume that *a*1 ≥ *a*2 ≥ *a*3 *\>* 0.

  -----------------------------------------------------------------------
  *x*1                                *a*2   ----------------------------------- -----------------------------------

  -----------------------------------------------------------------------

+-----------------------------------+-----------------------------------+
| > *a*1                            |                                   |
+===================================+===================================+
|                                   |                                   |
+-----------------------------------+-----------------------------------+

2. Coloring Proofs 35

27. Suppose that all pairs of vertices have different distances. To the segment *ApAq*, we assign the smaller of the numbers \| *p* − *q* \| and 2*n*− \| *p* − *q* \|. We get the numbers 1*, ··· , n*. Suppose that among these numbers there are *k* even and *n*−*k* odd numbers. To the odd numbers correspond the segments *ApAq*, where *p, q* have different parity. Hence, among the remaining segments there will be *k* vertices with odd numbers and *k* vertices with even numbers, with the segments connecting vertices of the same parity. Hence *k* is even. For the numbers *n* of the type 4*m,* 4*m* + 1*,* 4*m* + 2*,* 4*m* + 3 the number *k* of even numbers is 2*m,* 2*m,* 2*m* + 1*,* 2*m* + 1, respectively. Hence *n* = 4*m* or *n* = 4*m* + 1.

28. We consider an amazing proof due to S. W. Golomb and R. I.
Jewett. Suppose we have a fault-free 6 × 6 square. Notice that each tile breaks *exactly one* potential fault-line. Furthermore (and this is the crucial observation), if any fault-line (say L in Fig. 2.24) is broken by just a *single tile*, then the remaining regions on either side of it must have an odd area, since they consist of 6 × *t* rectangles with a single unit square removed. However, such regions are impossible to tile by dominoes. Thus each of the 10 potential fault-lines must be broken by at least two tiles.

  ----------------------------------------------------------------------------
                                                                    L   ---------- ---------- ---------- ---------- ---------- ---------- ----------
                                                                    

                                                                    

                                                                    

                                                                    

                                                                       ----------------------------------------------------------------------------

Fig. 2.24

Since no tile can break more than one fault-line, then at least 20 tiles will be needed for the tiling. But the area of the 6 × 6 square is only 36 whereas the area of the 20 tiles is 40. Contradiction! No such tiling of the 6 × 6 square can exist.

*Remark*: A *p* × *q* rectangle can be tiled fault-free by dominoes iff the following conditions hold:\ (1) *pq* is even. (2) *p* ≥ 5*, q* ≥ 5. (3) (*p, q*) ̸= (6*,* 6).

29. *a*1*a*2 *··· a*25 = *b*1*b*2 *··· b*25 = product of all elements of the matrix. Let *a*1 + *b*1 + *a*2 + *b*2 + *···* + *a*25 + *b*25 = 0. To cancel, there must be the same number of positive and negative summands. If among the *ai* there are *n* negative terms, then among the *bj* there are 25 − *n* negative terms. The numbers *n* and 25 − *n* have different parity. Hence the products *a*1 *··· a*25 and *b*1 *··· b*25 have different signs and cannot be equal.
Contradiction.

30. The 6 × 6 × 6 cube consists of 27 subcubes of dimensions 2 × 2 × 2.
Color them alternately black and white as a chessboard. Then 14 subcubes will be colored black and 13 white, that is, there will be 112 black and 104 white unit cubes. Any 1×1×4 brick will use up 2 black and 2 white unit cubes. 53 bricks will use up 106 white unit cubes. But there are only 104 white unit cubes.

31. No! After each hit, the orientation of the triangle *ABC* changes.

32. Suppose no 1 × 1 tile is needed. Color the rows of the square alternately black and white. There will be 23 more black than white unit squares. A 2×2 tile covers equally many black and white unit squares. A 3 × 3 tile covers three more unit squares of one color than the other.
Hence the difference of the number of black and white unit

36 2. Coloring Proofs

squares is divisible by 3. But 23 is not divisible by 3. Hence the assumption is false. So at least one 1 × 1 tile is needed. By actual construction, we prove that one 1 × 1 tile is also sufficient. Put the 1 × 1 tile into the center and split the remaining board into four 12
× 11 rectangles. Each 12 × 11 rectangle can be tiled with a row of six 2 × 2 and three rows of 3 × 3 tiles, each consisting of four tiles.

33. No! On the walk, vertices and centers of faces are alternating, but a cube has 8 vertices and 6 faces. This is exactly problem 11.

  -----------------------------------------------------------------------
  a           b           a           b           a           b   ----------- ----------- ----------- ----------- ----------- -----------
  c           d           c           d           c           d

  d           c           d           c           d           c

  b           a           b           a           b           a   -----------------------------------------------------------------------

Fig. 2.25

34. Color the board with four colors *a, b, c, d*, as in Fig. 2.25.
Every *a*-cell must be preceded and followed by a *c*-cell. There are equally many *a*- and *c*-cells, and all must lie on any closed tour.
To get all of them, we must avoid the *b*- and *c*-cells altogether.
Once a jump is made from a *c*-cell to a *d*-cell there is no way to get back to an *a*-cell without first landing on another *c*-cell. The existence of a closed tour would imply that there are more *c*-cells than *a*-cells. Contradiction! There exist eight open tours of a 4 × 3 board. Find all of them.

35. Consider a regular hexagon together with its center.

36. Inscribe a regular icosahedron into the sphere. Start coloring the triangles of its faces in two colors. No matter how you do it, there will be regular triples of vertices at distance 2 (along the edges) colored with the same color.

37. Suppose *m* and *n* are both even. We color every second vertical strip. An L--tromino cannot be placed on the remaining squares. We prove that it is not possible to use a smaller number of colorings.
Indeed, we can partition the rectangle into *mn/*4 answer is *mn/*2.
squares of size 2 × 2. We must color at least two cells in each such square. The Suppose*n*is even and*m* odd.We coloreverysecondstripintheodd direction, starting with the second. We prove that a smaller number of colorings is not sufficient. Indeed, from such a rectangle we may cut out *n*(*m* − 1)*/*4 squares of size 2 × 2, in each of which we must color at least two cells. The answer in this case is *n*(*m* − 1)*/*2. Suppose *n* and *m* are both odd and *n* ≥ *m*. Since both directions are odd we take the one giving largest economy of colored cells. So we color (*m* − 1)*/*2 strips of size 1×*n*. We prove that we cannot get by with less colorings. It is sufficient to reduce the problem to a smaller rectangle. Cut off a big L leaving an (*n* − 2)(*m* − 2) rectangle. The big L can be cut into (*m* + *n* − 6)*/*2 squares of size 2 × 2 and one 3 × 3 square with one missing corner cell, i.e., a small L. We must color at least *m* + *n* − 6 cells in the squares and at least three cells in the small L.
By induction, we get the answer *n*(*m* − 1)*/*2.

38. Suppose *m* and *n* are two white numbers. We will prove that *mn* is white. Suppose *k* is some black number. Then *m* + *k* is black, that is, *mn* + *kn* = (*m* + *k*)*n* is white, and *kn* is white. If *mn* is black, then *mn* + *kn* is black. This contradiction proves that *mn* is white.

2. Coloring Proofs 37

Suppose *k* is the **smallest** white number. From the preceding result, we conclude that all multiples of *k* are also white. We prove that there are no other white numbers. then *r* is black since *k* is the smallest white number. But we have proved that *qk* is Suppose *n* is white. Represent *n* in the form *qk* + *r*, where 0 ≤ *r \< k*. If *r*
̸= 0, white. Hence, *qk* + *r* is black. This contradiction proves that the white numbers are all multiples of some *k \>* 1.

3

The Extremal Principle

A successful research mathematician has mastered a dozen general heuristic principles of large scope and simplicity, which he/she applies over and over again. These principles are not tied to any subject but are applicable in all branches of mathematics. He usually does not reﬂect about them but knows them subconsciously. One of these principles, *the invariance principle* was discussed in Chapter I. It is applicable whenever a transformation is given or can be introduced.
**If you have a transformation, look for an invariant!** In this chapter we discuss the **extremal principle**, which has truly universal applicability, but is not so easy to recognize, and therefore must be trained. It is also called *the variational method*, and soon we will see why. It often leads to extremely short proofs.

We are trying to prove the existence of an object with certain properties. The *extremal principle* tells us to pick an object which *maximizes* or *minimizes* some function.The*resultingobject*isthenshowntohavethedesiredpropertybyshowing that a slight perturbation (variation) would further increase or decrease the given function. If there are several optimizing objects, then it is usually immaterial which one we use. In addition, the *extremal principle* is mostly constructive, giving an algorithm for constructing the object.

We will learn the use of the *extremal principle* by solving 17 examples from geometry, graph theory, combinatorics, and number theory, but first we will remind the reader of three well known facts:

\(a\) Every *finite* nonempty set *A* of nonnegative integers or real numbers has a minimal element min *A* and a maximal element max *A*, which need not be unique.

3. The Extremal Principle 41

**E2. Continuation of 1b.** *Let n* ≥ 5*. Show that, among the sn space parts, there are at least* (2*n* − 3)*/*4 *tetrahedra* (HMO 1973).

Telling the result simplifies the problem considerably. An experienced problemsolver can often infer the road to the solution from the result.

Let *tn* be the number of tetrahedra among the *sn* space parts. We want to show that *tn* ≥ (2*n* − 3)*/*4.

*Interpretation of the numerator:* On each of the *n* planes rest at least two tetrahedra. Only one tetrahedron need rest on each of three exceptional planes.

*Interpretation of the denominator:* Each tetrahedron is counted four times, once for each face. Hence, we must divide by four.

Using these guiding principles we can easily find a proof. Let *ϵ* be any of the *n* planes. It decomposes space into two half-spaces *H*1 and *H*2. At least one halfspace, e.g., *H*1 , contains vertices. In *H*1, we choose a vertex *D* with smallest distance from *ϵ* (extremal principle). D is the intersection point of the planes *ϵ*1*, ϵ*2*, ϵ*3.
Then *ϵ, ϵ*1*, ϵ*2*, ϵ*3 define a tetrahedron *T* = *ABCD* (Fig. 3.2).
None of planes. If the plane *ϵ*′would cut the tetrahedron *T* , then *ϵ*′would have to cut at the remaining *n* − 4 planes cuts *T* , so that *T* is one of the parts, defined by the *n* least one of the edges *AD, BD, CD* in a point *Q* having an even smaller distance from *ϵ* than *D*. Contradiction.

This is valid for any of the *n* planes. If there are vertices on both sides of a plane, at least two tetrahedra then must rest on this plane.

It remains to be shown that among the *n* planes there are at most three, so that all vertices lie on the same side of these planes.

We show this by *contradiction*. Suppose there are four such planes *ϵ*1, *ϵ*2, *ϵ*3, *ϵ*4. They delimit a tetrahedron *ABCD* (Fig. 3.3).
Since *n* ≥ 5, there is another plane *ϵ*. It cannot intersect all six edges of the tetrahedron *ABCD* simultaneously. Suppose it cuts the continuation of *AB* in *E*. Then *B* and *E* lie on different sides of the plane *ϵ*3 = *ACD*. *Contradiction!*

**E3.** *There are n points given in the plane. Any three of the points form a triangle of area* ≤ 1*. Show that all n points lie in a triangle of area* ≤ 4*.*

△*ABC* has maximal area *F*. Obviously *F* ≤ 1. Draw parallels to the opposite =*n* =\ triples of points, we choose a triple *A, B, C* so that**Solution.** Among all 3\ sides through *A, B, C*. You get △*A*1*B*1*C*1 with area *F*1 = 4*F* ≤
4. We will show that △*A*1*B*1*C*1 contains all *n* points.

sides of at least one of the lines *A*1*B*1*, B*1*C*1*, C*1*A*1.
Suppose they lie on different Suppose there is a point *P* outside
△*A*1*B*1*C*1. Then △*ABC* and *P* lie on different sides of *B*1*C*1.
Then △*BCP* has a larger area than △*ABC*. This contradicts the maximality assumption about *ABC* (Fig. 3.4).

**E4.** 2*n points are given in the plane, no three collinear. Exactly n of these points are farms F* = {*F*1*, F*2*, ··· , Fn*}*. The remaining n points are wells: W* = {*W*1*, W*2*, ··· , Wn*}*. It is intended to build a straight line road from each*

42 3. The Extremal Principle

*farm to one well. Show that the wells can be assigned bijectively to the farms, so that none of the roads intersect.*

+---------+---------+---------+---------+---------+---------+---------+
| > *C*1\ |         |         |         |         |         |         |
| >       |         |         |         |         |         |         |
| **=@**\ |         |         |         |         |         |         |
| > **=** |         |         |         |         |         |         |
| > **@** |         |         |         |         |         |         |
+=========+=========+=========+=========+=========+=========+=========+
|         |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
|         |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
|         |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
|         |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+

3. The Extremal Principle 43

\|*AB*\|) *\>* 0 then, either \|*AC*\| + \|*AD*\| − \|*AB*\| *\>* 0, or
\|*BC*\| + \|*BD*\| − \|*BA*\| *\>* 0. In each case, we can construct a triangle from the edges at some vertex.

**E8.** *Each lattice point of the plane is labeled by a positive integer. Each of these numbers is the arithmetic mean of its four neighbors (above, below, left, right). Show that all the labels are equal.*

**Solution.** We consider a smallest label *m*. Let *L* be a lattice point labeled by *m*. Its neighbors are labeled by *a, b, c, d*. Then *m* = (*a* + *b* + *c* + *d*)*/*4, or

*a* + *b* + *c* + *d* = 4*m.* (1)

Now *a* ≥ *m, b* ≥ *m, c* ≥ *m, d* ≥ *m*. If any of these inequalities would be strict, we would have *a* +*b* +*c* +*d \>* 4*m* which contradicts (1). Thus *a* = *b* = *c* = *d* = *m.* It follows from this that all labels are equal to *m.*

This is a very simple problem. By replacing positive integers by positive reals, it becomes a very difficult problem. The trouble is that positive reals need not have a smallest element. For positive integers, this is assured by the *well ordering principle*. The theorem is still valid, but I do not know an elementary solution.

**E9.** *There is no quadruple of positive integers* (*x, y, z, u*) *satisfying*

*x*2+ *y*2= 3(*z*2+ *u*2)*.*

**Solution.** Suppose there is such a quadruple. We choose the solution with the smallest *x*2+ *y*2*.* Let (*a, b, c, d*) be the chosen solution. Then

*a*2+ *b*2= 3(*c*2+ *d*2) ⇒ 3\|*a*2+ *b*2⇒ 3\|*a,* 3\|*b* ⇒ *a* = 3*a*1*, b* = 3*b*1*,*

*a*2+ *b*2= 9(*a*2 1+ *b*2 1) = 3(*c*2 + *d*2) ⇒ *c*2 + *d*2 = 3(*a*2 1+ *b*2 1)*.*

We have found a new solution (*c, d, a*1*, b*1) with *c*2+*d*2*\<
a*2+*b*2*. Contradiction.* return to similar examples when treating *infinite descent.*We have used the fact that 3\|*a*2+ *b*2⇒ 3\|*a,* 3\|*b.* Show this yourself. We will

**E10.** The Sylvester Problem, posed by Sylvester in 1893, was solved by T. Gallai 1933 in a very complicated way and by L.M. Kelly in 1948 in a few lines with the extremal principle.

*A finite set S of points in the plane has the property that any line through two of them passes through a third. Show that all the points lie on a line.*

**Solution.** Suppose the points are not collinear. Among pairs (*p, L*) consisting of a line *L* and a point not on that line, choose one which minimizes the distance *d* from *p* to *L.* Let *f* be the foot of the perpendicular from *p* to *L.* There are (by assumption) at least three points *a, b, c* on *L*. Hence two of these, say, *a* and *b* are on the same side of *f* (Fig. 3.8). Let *b* be nearer to *f* than *a*. Then the distance from *b* to the line *ap* is less than *d.
Contradiction.*

44 3. The Extremal Principle

*p***t** **\'** **H H** *M*

3. The Extremal Principle 45

*x*1-direction and *t*2 rows in the *x*2-direction. We may further assume that *t*1 ≥*t*2*.* Obviously *t* ≥ *t*1 and *t* ≥ *t*2. In the layer *L*, these rooks fail to dominate (*n* − *t*1)(*n* − *t*2) cubes, which must be dominated in the *x*3-direction. We consider all *n* layers parallel to the *x*1*x*3-plane. In *n*−*t*1 of these not containing a rook from *L*, there must be at least (*n* − *t*1)(*n* − *t*2) rooks. In each of the remaining *t*1 layers are at least *t* rooks (by the choice of *t*). Hence, we have

*R* ≥ (*n* − *t*1)(*n* − *t*2) + *tt*1 ≥ (*n* − *t*1)2+ *t*2 1= *n*22+ (2*t*1 ~~−~~ *n*)2*.*2

The right side assumes its minimum *n*2*/*2 for even *n* and (*n*2+ 1)*/*2 for odd *n.* It is easy to see that this necessary number is also sufficient. Fig. 3.11 gives a hint for a proof (MMO 1965, AUO 1971, IMO 1971).

other higher dimensional boards does not seem to be known. Here good bounds *Remark.* The exact number of rooks which dominate an *n* × *n* ×
*n* × *n* board and would be welcome.

+---------+---------+---------+---------+---------+---------+---------+
|         |         |         | > 7 6 5 | > 4 7 6 | > 5 4 7 | > 6\    |
|         |         |         | > 4     | > 5     | > 6     | > 5\    |
|         |         |         |         |         |         | > 4\    |
|         |         |         |         |         |         | > 7     |
+=========+=========+=========+=========+=========+=========+=========+
|         |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
|         |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| > 3 2 1 |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
|         | > 1 3 2 | > 2\    |         |         |         |         |
|         |         | > 1\    |         |         |         |         |
|         |         | > 3     |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
|         |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
|         |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+

+--------+--------+--------+--------+--------+--------+--------+--------+
|        |        |        |        | > 8 7  | > 5 8  | > 6 5  | > 7\   |
|        |        |        |        | > 6 5  | > 7 6  | > 8 7  | > 6\   |
|        |        |        |        |        |        |        | > 5\   |
|        |        |        |        |        |        |        | > 8    |
+========+========+========+========+========+========+========+========+
|        |        |        |        |        |        |        |        |
+--------+--------+--------+--------+--------+--------+--------+--------+
|        |        |        |        |        |        |        |        |
+--------+--------+--------+--------+--------+--------+--------+--------+
| > 4 3  |        |        |        |        | > 1 4  | > 2 1  | > 3\   |
| > 2 1  |        |        |        |        | > 3 2  | > 4 3  | > 2\   |
|        |        |        |        |        |        |        | > 1\   |
|        |        |        |        |        |        |        | > 4    |
+--------+--------+--------+--------+--------+--------+--------+--------+
|        |        |        |        |        |        |        |        |
+--------+--------+--------+--------+--------+--------+--------+--------+
|        |        |        |        |        |        |        |        |
+--------+--------+--------+--------+--------+--------+--------+--------+
|        |        |        |        |        |        |        |        |
+--------+--------+--------+--------+--------+--------+--------+--------+
|        |        |        |        |        |        |        |        |
+--------+--------+--------+--------+--------+--------+--------+--------+

Fig. 3.11

**E13.** *Seven dwarfs are sitting around a circular table. There is a cup in front of each. There is milk in some cups, altogether* 3 *liters.
One of the dwarfs shares his milk uniformly with the other cups.
Proceeding counter-clockwise, each of the other dwarfs, in turn, does the same. After the seventh dwarf has shared his milk, the initial content of each cup is restored. Find the initial amount of milk in each cup (AUO 1977, grade 8).*

**Solution.** Every 8th grader, 53 altogether, guessed the correct answer 6*/*7, 5*/*7, 4*/*7, 3*/*7, 2*/*7, 1*/*7, 0 liters. The answer is easy to guess because of an invariance property. Each sharing operation merely rotates the answer. But only 9 students could prove that the answer is unique. The solutions were quite ingenious and required just a few lines. We prefer, instead, a solution based on a general principle, in this case, the *extremal principle.*

Suppose the dwarf *#i* has the (maximal) amount *xi* before starting to share his milk. The dwarf Max has the maximum amount *x* to share. The others to the right of him have *x*1, *x*2, *···*, *x*6 to share. Max gets *xi/*6 from dwarf \#*i*. Thus, we have

*x* =*x*1 ~~+~~ *x*2 ~~+~~ *x*3 ~~+~~ *x*4 ~~+~~ *x*5 ~~+~~ *x*6*,* (1) 6

46 3. The Extremal Principle

where *xi* ≤ *x* for *i* = 1*, ··· ,* 6*.* If the inequality would be strict only once, we could not have equality in (1). Thus *x*1 = *x*2 = *x*3 = *x*4 = *x*5 = *x*6 = *x*, that is, each dwarf shares the same amount of milk. We easily infer from this that, initially, the milk distribution is 0, *x/*6, 2*x/*6, 3*x/*6,4*x/*6, 5*x/*6, 6*x/*6.
From the sum 3 liters, we get *x* = 6*/*7.

**E14**. *The Sikinian Parliament consists of one house. Every member has three enemies at most among the remaining members. Show that one can split the house into two houses so that every member has one enemy at most in his house.*

**Solution**. We consider all partitions of the Parliament into two houses and, for each partition, we count the total number *E* of enemies each member has in his house. The partition with minimal *E* has the required property. Indeed, if some member would have *at least two enemies* in his house, then he would have *one enemy at most* in the other house. By placing him in the other house, we could decrease the minimal *E*, which is a contradiction.

We have solved this problem already in Chapter 1 by a variation of the invariance principle which we call the **Principle of the Finiteness of a Decreasing Sequence of Nonnegative Integers**. So the Extremal Principle is related to the Invariance Principle.

**E15.** *Can you choose* 1983 *pairwise distinct positive integers
\<* 100000*, such that no three are in arithmetic progression* (IMO 1983)?

All hints to the solution are eliminated in this problem. So we must recover them. We need some strategic idea to get the first clues. Let us construct a tight sequence with no three terms in arithmetic progression. Here, the extremal principle helps in finding an algorithm. We use the so-called *greedy algorithm*: Start with the smallest nonnegative integer 0. At each step, add the smallest integer which is not in arithmetic progression with two preceding terms. We get

• 0*,* 1 (translate this by 3),

• 0*,* 1*,* 3*,* 4 (translate this by 9),

• 0*,* 1*,* 3*,* 4*,* 9*,* 10*,* 12*,* 13 (translate this by 27), and

• 0*,* 1*,* 3*,* 4*,* 9*,* 10*,* 12*,* 13*,* 27*,* 28*,* 30*,* 31*,* 36*,* 37*,* 39*,* 40 (translate this by 81).

We get a sequence with many regularities. The powers of 3 are a hint to use the ternary system. So we rewrite the sequence in the ternary system, getting

0*,* 1*,* 10*,* 11*,* 100*,* 101*,* 110*,* 111*,* 1000*, ··· .*

This is a hint to the binary system. We conjecture that the constructed sequence consists of those ternary numbers, which miss the digit 2, i.e., they are written in the binary system. Our next conjecture is that if we read the terms of the sequence

3. The Extremal Principle 51

position with position *M* = 2*k*− 1*.* No matter how my opponent splits the piles, he must leave a 2*k*−1− 1 *\< M \<* 2*k*− 1*.*

On my next move, I can occupy the position *M* = 2*k*−1−1. If I continue in this way, I will finally move to *M* = 21− 1 = 1, and my opponent has lost since he cannot move. So the first player wins if, initially, *M* does not have the form 2*k*− 1.

5. Suppose *AB* is the longest edge of a face *ABC*. Then the angle at *C* is at least as large as those at *A* and *B*. Hence the angles at *A* and *B* are acute.

6. Let *F* be the face with the largest number *m* of edges. Then, for the *m* + 1 faces consisting of *F* and its *m* neighbors, there are only the possibilities 3, 4, *···* , *m* as the number of edges.
These are only *m* − 2 possibilities. Thus, at least one number of edges must occur more than once.

7. (a) All mutual distances are different. Hence there exist two persons *A* and *B* with minimum distance. These two persons will shoot each other. If any other person shoots at *A* or *B*, someone will survive since *A* and *B* have used up three bullets. If not, we can ignore *A* and *B*. We are left with the same problem with *n* replaced by *n* − 1. Repeating the argument, we either find a pair at whom three shots are fired, or if not, we arrive, finally, at three persons, and for this case (*n* = 1), the theorem is obvious.

+--------+--------+--------+--------+--------+--------+--------+--------+
| > *A*  |        |        |        |        |        |        |        |
+========+========+========+========+========+========+========+========+
|        |        |        |        |        |        |        |        |
+--------+--------+--------+--------+--------+--------+--------+--------+
|        |        |        |        |        |        |        |        |
+--------+--------+--------+--------+--------+--------+--------+--------+
|        |        |        |        |        |        |        |        |
+--------+--------+--------+--------+--------+--------+--------+--------+
|        |        |        |        |        |        |        |        |
+--------+--------+--------+--------+--------+--------+--------+--------+
|        |        |        |        |        |        |        |        |
+--------+--------+--------+--------+--------+--------+--------+--------+

4

The Box Principle

The simplest version of Dirichlet's box principle reads as follows:

*pearl.If* (*n* + 1) *pearls are put into n boxes, then at least one box has more than one*

This simple combinatorial principle was first used explicitly by Dirichlet (1805--1859) in number theory. In spite of its simplicity it has a huge number of quite unexpected applications. It can be used to prove deep theorems. F.P. Ramsey made vast generalizations of this principle. The topic of *Ramsey Numbers* belongs to the deepest problems of combinatorics. In spite of huge efforts, progress in this area is very slow.

It is easy to recognize if the box principle is to be used. Every existence problem about finite and, sometimes, infinite sets is usually solved by the box principle. The principle is a pure existence assertion. It gives no help in finding a multiply occupied box. The main difficulty is the identification of the *pearls* and the *boxes*.

For a warmup, we begin with a dozen simple problems without solutions:

1. Among three persons, there are two of the same sex.

2. Among 13 persons, there are two born in the same month.

3. Nobody has more than 300,000 hairs on his head. The capital of Sikinia has 300,001 inhabitants. Can you assert with certainty that there are two persons with the same number of hairs on their heads?

4. How many persons do you need to be sure that 2 (3, *q*) persons have the same birthday?

60 4. The Box Principle

5. If *qs* + 1 pearls are put into *s* boxes, then at least one box has more than *q* pearls.

6. A line *l* in the plane of the triangle *ABC* passes through no vertex. Prove that it cannot cut all sides of the triangle.

7. A plane does not pass through a vertex of a tetrahedron. How many edges can it intersect?

8. A target has the form of an equilateral triangle with side 2.

\(a\) If it is hit 5 times, then there will be two holes with distance ≤
1.

\(b\) It is hit 17 times. What is the minimal distance of two holes at most?

9. The decimal representation of *a/b* with coprime *a, b* has at most period (*b* − 1).

10. From 11 infinite decimals, we can select two numbers *a*, *b* so that their decimal representations have the same digits at infinitely many corresponding places.

11. Of 12 distinct two-digit numbers, we can select two with a two-digit differ ence of the form *aa*.

12. If none of the numbers *a, a* + *d, ··· , a* + (*n* − 1)*d* is divisible by *n*, then *d* and *n* are coprime.

The next eleven examples show typical applications of the box principle.

**E1.** *There are n persons present in a room. Prove that among them there are two persons who have the same number of acquaintances in the room.*

**Solution.** A person (pearl) goes into box #i if she has *i* acquaintances. We have *n* persons and *n* boxes numbered 0*,* 1*, . .
. , n* − 1. But the boxes with the numbers 0 and *n* − 1 cannot both be occupied. Thus, there is at least one box with more then one pearl.

**E2.** *A chessmaster has 77 days to prepare for a tournament. He wants to play at least one game per day, but not more then 132 games.
Prove that there is a sequence of successive days on which he plays exactly 21 games.*

**Solution.** Let *ai* be the number of games played until the *i*th day inclusive. Then

1 ≤ *a*1 *\< ··· \< a*77 ≤ 132 ⇒ 22 ≤ *a*1 + 21 *\< a*2 + 21 *\< ···
\< a*77 + 21 ≤ 153*.*

Among the 154 numbers *a*1*, ··· , a*77*, a*1 + 21*, ··· , a*77 + 21 there are two equal numbers. Hence there are indices *i, j*, so that *ai* = *aj* + 21*.* The chessmaster has played exactly 21 games on the days \#*j* + 1*, j* + 2*, ··· , i.*

**E3.** *Let a*1*, a*2*, ··· , an be n not necessarily distinct integers. Then there always exists a subset of these numbers with sum divisible by n.*

4. The Box Principle 61

**Solution.** We consider the *n* integers

*s*1 = *a*1*,* *s*2 = *a*1 + *a*2*,* *s*3 = *a*1 + *a*2 + *a*3*, ···
,* *sn* = *a*1 + *a*2 + ... + *an.*

If any of these integers is divisible by *n*, then we are done.
Otherwise, all their remainders are different modulo *n*. Since there are only *n*−1 such remainders, two of the sums, say *sp* and *sq* with *p \< q*, are equal modulo *n*, that is, the following difference is divisible by *n*.

*sq* − *sp* = *ap*+1 + *···* + *aq.*

This proof contains an important motive with many applications in number theory, group theory, and other areas.

**E4.** *One of* (*n* + 1) *numbers from* {1*,* 2*, ··· ,* 2*n*} *is divisible by another.*

**Solution.** We select (*n* + 1) numbers *a*1*, ··· , an*+1 and write them in the form *ai* = 2*kbi* with *bi* odd. Then we have (*n* + 1) odd numbers *b*1*, ··· , bn*+1 from the interval \[1*,* 2*n* − 1\]. But there are only *n* odd numbers in this interval. Thus two of the other.them *p, q* are such that *bp* = *bq*. Then one of the numbers *ap, aq* is divisible by

**E5.** *Let a, b* ∈ N *be coprime. Then ax* − *by* = 1 *for some x, y* ∈ N.

**Solution.** Consider the remainders mod b of the sequence *a, ··· ,* (*b* − 1)*a*. The remainder 0 does not occur. If the remainder 1 would not occur either, then we would have positive integers *p, q*, 0 *\< p
\< q \< b,* so that *pa* ≡ *qa* (mod *b*)*.* But *a* and *b* are coprime. Hence we have *b*\|*q* − *p*. This is a contradiction since 0 *\< q* −*p \< b.* Thus there exists an *x* so that *ax* ≡ 1 (mod *b*), that is, ax=1+by, or *ax* − *by* = 1*.*

**E6. Erd˝os and Szekeres.** *The positive integers 1 to 101 are written down in any order. Prove that you can strike 90 of these numbers, so that a monotonically increasing or decreasing sequence remains.*

of *n* integers contains either a monotonically increasing subsequence of length *p* **Solution.** We prove a generalization: For *n* ≥ (*p* − 1)(*q* − 1) + 1 every sequence or a monotonically decreasing subsequence of length *q.*

We assign the maximal length *Lm* of a monotonically increasing sequence with last element *m* and the maximal length *Rm* of a monotonically decreasing sequence beginning with *m* to any number *m* in the sequence.

This assignment has the property that, for two different numbers *m* and *k* there must be *Lm* ̸= *Lk* or *Rm* ̸= *Rk*. This follows easily from the fact that either *m \> k* or *m \< k.* All pairs (*Lm, Rm*) with *m* = 1*,* 2*, ··· , n* are distinct. Assuming that no such subsequences exist, *Lm* can assume only the values 1*,* 2*, . .
. , p* − 1 and *Rm* only the values 1*,* 2*, ··· , q* − 1*.* This gives (*p* − 1)(*q* − 1) different boxes for the pairs. But *n* ≥ (*p* − 1)(*q* − 1) + 1 and the box principle leads to a contradiction.

**E7.** *Five lattice points are chosen in the plane lattice. Prove that you can always choose two of these points such that the segment joining these points passes through*

4. The Box Principle 63

only (10*n*− 1) possible remainders

1*,* 2*,* 3*, ··· ,* 10*n*− 1*.*

Hence, two of the terms *ai*, *ak*(*i \< k*) will have the same remainder, and so their difference will be divisible by 10*n*:

10*n*\|*ak*− *ai*⇐⇒ 10*n*\|*ai*(*ak*−*i*− 1)*.*

Since gcd(10*n, ai*) = 1, we have 10*n*\|*ak*−*i*− 1 or *ak*−*i*− 1 = *q* ∗ 10*n*, or *ak*−*i*=*q* ∗ 10*n*+ 1. Thus, *ak*−*i*ends in 000 *.
. .* 01 (*n* digits).

**E11.** *Inside a room of area 5, you place 9 rugs, each of area 1 and an arbitrary shape. Prove that there are two rugs which overlap by at least* 1*/*9*.*

Suppose every pair of rugs overlaps by less than 1*/*9. Place the rugs one by one on the ﬂoor. We note how much of the yet uncovered area each suceeding rug will cover. The first rug will cover area 1 or 9*/*9. The 2nd, 3rd, *···*, 9th rug will cover area greater than 8*/*9*, ··· ,* 1*/*9. Since 9*/*9 + *···* + 1*/*9 = 5, all nine rugs cover area greater than five. Contradiction!

Ramsey Numbers, Sum-Free Sets, and a Theorem of I. Schur

We consider four related competition problems:

**E12**. *Among six persons, there are always three who know each other or three who are complete strangers.*

This problem was proposed in 1947 in the K¨urschak Competition and in 1953 in the Putnam Competition. Later, it was generalized by R.E.
Greenwood and A.M. Gleason.

**E13.** *Each of* 17 *scientists corresponds with all the others. They correspond about only three topics and any two treat exactly one topic.
Prove that there are at least three scientists, who correspond with each other about the same subject.*

**E14.** *In space, there are given pn* = ⌊*en*!⌋ + 1 *points. Each pair of points is connected by a line, and each line is colored with one of n colors. Prove that there is at least one triangle with sides of the same color.*

**E15.** *An international society has members from six different countries. The list of members contains* 1978 *names, numbered* 1*,* 2*, ··· ,* 1978*. Prove that there is at least one member whose number is the sum of the numbers of two members from his own country or twice as large as the number of one member from his own country* (IMO 1978).

One represents the persons by points. In the first problem, each pair of points isThe first two problems are special cases of the third with *n* = 2 and *n* = 3.

64 4. The Box Principle

joined by a red or blue segment depending on the corresponding persons being acquaintances or strangers. In the second problem each pair of points is joined by a red, blue, or green segment if the corresponding scientists exchange letters about the first, second, or third topic, respectively. The relationship of the fourth problem to the third will be recognized later.

Before solving the problems, we introduce some notation. We select *p* points in space with no four lying in the same plane, and we join each pair of points by =*p* ==*p* =edges, and 3 triangles. We color each edge with one of *n* colors and call this an *n*-coloring of the *Gp*. If *Gp* contains a triangle with all sides of the same color then we call it *monochromatic*. We also say that *Gp* contains a monochromatic a segment (or curve). We get a so-called complete graph *Gp* with *p vertices*, 2*G*3. Now, we solve **E12, E13,** and **E14.**

**Solution of E12.** The edges of a *G*6 are colored red or blue. Take any of the six points and call it *P* . At least 3 of the 5 lines which start at *P* are of the same color, say *red*. These red lines end at 3 points *A*, *B*, *C* (Fig. 4.1 ). If any side of the triangle *ABC* is red, we have a red triangle. If not, *ABC* is a blue triangle. In both cases, we have a *monochromatic triangle.* Fig. 4.2 shows that with 5 points and 2 colors there need not exist a monochromatic triangle. Here sides and diagonals have different colors.

+-----------------------+-----------------------+-----------------------+
| > *P*                 |                       |                       |
+=======================+=======================+=======================+ +-----------------------+-----------------------+-----------------------+

66 4. The Box Principle

In addition, we know that *R*(3*,* 4) = 9, *R*(4*,* 4) = 18, *R*(3*,* 6) = 18, *R*(3*,* 5) = 14, *R*(3*,* 7) = 23, and *R*(4*,* 5) = 25*.* The last number was found in 1993. It required as much as a total of 11 years of processor time on as many as 110 desktop computers. This may be the limit of computer power.

Each Ramsey Number leads to an interesting and tough problem. For example, *R*(3*,* 4) = 9 says that any 2-coloring of a *G*9 forces a red triangle (*G*3) or a blue tetrahedron (*G*4)*.* We make of this problem 39.

We will now solve **E15.** Afterwards, we will illustrate its mathematical background. In this problem we are asked to show that the set {1*,* 2*, ··· ,* 1978} cannot be partitioned into six sum-free subsets. We can replace 1978 by the smaller number 1957.

*Assumption:* There is a partitioning of {1*, ··· ,* 1957} into six sum-free subsets *A, B, C, D, E, F.*

327 elements *Conclusion:* One of these subsets, say *A*, has at least 1957*/*6 = 326 1*/*6, i.e. *a*1 *\< a*2 *\< ··· \< a*327*.*

The 326 *differences a*327 − *ai*, *i* = 1*, ··· ,* 326 do not lie in *A*, since *A* is sum-free. Indeed, from *a*327 − *ai* = *aj* follows *ai* + *aj* = *a*327*.* So they must lie in *B* to *F*. One of these subsets, say *B*, has at least 326*/*5 = 65 1*/*5, that is 66 of these differences\ *b*1 *\< b*2 *\< ··· \< b*66*.*

The 65 *differences b*66 − *bi, i* = 1*, ··· ,* 65 lie neither in *A* nor in *B* since both sets are sum-free. Hence they lie in *C* to *F.* One of these subsets, say *C*, has at least 65*/*4 = 16 + 1*/*4, i.e., 17 of these differences\ *c*1 *\< c*2 *\< ··· \< c*17*.*

The 16 *differences c*17 − *ci, i* = 1*, ··· ,* 16 do not lie in *A* to *C*, that is, in *D* to *F*. One of these subsets, say *D*, has at least 16*/*3 = 5 1*/*3 that is, 6 of these differences *d*1 *\< d*2 *\< ··· \< d*6*.* The 5 *differences d*6 − *di* do not lie in *A* to *D*, that is, in *E* or *F.* One of these, say *E*, has at least 2*.*5, that is, 3 elements *e*1 *\< e*2 *\< e*3*.* The two *differences f*1 = *e*3 − *e*2*, f*2 = *e*3 − *e*1 do not lie in *A* to *E*. Hence they lie in *F*. The *difference g* = *f*2 − *f*1 does not lie in *A* to *F. Contradiction!*

There is a close connection between **E15** and **E14** for *n* = 6. A subset *A* of the positive integers or an abelian group is called *sum-free*, if the equation *x* + *y* = *z* for *x, y, z* ∈ *A* is not solvable. Of course, we may also have *x* = *y.* In connection with the Fermat Conjecture, in 1916 Isai Schur considered the following problem:
What is the largest positive integer *f* (*n*) so that the set {1*,* 2*, ··· , f* (*n*)} can be split into *n* sum-free subsets?

We know only 4 values of the Schur function *f* (*n*)*.* By trial, one finds *f* (1) =1*, f* (2) = 4*, f* (3) = 13*.* In 1961 Baumert found *f* (4) = 44 with the help of a computer. A sum-free partition of {1*, ···
,* 44} is

*S*1 = {1*,* 3*,* 5*,* 15*,* 17*,* 19*,* 26*,* 28*,* 40*,* 42*,* 44}*,*

70 4. The Box Principle

42. Erd˝os proved two estimates for *R*(*r, s*), which we formulate as the next two problems.

Prove that\ *R*(*r, s*) ≤ *R*(*r* − 1*, s*) + *R*(*r, s* − 1)*.* (1)43. With the help of (1), prove that

*R*(*r, s*) ≤=*r* + *s* − 2

=*.*

44. Split the set {1*,* 2*, ··· ,* 13} into three sum-free subsets.
Prove that {1*, ··· ,* 14} cannot be split into three sum-free subsets.

45. Prove that the set {1*,* 2*, ··· ,* (3*n*− 1)*/*2) can be split into *n* sum-free subsets.

46. The set {1*, ··· ,* 9} is split in any way into two subsets.
Prove that in at least one subset, there are three numbers of which one is the arithmetic mean of the other two.

47. The sides of a regular triangle are bicolored. Do there exist on its perimeter three monochromatic vertices of a rectangular triangle?
(IMO 1983).

48. From the set {1*,* 2*, ··· ,* 2*n*+1}, select a sum-free subset *A* with a maximum number of elements. How many elements does *A* have?

49. If the points of the plane are colored red or blue, then there will be a red pair with distance 1, or there are 4 collinear blue points with distance 1.

50. If a *G*14 is colored with two colors, there will be a unicolored quadrangle.

51. A three colored *G*80 contains a monochromatic quadrilateral.

The next problems are rather tough. They treat a theorem of Jacobi and its applications. Solutions for 50 to 57 and 59 are missing.

52. Fig. 4.3 shows a circle of length 1. A man with irrational step length *α* (measured along the circumference) walks around the circle.
The circle has a ditch of width *ϵ \>* 0. Prove that, sooner or later, he will step into the ditch no matter how small *ϵ* will be.

53. Prove that there is a power of two, which begins with 6 nines, that is, there are positive integers *n, k* such that

999999 × 10*k\<* 2*n\<* 10*k*+6*,*

*k* + log 999999 *\< n* log 2 *\< k* + 6*.*

show that, for irrational log *a*, there is a power of *a* which begins with any prescribed *Hint.* Here *ϵ* = 6 − log 999999 and the step length is *α* = log 2. Similarly, one can digit sequence.

54. Let *an* be the number of terms in the sequence 21*,* 22*, ···
,* 2*n,* which begin with digit 1. Prove that\ log 2 −1*n \< ann \<* log 2\ and, hence,\ *an*\ *p*1 = lim *n*→∞*n*= log 2 ≈ 0*.*30103*.*

One sometimes says that a *randomly chosen* power of two begins with 1 with probability log 2 ≈ 0*.*30103.

74 4. The Box Principle

20. We use the same motive. Consider the sums

*a*1*, a*1 + *a*2*, a*1 + *a*2 + *a*3*, ··· , a*1 + *a*2 + ... + *an.*

If any of the *n* sums is divisible by *n*, then we are done.
Otherwise, two of the sums *a*1 +*···*+*ai* and *a*1 +...+*aj* have the same remainder upon division by *n*. Suppose *j \> i*. Then the difference *ai*+1 + ... + *aj* is divisible by *n*.

21. In the proof, we change 25 and 13 to 2*n* + 1 and *n* + 1, respectively.

Let *A* and *B* be two points of *S* with maximum distance. If
\|*AB*\| ≤ 1, a disk with center at *A* and radius 1 covers all 2*n* + 1 points, and we are finished. Now suppose that \|*AB*\| *\>* 1. Let *X* be any point in *S*\\{*A, B*}. In the 3-subset {*A, B, X*} there are point of *S* lies in one of the disks of radius 1 about *A* and *B*. One of these disks must two points with distance less than 1. So either \|*AX*\| *\<* 1 or \|*BX*\| *\<* 1. Hence any contain at least *n* + 1 of the 2*n* + 1 points.

22. If the main diagonals (which do not cut off a triangle) pass through one point, then everything is clear. The main diagonals partition the hexagon into six triangles of which at least one has area not surpassing one-sixth of the hexagon. Suppose it isof *BCO*.
But suppose the main diagonals form a triangle *P QR* in Fig. 4.5.
Then it △*OBC* in Fig. 4.4. Then one of the triangles *ABC* and *BCD* has area ≤ the area is even easier to find such a triangle. Prove this yourself.

23. This follows somehow from the preceding proof. In fact this problem was made up from the preceding one.

24. Among *n* + 1 integers from 1*, ··· ,* 2*n*, there are two successive integers. They are coprime.

25. A set *S* of 10 numbers with two digits, each one ≤ 99 has 210= 1024 subsets. The sum of the numbers in any subset of *S* is ≤ 10 · 99 = 990. So there are fewer possible sums than subsets. Thus there are at least two different subsets *S*1 and *S*2 having the same sum. If *S*1 ∩ *S*2 = ∅, then we are finished. If not, we remove all common elements and get two nonintersecting subsets with the same sum of their elements.

26. Use induction from *n* to 2*n*, which corresponds to induction from *k* to *k* + 1. (1) For *n* = 1, the statement is correct.

\(2\) Suppose that, from 2*n* − 1 integers, we can always select *n* with sum divisible by *n*. Of the 2(2*n*) − 1 positive integers, we can select *n* numbers three times, which are divisible by *n*. After the first selection, there will remain 3*n* − 1 numbers, after the second selection, 2*n* − 1 numbers. Let the sum of the first choice be *a* · *n*, the sum of the second choice be *b* · *n*, and the last choice be *c* · *n*. At least two of the numbers *a, b, c* have the same parity, e.g., *a* and *b*. Then *an* + *bn* = (*a* + *b*)*n* is divisible by 2*n*, since *a* + *b* is even.

*Remark*. The more general theorem that, from any 2*n* − 1 positive integers, one can always select *n* with sum divisible by *n* is more difficult to prove. Start by proving it for *n* = *p*, where *p* is a prime. Then prove it for *n* = *pq*, where *p, q* are primes.

27. Consider all subsets {*i*1*, ··· , ik*} of the set {1*, ··· , n*}. Let *S*(*i*1*, ··· , ik*) = *ai*1 +...+ *aik*. The number of such sums is 2*n*− 1. Since 2*n*− 1 *\> n*2for *n* ≥ 5, two of these sums will have the same remainder upon division by *n*2. Their difference will be divisible by *n*2. This difference has the form
±*as*1 ± *as*2 ± ... ± *ast* for some *t* ≥ 1 and some selection of indices *s*1*, ··· , st*.

78 4. The Box Principle

*R*(6*,* 3) *\< R*(5*,* 3) + *R*(6*,* 2) = 14 + 6 = 20 since 14 and 6 are both even. One can prove that *R*(6*,* 3) = 18. With our crude estimates, we missed the exact bound. Try to find a coloring which proves that *R*(6*,* 3) *\>* 17.

43. This follows from the equality *C*(*r, s*) = *C*(*r* − 1*, s*) + *C*(*r, s* − 1) for the binomial coefficients.

44. See the next problem.

45. We want to give a lower bound for the Schur function *f* (*n*), which is the smallest number so that the integers 1*,* 2*, ··· , f* (*n*) can be arranged in *n* sum-free rows. If the table with *n* rows\ *x*1*, x*2*, ··· ,* *··· ,* *u*1*, u*2*, ···*

has sum-free rows, then the *n* + 1 rows

3*x*1*,* 3*x*1 − 1*,* 3*x*2*,* 3*x*2 − 1*,* 3*x*3*,* 3*x*3 − 1*,* 3*x*4*,* 3*x*4 − 1*, ··· ,* 1*,* 4*,* 7*, ··· ,* 3*f* (*n*) + 1

+-----------------------------------+-----------------------------------+
| > give a similar table for the    | > 4\                              |
| > integer 3*f* (*n*) + 1. For *n* | > 3, we get                       |
| > = 2, from the table1 the new    |                                   |
| > table                           |                                   |
+===================================+===================================+ +-----------------------------------+-----------------------------------+

3*,* 2*,* 12*,* 11\ 6*,* 5*,* 9*,* 8\ 1*,* 4*,* 7*,* 10*,* 13*.*

In any case, we have *f* (*n* + 1) ≥ 3*f* (*n*) + 1, and since *f* (1) = 1, we have *f* (2) ≥ 4, *f* (3) ≥ 13, *f* (4) ≥ 40. Thus, we get

*f* (*n*) ≥ 1 + 3 + 32+ ... + 3*n*−1= (3*n*− 1)*/*2*.*

46. Try to draw a tree with vertices of two colors while avoiding an arithmetic progres sion. You will not get beyond depth 8.

47. Suppose there is no right triangle with vertices of the same color. Partition each side of the regular triangle by two points into three equal parts. These points are vertices of a regular hexagon. If two of its opposite vertices are of the same color, then all other vertices are of the other color, and hence there exists a right triangle with vertices of the other color. Hence opposite vertices of the hexagon are of different color. Thus there exist two neighboring vertices of different color. One pair of these bicolored vertices lies on a side of the triangle. The points of this side, differing from the vertices of the hexagon, cannot be of the first or second color.
Contradiction.

48. Let *M* = {1*,* 2*, ··· ,* 2*n* + 1}. The subset {1*,* 3*, . .
. ,* 2*n* + 1} consists of *n* + 1 odd numbers. It is sum-free, since the sum of two odd integers is even. Consider a maximal sum-free subset *T* = {*a*1*, ··· , ak*} with *a*1 *\<* ... *\< ak*.
Because 0 *\< a*2 − *a*1 *\< a*3 − *a*1 *\<* ... *\< ak* − *a*1 ≤
2*n* + 1 − *a*1 *\<* 2*n* + 1 the set *S* ={*a*2 − *a*1*, a*3 − *a*1*,
··· , ak* − *a*1} is a subset of *M* with *k* − 1 elements. *S* and *T* are disjoint. Indeed, if, for some (*i, j*) with *i* ∈ {2*, ···
, k*}*, j* ∈ {1*, ··· , k*}, we had *ai* − *a*1 = *aj*, then we would have *ai* = *aj* + *a*1. Contradiction, since T is sumfree. Thus we have (*k* − 1) + *k* = \|*S*\| + \|*T* \| = \|*S* ∪ *T* \| ≤
\|*M*\| = 2*n* + 1. From 2*k* − 1 ≤ 2*n* + 1, we have *k* ≤ *n* + 1.
Thus no sum-free subset of *M* has higher cardinality than the subset of odd integers above. There is another sum-free subset {*n* + 1*, n* + 2*, ··· ,* 2*n* + 1}. Try to prove that these are the only maximal sum-free subsets of *M*.

4. The Box Principle 83

79. Suppose all 4 distances of *P* to the vertices are ≥ 17. Join *P* to *A*, *B*, *C*, *D*. Then at least one of the 4 angles at *P* is ≥ 90◦. Suppose it is*AP B*. Then \|*AB*\|2≥\|*P A*\|2+ \|*P B*\|2. The left side of this inequality is less then 242= 576, and the right side ≥ 172+ 172= 578, or 576 *\>* 578. Contradiction!

80. Not always! Consider all the numbers mod 10. How many boards can we get starting with all zeros? We have (8 − 3 + 1)2+ (8 − 4 + 1)2= 61 subboards of dimensions 1064choices. Take one of these choices we cannot reach from the board of zeros. 3×3 and 4×4, i.e., we can reach at most 10618×8 boards. But there are altogether This one must be taken as the starting board.

81. Assume the contrary. Then, if there exists a path of *k* steps from one cell to the next, the sum of the differences of the numbers on these cells is at most 5*k*. But the difference between 1 and 81 is 80, and the number of steps between the cells on which these numbers are located is not more than 16. Since 5 · 16 = 80, we can attain these bounds just once. On every other path from 1 to 81, there will be pairs of neighbors differing at least by 6.

82. Let *ak* be the label of card \# k. None of the sums=*n k*=1*ak* is a multiple of *m* + 1, and they are all distinct mod *m* + 1.
Otherwise a difference of two of the sums, again a sum of *ak*, would be a multiple of *m* + 1. We have *a*2 = *s*2 − *s*1. If *a*2 would have the same remainder as sum *sq,* (3 ≤ *q* ≤ *m*), then *sq* − *a*2, a sum of *ak*, would be 0 mod *m* + 1. Since all the remainders 1*, ··· , m* occur among the remainders of the *sn*, we have either *a*2 ≡ *s*2 mod *m* + 1 or *a*2 ≡ *s*1 mod *m* + 1. Because of *ak*, we conclude that all the *ak* are equal.0 *\< a*1 *\< m* + 1, we can have only *a*2 = *s*1, i.e., *a*1 = *a*2. By cyclic rotation of the

83. Let *a*1*, ··· , a*70 be the given numbers. None of the 210 numbers *a*1*, ··· , a*70, *a*1 + 4*, ··· , a*70 + 4*, a*1 + 9*, ··· , a*70 + 9 exceeds 209. By the box principle two of them, say *ai* + *x* and *aj* + *y*, are equal (*x* ̸= *y*), where *x* and *y* can have the values 0, 4, or 9. Hence, the difference between *ai* and *aj* is 4, 5, or 9.

5

Enumerative Combinatorics

*What is a good Olympiad problem?* Its solution should not require any prerequisites except cleverness. A high school student should not be at a disadvantage compared to a professional mathematician. During its first participation in 1977 in Belgrade, our team was confronted by such a problem. But first we give a definition. Let *a*1*, a*2*, ··· , am* be a sequence of real numbers. The sum of *q* successive terms will be called a *q*-sum, for example, *ai* + *ai*+1 + ... + *ai*+*q*−1.

**E1.** *In a finite sequence of real numbers, every 7-sum is negative, whereas every 11-sum is positive. Find the greatest number of terms in such a sequence.* (6 points)

In our short training of 10 days, we did not treat any problem even distantly related to this one. I was quite amazed that most of the jury considered this problem easy and suggested merely 6 points for its solution. Only one member of our team gave a complete solution, and another gave an almost complete solution. On the other hand, our team worked very well with the most difficult problem of the Olympiad, which was worth 8 points. They tackled it with the ubiquitous extremal principle.

**E1** is, indeed, simple. It belongs to a large class of problems with almost *automatic* solutions. It does not require much ingenuity to write successive 7-sums in separate rows. Then one sees immediately that *q-sums* crop up automatically in successive columns. Hence continue with row sums until we get 11-sums columnwise. By adding the row sums, we get a negative total. By adding the column sums, we get a positive total. Contradiction!

86 5. Enumerative Combinatorics

*a*1 + *a*2 + ... + *a*7 *\<* 0 *a*2 + *a*3 + ... + *a*8 *\<* 0 *.
··· ··· ··· ··· ··· ··· ··· . a*11 + *a*12 + ... + *a*17 *\<* 0

*s*1 + *s*2 + ... + *sr* *\<* 0 *s*2 + *s*2 + ... + *sr*+1 *\<* 0 *··· ··· ··· ··· ··· ··· ··· ··· . . sr* + *sr*+1 + ·
· · + *sr*+*t*−1 *\<* 0

Fig. 5.1 Fig. 5.2

Thus, such a sequence can have at most 16 terms (Fig. 5.1). Some cleverness is required to construct such a sequence for 16 terms:

5*,* 5*,* −13*,* 5*,* 5*,* 5*,* −13*,* 5*,* 5*,* −13*,* 5*,* 5*,* 5*,* −13*,* 5*,* 5*.*

One could also construct the sequence more systematically. Here are a few related problems:

**E2.** *Replace 7, 11 by p, q with gcd*(*p, q*) = 1*. Then the maximal length is* ≤*p* + *q* − 2*, as was proved by John Rickard (GB) at the IMO.*

**E3.** *In addition, one can also require that every r-sum is equal to* 0*.*

**E4.** *If gcd*(*p, q*) = *d, then the maximal length is* ≤ *p* + *q* − *d* − 1*.* Proof: We set *p* = *dr*, *q* = *dt* with gcd(*r, t*) = 1*,* and consider the real sequence *ai* with *p* + *q* − *d* = (*r* + *t* − 1)*d* terms. Denote the nonoverlapping 1−*,* 2−*, ··· , d*-sums by *s*1*, s*2*, s*3*, ··· , st*+*t*−1*.* We write the negative *p*-sums until in rows the positive *q*-sums appear in columns, a contradiction (Fig. 5.2).

**E5.** *In a sequence of positive real numbers every p-product is \<* 1*, and each qproduct is \>* 1*.* By using logarithms, we see that such a sequence can have at most length *m* = *p* + *q* − *d* − 1*.*

**E6.** *In every sequence of positive integers, each 17-sum is even, and each 18-sum is odd. How many terms can such a sequence have at most?*

**E7.** *Let ai* =*revenues*−*expenditures in month i for the budget of Sikinia. If ai \<* 0*, there is a deficit in month* \#*i. We consider the sequence a*1*, a*2*, ··· , a*12*. Suppose every 5-sum is negative. Then it is possible that we have a surplus for the whole year. Deficits and surpluses can be arbitrarily prescribed. The deficits and the final surplus can be astronomical.*

Ideally an IMO problem should be unknown to all students. Even a similar problem should never have been discussed in any country. What was the status of **E1** in July 1977? Years later, I was browsing in *Dynkin--Molchanov--Rosental--Tolpygo: Mathematical Problems, 1971*, 3rd edition with 200,000 copies sold.

There, I found problem 118:

\(a\) Show that it is not possible to write 50 real numbers in a row such that every 7-sum is positive, but every 11-sum is negative.

\(b\) Write 50 numbers in a row, so that every 47-sum is positive, but every 11-sum is negative.

5. Enumerative Combinatorics 87

The origin of the problem was MMO 1969. The motive of **E1** was well known in Eastern Europe, so it should not have been used at all.

This problem belongs to combinatorics in a wider sense. Such problems are very popular at the IMO since the topic is not so easy to train for.
On the other hand, **enumerative combinatorics** is easy to train for.
It is based on a few principles every contestant should know.

The most general combinatorial problem-solving strategy is borrowed from algorithmics, and it is called

**Divide and Conquer:** *Split a problem into smaller parts, solve the problem for the parts, and combine the solutions for the parts into a solution of the whole problem.*

This **Super principle or paradigm** consists of a whole bundle of more special principles. For enumerative combinatorics, among others, these are *sum rule, product rule, product-sum rule, sieving, and construction of a graph which accepts the objects to be counted.* Divide and Conquer summarizes these and many other principles in a catchy slogan.

an *n-set.* A sequence of *r* elements from *A* is called an *r-word from the alphabet* Let \|*A*\| denote the number of elements in a finite set *A.* If \|*A*\| = *n,* we call *A A.* In enumerative combinatorics, we count the number of words from an alphabet A which have a certain property.

1. *Sum Rule.* If *A* = *A*1 ∪ *A*2 ∪ ... ∪ *Ar* is a partition of *A* into *r* subsets (*blocks, parts*), then \|*A*\| = \|*A*1\| +
\|*A*2\| + ... + \|*Ar*\|*.* Applying this rule, we try to split *A* into parts *Ai,* so that finding \|*Ai*\| is simpler.

This rule is ubiquitous and is used mostly subconsciously. One task of a trainer is to point out its use as frequently as possible.

2. *Product Rule.* The set *W* consists of *r*-words from an alphabet *A*. If there are *ni* choices available for the *i*th letter, *independent* of previous choices, then \|*W*\| = *n*1*n*2 ... *nr*.

3. *Recursion.* A problem is split into parts which are *smaller copies of the same problem*, and these in turn are split in even smaller copies,*··· ,* until the problem becomes trivial. Finally, the partial problems are combined to give a solution to the whole problem.

Besides the *Divide and Conquer Paradigm*, there are some other paradigms in enumerative combinatorics.

4. *Counting by Bijection.* Of two sets *A, B*, we know \|*B*\|, but
\|*A*\| is unknown. If we succeed in constructing a bijection *A* ↔
*B,* then \|*A*\| = \|*B*\|*.* A proof which shows \|*A*\| = \|*B*\|
by such an explicit construction is called a *bijective* instead of a 1--1 bijection.*proof* or *combinatorial proof.* Sometimes, one constructs a *p* − *q* bijection

5. *Counting the same objects in two different ways.* Many combinatorial iden tities are found in this way.

+-----------------+-----------------+-----------------+-----------------+
| > 90            | > 5.           |                 | > **s==**       |
|                 | > Enumerative   |                 | > **=H** **=**  |
|                 | > Combinatorics |                 | > **H** **QQ**  |
|                 |                 |                 | > **Q** **s**   |
|                 |                 |                 | > **H =** **H   |
|                 |                 |                 | > AA**          |
|                 |                 |                 | > **======**    |
|                 |                 |                 | > **s@ @** (d)  |
+=================+=================+=================+=================+
|                 | > **s** **s**   |                 | > **s** **! s** |
|                 | > **XX X        |                 | > **ss** **s!=! |
|                 | > s=====**      |                 | > ==!** **AA**  |
|                 | > **===** **X** |                 |                 |
|                 | > **s=h h h s** |                 |                 |
|                 | > **=** **h h** |                 |                 |
|                 | > **s AA =**    |                 |                 |
|                 | > (a)           |                 |                 |
+-----------------+-----------------+-----------------+-----------------+

5. Enumerative Combinatorics 91

Define *H*0 = 1. Then we get the recursion *Hn* ==*n k*=1=*n* =*Hn*−*k*.
The closed formula below uses *S*(*n, k*) =*number of partitions of an n-set into k blocks=Stirling number of the second kind.*

*Hn* =

+-----------------------------------+-----------------------------------+
| > *n*\                            | > *S*(*n, k*)*k*!                 |
| > =                               |                                   |
+===================================+===================================+ +-----------------------------------+-----------------------------------+

![](media/image4.png){width="0.3194444444444444in"
height="0.3333333333333333in"}

**E12.** Here the Stirling numbers of the second kind come up quite naturally. Let us find a recursion for *S*(*n, k*)*.*

There are *n* persons in a room. They can be partitioned in *S*(*n, r*) ways into *r* parts. I come into the room. Now there are *S*(*n*+1*, r*) partitions into *r* parts. There are two possibilities:

\(a\) I am alone in a block. The other *n* persons must be partitioned into *r* − 1 blocks. This can be done in *S*(*n, r* − 1) ways.

\(b\) I have *r* possibilities to join one of the *r* blocks. Thus,

*S*(*n* + 1*, r*) = *S*(*n, r* − 1) + *rS*(*n, r*)*,* *S*(*n,* 1) = *S*(*n, n*) = 1*.*

This is the analogue of the well-known formula\ =*n* + 1 = =*n* = = = =*n* = =*n* = *n* = + *,* = = 1*.r* *r* *r* − 1 0 *n*

To prove this, consider the number of *r*-subsets of an (*n*+1)-set. We partition them according to the element *n* + 1*.* Of these,=*n* = will not contain that = *n* = element, and will. *r*−1 It helps for a beginner to compute a few Stirling numbers S(n,k) for some values of *n* and *k* by using only the product-sum rule. Suppose we want to find *S*(8*,* 4)*.* This is the number of ways of splitting an 8-set into 4 blocks. There are 5 types of partitions: 5+1+1+1, 4+2+1+1, 3+3+1+1, 3+2+2+1, 2+2+2+2. See Fig. 5.6, where the 5 types are separated by 4 vertical lines.

**r== AArr** **rr** **r** **r r** **r** **[r]{.ul}** **[r]{.ul}** **r** **[r]{.ul}** **rr** **rrrrr** **r** **r** **r** **rr** **r** **~~r~~ [=]{.ul}= [A]{.ul}A r~~r~~ [=]{.ul}= [A]{.ul}A rr** **~~r~~
[=]{.ul}= [A]{.ul}A rrrr** **rrrr**Fig. 5.6

  -----------------------------------------------------------------------

  -----------------------------------------------------------------------

=8 =1. In the first type, we choose the three 1-blocks in 3 = 56 ways.2. The second type is determined by first choosing the 4-block and then the =8 ==4 = 2-block, which can be done in 4 2 = 70 · 6 = 420 ways.

+-----------------------------------+-----------------------------------+
| 92                                | > 5. Enumerative Combinatorics   |
+===================================+===================================+
|                                   | 3. To find the contribution of    |
|                                   | the third type, we first choose    |
|                                   | the two 1-blocks                  |
+-----------------------------------+-----------------------------------+
|                                   | > =8 = =6 =in 2 = 28 ways. Then   |
|                                   | > we must choose the first 3-block |
|                                   | > in 3 = 20 ways. The second      |
|                                   | > 3-block is now determined. But  |
|                                   | > there is no first block. We have |
|                                   | > introduced the ordering, which  |
|                                   | > must be eliminated on dividing  |
|                                   | > by 2. So we                     |
+-----------------------------------+-----------------------------------+
|                                   | > have 28 · 10 = 280 ways for the |
|                                   | > third type.                     |
+-----------------------------------+-----------------------------------+
|                                   | > =8 =4. For the fourth type, we  |
|                                   | > first choose the 3-block in 3 =  |
|                                   | > 56 ways. Then we choose the     |
|                                   | > 1-block in 5 ways. Finally, we  |
|                                   | > must partition the remaining    |
|                                   | > four elements into two pairs    |
|                                   | > (order does not count), which   |
|                                   | > can be done in 3 ways.          |
+-----------------------------------+-----------------------------------+
|                                   | > Thus, there are 56 · 5 · 3 =    |
|                                   | > 840 ways.                       |
+-----------------------------------+-----------------------------------+

5. The fifth type is determined by splitting the 8-set into 4 pairs.
This is the tennis player problem for 8 players. There are 7 · 5 · 3 ·
1 = 105 cases.

6. Altogether, we have *S*(8*,* 4) = 56 + 420 + 280 + 840 + 105 = 1701*.*

**E13.** *Cayley's formula for the number Tn of labeled trees with n vertices.*

A *tree* is a nonoriented graph without a cycle. It is called *labeled* if its vertices are numbered. First, we want to guess a formula for *Tn.* A labeled tree with one vertex is just a point. It can be labeled in one way. There is also just one labeling for a tree with two vertices since the tree is not oriented. But there are three labelings for three points. There are three choices for the middle point. The two other points are indistinguishable. For a tree with four vertices, there are two topologically different cases: a chain with four points. There are 12 distinct labelings for the chain. In addition, there is a star with one central point and three indistinguishable points connected with the center. There are four choices for the center. This determines the star.
Thus, *T*4 = 16. Now, let us take a tree with five vertices. There are three topologically different shapes: a chain, a star with a central point and four points connected to the center, and a T-shaped tree. See Fig. 5.7. There are 5!*/*2 = 60 labelings for the chain. The center of the star can be labeled in five ways. Now, let us look at the T. The intersection point of the horizontal and vertical bar can be chosen in five ways. The two points for the vertical tail can be chosen in six ways. They can be ordered in two ways. Now the T-shaped tree is determined. So there are 5·6·2 = 60 T-shaped trees. Altogether we have *T*5 = 60+5+60 = 125*.* Now, look at the table below. The table suggests the conjecture *Tn* = *nn*−2= number of (*n* − 2)-words from an *n*-alphabet.

+-----------------------------------+-----------------------------------+
| n                                 | > 1 2 3 4 5                       |
+===================================+===================================+
| *Tn*                              | > 1 1 3 16 125                    |
+-----------------------------------+-----------------------------------+

We want to test this conjecture for *n* = 6*.* If it turns out that it is valid again, then we gain great confidence in the formula, and we will try to prove it. This time we have six topologically different types of trees. See Fig. 5.8.

1. There are 6!*/*2 = 360 distinct labelings for the chain.

<table style="width:100%;">
<colgroup>
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 10%" />
</colgroup>
<thead>
<tr class="header">
<th rowspan="2"><strong>tt t t t</strong></th>
<th rowspan="2"><blockquote>
<p><strong>t ==@</strong> <strong>tt t</strong> <strong>t</strong> <strong>t</strong> <strong>tt t</strong> <strong>t</strong> Fig. 5.7</p>
</blockquote></th>
<th rowspan="2"><strong>ss s s s s</strong></th>
<th rowspan="2"><p><strong>s</strong></p>
<p><strong>=</strong></p></th>
<th rowspan="2"><p><strong>s s s</strong></p>
<p><strong>s</strong></p></th>
<th colspan="3">5. Enumerative Combinatorics</th>
<th rowspan="2"><p><strong>s</strong></p>
<p><strong>s</strong></p></th>
<th>93</th>
</tr>
<tr class="odd">
<th><strong>s</strong></th>
<th><blockquote>
<p><strong>s =ss</strong> <strong>s</strong> <strong>s s s</strong> <strong>ss s</strong> Fig. 5.8<strong>s</strong> <strong>s</strong></p>
</blockquote></th>
<th><strong>s @=ss=s</strong></th>
<th><strong>s s s s s s</strong></th>
</tr>
</thead>
<tbody>
</tbody>
</table>

  ----------------------------------- -----------------------------------
                                      

  ----------------------------------- -----------------------------------

2. Now take the Y-shape with the vertical tail consisting of three edges. We can choose the center in six ways. The points for the tail can be chosen in=5 == 10 ways. The order of the three points in the tail can be chosen in 3! = 6 ways. This determines the labeling of the Y-shape. So there are 360 possible labelings for this type of a tree.

3. Now comes the Y-shape with a vertical tail of one edge. The center can be chosen in six ways. The endpoint of the vertical tail can be chosen in five ways. The two other pairs of points can be chosen in three ways. Each can be ordered in two ways. The product rule gives 6
· 5 · 3 · 2 · 2 = 360*.*

4. The intersection point of the cross with a tail of two edges can be chosen in six ways. The three points with distance 1 from the center can be chosen in = 10 ways. The remaining two points go into the tail and can be labeled in two ways. Again, the product rule gives 6 · 10 · 2 = 120*.*=5 =\ =6 =5. Now comes the double-T. The two centers can be chosen in 2 = 15 ways. The two points for one end of the edge connecting the two centers can be =4 = chosen in 2 = 6 ways. The two other points go to the other endpoint. So there are 15 · 6 = 90 distinct labelings for a double-T.

6. The center of the star can be chosen in 6 ways. This determines the labeling of the star.

This is a decisive confirmation of our conjecture. Now, we try to prove it by Thus, we have *T*6 = 360 · 3 + 120 + 90 + 6 = 64*.*

constructing a bijection between labeled trees with *n* vertices and (*n* − 2)-words from the set {1*,* 2*, ··· , n*}*.*

*Coding Algorithm.* In each step, erase a vertex of degree one with lowest number together with the corresponding edge and write down the number at the other end of the crossed-out edge. Stop as soon as only two vertices are left.

For the tree in Fig. 5.9, we have the so-called *Pr¨ufer Code* (7,7,2,2,7).

*DecodingAlgorithm.*WritethemissingnumbersundertheCodewordinincreasing order, the so called *anticode* (1,3,4,5,6). Connect the two first numbers of code and anticode and cross them out. If a crossed-out number of the code does not occur any more in the code then it is sorted into the anticode. Repeat, until the code vanishes. Then, the two last numbers of the code and anticode are connected.

5. Enumerative Combinatorics 95

• Now, we count the quadruples (*x, y, z, u*) with *u \> max*{*x, y, z*}. Simple counting leads to\ 13+ 23+ ... + *n*3*.*

After partitioning, sophisticated counting gives 3+1*,* 2+1+1*,* 1+1+1+1. As above,\ =*n* + 1 =*,* 3 · 2 ·=*n* + 1 =*,* 3! ·=*n* + 1 =*.*2 3 4

Hence, we get

13+ 23+ ... + *n*3==*n* + 1 =+ 6 ·=*n* + 1 =+ 6 ·=*n* + 1 =*.*2 3 4

• We count all quintuples (*x*1*, ··· , x*5) from {1*,* 2*, ··· , n* + 1} with *x*5 *\>* max*i*≤4 *xi.* The simple counting again gives

14+ 24+ ... *n*4*.*

Sophisticated counting uses the partitions 4 + 1, 3 + 1 + 1, 2 + 2 + 1, 2 + 1 + 1 + 1, 1 + 1 + 1 + 1 + 1. Thus, we get

14+ 24+ ... *n*4==*n* + 1 =+ 14=*n* + 1 =+ 36=*n* + 1 =+ 24=*n* + 1 =*.*2 3 4 5

• Now we can prove the general formula

1*k*+ 2*k*+ ... *nk*=

+-----------------------------------+-----------------------------------+
| > *k*\                            | > *S*(*k, i*)=*n* + 1 =*i*!*.i* + |
| > =                               | > 1                               |
+===================================+===================================+ +-----------------------------------+-----------------------------------+

= *n*+1 =2*m*+1**Solution.** The result is the number of choices of a (2*m*+1)-subset from an (*n*+1)**E16.** *The number of binary n-words with exactly m 01-blocks is* .

set. Why (2*m* + 1) elements from (*n* + 1) elements? This result may direct us to 10-words. Look at the transitions 0 − 1. There should be exactly *m* of these. But the number of 1−0 transitions can be *m*−1, *m*, or *m*+1. It would be nice to have exactly *m* + 1 transitions from 1 to 0. But we can always extend the word by a 1 at the beginning and a 0 at the end. Then we always have exactly (*m* + 1) transitions from 1 to 0. Altogether, we have an (*n*+2)-word with *n*+1 gaps. From these gaps, we freely choose 2*m* + 1 places for a switch. This can be done in= *n*+1 = ways. This is a very good example of the *construction of a bijection.* 2*m*+1\ **E17.** Find a closed formula for *Sn* ==*n* =*n* = *k*2*.* *k*=1 *k* Here is a sophisticated direct counting argument: The sum is the number of ways to choose a committee, its chairman, and its secretary (possible the same

5. Enumerative Combinatorics 99

=2*n* =This is a probabilistic problem. Among all *n* paths from the origin to (*n, n*), we considered the *good paths* which never cross the line *y* = *x.* A fundamental idea in probability tells us that:
**if you cannot find the number of good paths, try to find the number of bad paths.** For the bad paths, we guess

=2*n* = =2*n* = =2*n* = =2*n* − 1 =*Bn* = *n* −*n* + 1 *n* =*n* + 1 *n* =*n* + 1 *n* *n* − 1\ *n* *n* 2*n* 1\ = = *.* *n* + 1 *n* − 1 *n* + 1 *n* *n* + 1=2*n* − 1\ = =2*n* − 1 = = 2*n* == 2*n* 2*n*\ =*n* = =*n*−1 = =*n* = = *n* =Here we used the formulas *k* =*n* *k*−1 and *k* = *n*−*k* in each direction. This result is easy to interpret geometrically. Indeed, the number of bad paths is the number of all paths from (−1*,* 1) to (*n, n*)*.* Here (−1*,* 1) is the reﬂection of the origin at *y* = *x* + 1*.* Now, we construct a bijection of the bad paths and all paths from (−1*,* 1) to (*n, n*)*.* Every bad path touches *y* = *x* + 1 for the first time. The part from O to *y* = *x* +1 is reﬂected at *y* = *x* +1*.* It goes into a path from (−1*,* 1) to (*n, n*), and any path from (−1*,* 1) to (*n, n*) crosses *y* = *x* + 1 somewhere for the first time. If you reﬂect it at *y* = *x* + 1*,* you get a bad path. Thus, we have a bijection between bad paths and all paths from (−1*,* 1) to (*n, n*)*.* This so-called *reﬂection principle* is due to *Desir´e Andr´e*, 1887.

*Cn* are called Catalan numbers. They are almost as ubiquitous as the Pascal occurences of Catalan numbers.=*n* =\ numbers *k.* In the problems at the end of this chapter, you will find some more **E21.** *Principle of Inclusion and Exclusion (PIE or Sieve Formula).*

This very important principle is a generalization of the Sum Rule to sets which need not be disjoint. Venn diagrams show that \|*A* ∪ *B*\|
= \|*A*\| + \|*B*\| − \|*A* ∩ *B*\| and

\|*A* ∪ *B* ∪ *C*\| = \|*A*\| + \|*B*\| + \|*C*\| − \|*A* ∩ *B*\| −
\|*B* ∩ *C*\| − \|*C* ∩ *A*\| + \|*A* ∩ *B* ∩ *C*\|*.*

We generalize to *n* sets as follows.

\|*A*1 ∪ ... ∪ *An*\| =

+-----------------------------------+-----------------------------------+
| > *n*\                            | > \|*Ai* ∩ *Aj* ∩ *Ak*\|          |
| > =\|*Ai*\| −=\|*Ai* ∩ *Aj* +     |                                   |
| > =*i*=1 *i\<j* *i\<j\<k* − ... |                                   |
| > (−1)*n*+1\|*A*1 ∩ ... ∩       |                                   |
| > *An*\|*.*                       |                                   |
+===================================+===================================+ +-----------------------------------+-----------------------------------+

*Proof.* Suppose an element *a* is contained in exactly *k* of the *n* sets *Ai.* How often is it counted by the right side? Obviously,

*k* −=*k*

=+=*k* =−... = 1−(1−*k* +=*k* =−=*k* =+=*k* =−...) = 1−(1−1)*k*= 1

time. So it is counted exactly once. This proves the PIE.

As an example, we consider all *n*! permutations of 1*,* 2*, ··· , n.* If an element *i* is on place number *i*, then we say *i* is a fixed-point of the permutation. Let *pn* be

+-----------------------------------+-----------------------------------+
| > **==rJ** **r r** **J            | > 5. Enumerative Combinatorics   |
| > \"\"\"\"\"** **J r** **r**      | > 101 s p ==r ======pC@ == r @ == |
| > **r** **=** **J** **=** **J**   | > s p p                           |
| > (a)                             | > pppppppppp                      |
|                                   | ppppppppppppppppppppppppppppppppp |
|                                   | ppppppppppppppppppppppppppppppppp |
|                                   | ppppppppppppppppppppppppppppppppp |
|                                   | ppppppppppppppppppppppppppppppppp |
|                                   | ppppppppppppppppppppppppppppppppp |
|                                   | > @ = r = r = aaa rp B HH =@ =J = |
|                                   | > r H HHHHHr J s p = H @ @ r A= H |
|                                   | > H J J @@ r (b) (c) JJ Fig. 5.15 |
+===================================+===================================+ +-----------------------------------+-----------------------------------+

13. In how many ways can you select two disjoint subsets from an *n*-set?\ 14. Let *b*(0) = 1 and *b*(*n*) =number of partitions of *n* into powers of 2 for *n* ≥ 1. Find recursions for *b*(*n*), and compute a table up to *b*(40)*.*

15. A permutation *p* of the set {1*, ··· , n*} is called an *involution*, if *p* ◦ *p* = *identity.* Find a recursion for the number *tn* of involutions of {1*, ··· , n*}. Also find a *closed formula* in the form of a sum.

16. Let *f* (*n*) be the number of *n*-words without neighboring zeros from the alphabet {0*,* 1*,* 2}. Find a recursion and a formula for *f* (*n*).

17. Figs. 5.15a,b,c show three configurations: the complete fourside, the Pappus--Pascal configuration, and the Desargues configuration. In how many ways can you permute their points, so that collinearity is preserved?

In the next four problems, you will find some occurrences of Catalan numbers. Your task will be to find an interpretation as good paths.

18. 2*n* points are chosen on a circle. In how many ways can you join pairs of points by nonintersecting chords?

19. In how many ways can you triangulate a convex *n*-gon?

20. In how many ways can you place parentheses in a nonassociative product of *n* factors?21. How many binary trees with *n*-labeled leafs are there?

22. Find combinatorial proofs of the following formulas. Use bijection or counting the same objects in two ways.

+-----------------------------------+-----------------------------------+
| \(a\)                             | +--------------+--------------+   |
|                                   | |              | > =*n*       |   |
|                                   | |              | > ==*n*=*n*  |   |
|                                   | |              | > − 1 =\     |   |
|                                   | |              | > =*n* ==*r  |   |
|                                   | |              | > k*===*n*   |   |
|                                   | |              | > ==*n* −    |   |
|                                   | |              | > *k* =\     |   |
|                                   | |              | > =*n* ==    |   |
|                                   | |              | > *n* =      |   |
|                                   | |              | > =2*n* =    |   |
|                                   | |              | > =*n* =2*n* |   |
|                                   | |              | > *n*\       |   |
|                                   | |              | > = *i* *n*  |   |
|                                   | |              | > − *i* =    |   |
|                                   | |              | > *n* ==     |   |
|                                   | |              | > *ii*=0     |   |
|                                   | |              | > *i*=0\     |   |
|                                   | |              | > =*n* =     |   |
|                                   | |              | > =*n* − 1 = |   |
|                                   | |              | > =*n* =     |   |
|                                   | |              | > =*n* =     |   |
|                                   | |              | > =*n* =     |   |
|                                   | |              | > =*n* =     |   |
|                                   | |              | > *n*\       |   |
|                                   | |              | > *s* =*n* − |   |
|                                   | |              | > *s* *s*    |   |
|                                   | |              | > *e*) 0 + 2 |   |
|                                   | |              | > + ... =  |   |
|                                   | |              | > 1 + 3 + ·  |   |
|                                   | |              | > · ·=*n*    |   |
|                                   | |              | > =+=*n* + 1 |   |
|                                   | |              | > =+=*n* + 2 |   |
|                                   | |              | > =+ ...   |   |
|                                   | |              | > +=*n* +    |   |
|                                   | |              | > *r* =*r*   |   |
|                                   | |              | > ==*n* +    |   |
|                                   | |              | > *r* + 1    |   |
|                                   | |              | > =*.*       |   |
|                                   | +==============+==============+   |
|                                   | |              |              |   |
|                                   | +--------------+--------------+   |
|                                   | |              |              |   |
|                                   | +--------------+--------------+   |
|                                   | |              |              |   |
|                                   | +--------------+--------------+   |
|                                   | |              |              |   |
|                                   | +--------------+--------------+   |
|                                   |                                   |
|                                   | \(a\)                             |
|                                   |                                   |
|                                   | \(b\)                             |
|                                   |                                   |
|                                   | \(c\)                             |
|                                   |                                   |
|                                   | \(d\)                             |
|                                   |                                   |
|                                   | \(f\)                             |
+===================================+===================================+
| \(b\)                             |                                   |
+-----------------------------------+-----------------------------------+
| \(c\)                             |                                   |
+-----------------------------------+-----------------------------------+
| \(d\)                             |                                   |
+-----------------------------------+-----------------------------------+
| \(f\)                             |                                   |
+-----------------------------------+-----------------------------------+

23. How many games are needed to find the winner in a tennis tournament with *n* players, if the KO-system is used? Use bijection.

102 5. Enumerative Combinatorics

24. How many 5-words from the alphabet {0*,* 1*, ··· ,* 9} have (a) strictly increasing digits, (b) strictly increasing or decreasing digits, (c) increasing digits, (d) increasing or decreasing digits?

25. In Lotto, 6 numbers are chosen from {1*,* 2*, ··· ,* 49}
with=49 =many of these subsets have at least a pair of neighbors?

possible 6-subsets. How 26. Let *F*(*n, r*) = number of *n*-permutations with exactly *r* cycles = Stirling number of the first kind. Prove the recurrences

*F*(*n* + 1*, r*) = *F*(*n, r* − 1) + *n F*(*n, r*)*,* *F*(*n,* 1) = (*n* − 1)!*,* *F*(*n, n*) = 1*.*

27. Euler's *φ*-function of a positive integer *n* is defined as follows:

*φ*(*n*) = the number of positive integers ≤ *n* which are prime to *n*.

Prove that\ = = *m*\ *φ*(*n*) = *n*= 1 −1 *,* *pi* *i*=1\ where *p*1*, p*2*, ··· , pm* are all distinct prime divisors of *n.* Use PIE.

28. Let *m* ≥ *n, Bm* = {1*, ··· , m*}*, Bn* = {1*, ··· , n*}.
The mappings from *Bm* onto *Bn* are called *surjections.* Find the number *s*(*m, n*) of surjections from *Bm* onto *Bn.* Use PIE.

29. Let *a*1*, a*2*, a*3 *···* be the infinite sequence 1, 2, 2, 3, 3, 3,*··· ,* where *k* occurs *k* times. Find *an* = *f* (*n*) in closed form. ⌊ ⌋ and ⌈ ⌉ are permitted.

30. Let 1 ≤ *k* ≤ *n.* Consider all finite sequences of positive integers with sum *n.* Suppose that the term *k* occurs *T* (*n, k*) times in all these sequences. Find *T* (*n, k*)*.*

31. Consider a row of *n* seats. A child sits on each. Each child may move by at most one seat. Find the number *Fn* of ways they can rearrange.

32. Consider a circular row of *n* seats. A child sits on each. Each child may move by at most one seat. Find the number *an* of ways they can rearrange.

33. Consider all *n*-words from the alphabet {0*,* 1*,* 2*,* 3}*.* How many of them have an even number of (a) zeros, (b) zeros and ones?

34. Does a polyhedron exists with an odd number of faces, each face having an odd number of edges?

35. Can you partition the set of positive integers into infinitely many infinite subsets, so that each subset is generated from any other by adding the same positive integer to each element of the subset?

36. Given are 2001 pairwise distincts weights *a*1 *\< a*2 *\<* ...
*\< a*1000 and *b*1 *\< b*2 *\<* ... *\< b*1001*.* Find the weight with rank 1001 by 11 weighings.

37. Consider all 2*n*−1 nonempty subsets of the set {1*,* 2*, ··· , n*}. For every such subset, we find the product of the reciprocals of each of its elements. Find the sum of all these products.

38. Find the number *xn* of *n*-words from the alphabet *A* = {0*,* 1*,* 2}, if any two neighbors differ at most by 1.

39. How many *n*-words from the alphabet {*a, b, c, d*} are such that *a* and *b* are never neighbors?

5. Enumerative Combinatorics 105

7. We interpret the subsets as *n*-words from the alphabet {0*,* 1}.
Let *an* be the number of binary words with no two successive ones.
The words can start either with 0 and may continue in *an*−1 ways, or they start with 10 and may continue in *an*−2 ways. Thus, *an* = *an*−1 + *an*−2, *a*1 = 2, *a*2 = 3. Thus, *an* is the Fibonacci number *Fn*+2.

8. (a) Suppose there is such a numbering. Let the sum of the edge labels for each vertex be *s*. Then the sum of all vertex sums is 8*s*. In this sum, each edge label occurs twice. Thus 2(1 + ... + 12) = 8*s*, or *s* = 19*.*5. Since *s* is a positive integer we have a contradiction.

\(b\) Replace one number in the numbering of the edges by 13, and call the replaced number by *r*. Then we have 2(1 + ... + 12 + 13) − 2*r* = 8*s*, or 91 − *r* = 4*s*, that is, *r* ∈ {3*,* 7*,* 11}. This necessary condition is also sufficient. Try to find a corresponding labeling for some value of *r*.

9. There is a bijection between subsets with an even and odd number of elements. Indeed, consider any element, say 1. Let *A* be any subset. If it contains 1, then we assign the subset *A*\\{1} to it. If it does not contain 1, then we assign the subset *A* ∪ {1} to it. This bijection proves that exactly one-half of all 2*n*subsets contain an odd number of elements, that is, 2*n*−1.

10. The solution will be found in Chapter 4.

11. Write the nine numbers along a circle, and draw a line between any two numbers for which the sum is not 3, 5, or 7. We get a graph, for which we must find a Hamiltonian circuit. Now, such a circuit is easy to find since 1, 2, and 4 have only two neighbors. One gets 1*,* 3*,* 8*,* 5*,* 6*,* 2*,* 9*,* 4*,* 7.

12. This problem is instructive, since besides *Divide and Conquer*, we practice space geometry and spacial intuition. First, we solve the analogous plane problem. Three noncollinear points are given in the plane. How many parallelograms are there with vertices in these points?

This problem is considerably simpler and at first does not help much for the space analogy. The answer is 3. The fourth vertex of the parallelogram is obtained by reﬂecting each of the given vertices *A, B, C* at the midpoint of the side of △*ABC* to *A*1*, B*1*, C*1.

**First solution**. Of the 8 vertices we single out four noncoplanar ones. There are four distinct ways of doing this (Divide and Conquer).
In Fig. 5.16 (a) to (d) 3*,* 2*,* 1*,* 0 faces have three of the four fixed points. Such faces will be called *rigid*, since they can be constructed from their three points.

\(a\) Three rigid faces have a common vertex *A*. In this case there are four boxes.

\(b\) Two rigid faces have a common edge *AB*. Any two points can play the role of *AB*. The choice of *AB* can be done in six ways. Then we can decide in two ways which point is joined to *B*. In this case there are 12 boxes.

\(c\) There is one rigid face with three points and the fourth vertex *D*′must lie opposite *D*. Each of the four vertices can be *D*, and each of the other three can be *D*′. Then the box is constructible. We have 12 boxes again.

\(d\) There is no rigid face. The selected vertices are the vertices of a tetrahedron inscribed in the box. The box is uniquely determined.
Through each edge of the tetrahedron, we draw the plane parallel to the opposite edge.

![](media/image5.png){width="0.6805555555555556in"
height="0.5833333333333334in"}![](media/image6.png){width="0.6805555555555556in"
height="0.5833333333333334in"}![](media/image7.png){width="0.6944444444444444in"
height="0.5833333333333334in"}![](media/image8.png){width="0.6944444444444444in"
height="0.5833333333333334in"}

<table>
<colgroup>
<col style="width: 9%" />
<col style="width: 9%" />
<col style="width: 9%" />
<col style="width: 9%" />
<col style="width: 9%" />
<col style="width: 9%" />
<col style="width: 9%" />
<col style="width: 9%" />
<col style="width: 9%" />
<col style="width: 9%" />
<col style="width: 9%" />
</colgroup>
<thead>
<tr class="header">
<th rowspan="4">106</th>
<th colspan="7"><blockquote>
<p>5. Enumerative Combinatorics</p>
</blockquote></th>
<th rowspan="4"><blockquote>
<p>==s<em>D</em>′</p>
<p>s</p>
<p>==</p>
</blockquote></th>
<th rowspan="4"><blockquote>
<p>==s<br />
s ==(d)</p>
</blockquote></th>
<th rowspan="4"><blockquote>
<p>s==<br />
==s</p>
</blockquote></th>
</tr>
<tr class="odd">
<th rowspan="2"><em>A</em></th>
<th rowspan="2"><blockquote>
<p>s==<br />
s ==s (a)</p>
</blockquote></th>
<th><blockquote>
<p>==</p>
</blockquote></th>
<th><em>B</em></th>
<th rowspan="2"><blockquote>
<p>s ==s<br />
s ==(b)</p>
</blockquote></th>
<th><blockquote>
<p>==</p>
</blockquote></th>
<th rowspan="2">s ==<br />
s ==(c)</th>
</tr>
<tr class="header">
<th><blockquote>
<p>s</p>
<p>==</p>
</blockquote></th>
<th><em>A</em></th>
<th><blockquote>
<p>s== <em>D</em> Fig. 5.16</p>
</blockquote></th>
</tr>
<tr class="odd">
<th colspan="6"><blockquote>
<p><em>A</em>1<br />
<strong>==SS</strong><br />
<em>C</em><strong>=</strong> <strong>S</strong> <em>B</em><br />
<strong>=SS</strong> <strong>==S</strong><br />
<em>B</em>1 <strong>=</strong> <strong>S =</strong> <strong>S</strong><br />
<em>A</em></p>
</blockquote></th>
<th><blockquote>
<p><em>C</em>1</p>
</blockquote></th>
</tr>
</thead>
<tbody>
</tbody>
</table>

Fig. 5.17

There are altogether 4 + 12 + 12 + 1 = 29 boxes.

**Second solution**. Look at the plane problem in Fig. 5.17. The answer three can be obtained as follows. The midlines of the future parallelogram are lines equidistant from the three vertices. If we have two midlines, then we can easily find the missing vertex of the parallelogram. We draw parallels to the given points. There are three straight lines equidistant from the three given points. One can select 2 lines from them in three ways.

*Now to the space problem*. The midplanes of the box we want to find are equidistant from all 8 vertices and satisfy the following conditions:\ (1) Each is equidistant from the four points.

\(2\) All three planes pass through a point.

On the other hand, if we can find a triple of planes satisfying (1) and (2), then the box with these midplanes is uniquely constructible.
Through the four points draw all distinct planes parallel to each plane of the triples, and the box is ready.

How many planes are equidistant from four noncoplanar points *K, L, M, N*? *Exactly* 7. It suffices to decide which points lie on one side of a plane. There are four of in 35 ways. Each triple satisfies condition (1). Which triples are "bad," i.e., do not the type 1 \| 3 and three of the type 2 \| 2. Three planes out of seven can be selected satisfy (2)? They are parallel to a line. There are six of these, as many as the number of edges of the tetrahedron, that is, 35 − 6 = 29. Why?

**Third solution**. Of the 8 vertices, we can single out four in 70 ways, of which there are 6+6 = 12 coplanar quadruples. Thus, we are left with 70−12 = 58 noncoplanar quadruples. But to every such quadruple, there is a complementary quadruple which gives the same box. Hence, we are left with 29 boxes.

13. For an ordered pair (*A, B*) of disjoint subsets, we define the characteristic function

⎧ 1 if *x* ∈ *A, f* (*x*) =⎨2 0 if *x* ∈ *B,* otherwise.

Then the function *f* is an *n*-word from the alphabet {0*,* 1*,* 2}.
The number of possible ⎩\ functions is 3*n*. There are 2*n*words from {0*,* 2} (*A* empty), 2*nn*-words from {0*,* 1} (*B*

5. Enumerative Combinatorics 107

empty), and 1 word consisting entirely of zeros. Then *A* and *B* are both empty. Thus, the number of ordered disjoint pairs is 3*n*− 2*n*− 2*n*+ 1. The number of unordered pairs is\ *g*(*n*) =3*n* [+]{.ul} 1− 2*n.*

Check this for *n* = 4 by drawing pictures.

14. Consider some examples: *b*(0) = 1 by definition. 20= 1 ⇒ *b*(1) = 1. 2 = 21=1 + 1*, b*(2) = 2, 3 = 2 + 1 = 1 + 1 + 1*, b*(3) = 2. 4 = 22= 21+ 21=21+1+1 = 1+1+1+1*, b*(4) = 4. 5 = 22+1 = 21+21+1 = 21+1+1+1 =1 + 1 + 1 + 1*, b*(5) = 4.

We observe that (a) *b*(2*n*) = *b*(2*n* + 1) and (b) *b*(2*n*) = *b*(2*n* − 2) + *b*(*n*). Proof of (a): Every partition of 2*n* + 1 has a last summand 1. If we take it away, we get a partition of 2*n*.
Proof of (b): A partition of 2*n* has either a smallest element 2 or two ones. There are *b*(*n*) of the first kind and *b*(2*n* − 2) of the second kind.

15. Let *tn* be the number of involutions of {1*, ··· , n*}, i.e, the permutations *p* such that *p* ◦ *p* is the identity. Add another element *n* + 1. It can be a fixed point in *tn* ways.

It is not a fixed point in *ntn*−1 ways, that is,

*tn*+1 = *tn* + *n* · *tn*−1*,* *t*1 = 1*, t*2 = 2*.*

The closed formula for *tn* is

= *n* ⌊*n/*2⌋\ *tn* == 2*k*=(2*k*)!2*kk*!*.* *k*=0\ = *n* = Interpretation of this formula: From *n* elements, we select 2*k*. This can be done in 2*k* ways. Then we partition them into *k* unordered pairs in (2*k*)!*/*(2*k*· *k*!) ways. The re maining *n*−2*k* points are fixed points. This must be summed for *k* = 0*,* 1*, ··· ,*
⌊*n/*2⌋. Thus, we get\ = *n* ⌊*n/*2⌋\ *tn* == 2*k*=· 1 · 3 · 5 ... (2*k* − 1)*.k*=0\ 16. The words can begin with 1*,* 2 and continue in *f* (*n* − 1) ways, or they can start with 01*,* 02 and continue in *f* (*n* − 2) ways. Thus we have the recurrence *f* (*n*) = 2*f* (*n* − 1) + 2*f* (*n* − 2) with *f* (1) = 3*, f* (2) = 8. From the recurrence, we get *f* (0) = 1. Thus, finally, we have

*f* (*n*) = 2*f* (*n* − 1) + 2*f* (*n* − 2)*,* *f* (0) = 1*, f* (1) = 3*, f* (2) = 8*.*

The characteristic equation of this difference equation is *λ*2−2*λ*−2 = 0. Thus we get *λ*1*,*2 = 1±We get *a, b* from initial conditions.
Do it._sqrt_3. Now, it is easy to find a close formula of the form *f* (*n*) = *aλn* 1+*bλn* 2.

17. Answer (a) 24. (b) 108. (c) 120. We show how to get (b): Label the 9 points of the configuration *A*, *B*, *C*, *P*, *Q*, *R*, *L*, *M*, *N* so that *ABC* and *PQR* are as in Fig. 5.15b. We want to relabel the configuration such that collinearity is conserved. There are nine ways to choose *A*. Say *A* is fixed. For *B*, there are six places left, since *A* and *B* are collinear. For *P*, there are only two ways. Now the places of all the other points are fixed. So, there are 6 · 4 · 2 = 108 possible collineations.

+-----------------------+-----------------------+-----------------------+
| 108                   | > 5. Enumerative     | > *b*                 |
|                       | > Combinatorics       |                       |
+=======================+=======================+=======================+
|                       | > *b*\                |                       |
|                       | > *beb* **bb** **H**  |                       |
|                       | > *e* **(( =** **b**  |                       |
|                       | > **H** **=(** **b**  |                       |
|                       | > **H** **=** **(**   |                       |
|                       | > **b** **H** **( (** |                       |
|                       | > **b** **H H** *e*   |                       |
|                       | > *b* *e*\            |                       |
|                       | > *b* *e*             |                       |
+-----------------------+-----------------------+-----------------------+
|                       |                       | > *e*                 |
+-----------------------+-----------------------+-----------------------+

Fig. 5.18

+-----------+-----------+-----------+-----------+-----------+-----------+
| >         | > **===** | > **==@   | > **==**  |           |           |
| **==AA**\ |           | > ==@=**  | > **AAA** |           |           |
| > **=**   |           |           |           |           |           |
| > **A**   |           |           |           |           |           |
+===========+===========+===========+===========+===========+===========+ +-----------+-----------+-----------+-----------+-----------+-----------+

5. Enumerative Combinatorics 109

open parenthesis, go one step to the right; for every *xi*, go one step up. Notice that we ignore the closed parentheses. If they were all deleted, all multiplications would still be uniquely determined.
Another interpretation is even more direct. Ignore the *xi*, but keep all parentheses. Now, we can use Fig. 5.20 to get well-formed expressions

110 5. Enumerative Combinatorics

23. (*n* − 1) games. 1 plays against 2, the winner against 3, the winner against 4, and so on. There is no shorter way. Indeed, there must be (*n* − 1) losers.

=10 =24. (a) 5 = 252. (b) 512. (c) We can choose five digits from ten digits with repetition in =10+5−1 ===14 == 2002 ways. (d) 2·2002−10.
In the last result, we must subtract 10 for the 10 words of the form *aaaaa*, which are both increasing and decreasing.25. We find the number of 6-subsets with no neighbors. We think of the 49 numbers as a row of 49 balls, the 43 unselected balls, white, the six selected balls black. No two black balls must be neighbors. Thus we have 44 places for them. One can select six =44 =\ places from them in 6 ways. Thus, there are altogether\ =−=44 ==49

subsets with at least one neighbor. These are 49*.*5% of all subsets.

26. Add another point *n* + 1. There are two possibilities. First, (*n* + 1) is a fixed point (1-cycle). Then, the remaining *n* points must be arranged in (*r* − 1) cycles. This can be done in *F*(*n, r* − 1) ways. Second, the point is included in some cycle. In this case, there are already *r* cycles, which can be built in *F*(*n, r*) ways.
In how many ways can the new point be included in a cycle? It can be put in front of any of the *n* points. This can be done in *n* ways.
Thus,

*F*(*n* + 1*, r*) = *F*(*n, r* − 1) + *nF*(*n, r*)*,* *F*(*n,* 1) = (*n* − 1)!*, F*(*n, n*) = 1*.*

27. Let *Ai* be the subset of all numbers from {1*, ··· , n*}
divisible by *pi*. Then, the number of numbers from 1 to *n* divisible by some prime is

<table style="width:100%;">
<colgroup>
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 10%" />
</colgroup>
<thead>
<tr class="header">
<th rowspan="2"><blockquote>
<p>|<em>A</em>1 ∪ <em>A</em>2 ∪ ... ∪ <em>An</em>| =</p>
</blockquote></th>
<th rowspan="2">=</th>
<th><em>n</em></th>
<th rowspan="2">−</th>
<th rowspan="2">=</th>
<th><em>n</em></th>
<th rowspan="2">+</th>
<th rowspan="2"><p>=</p>
<p><em>i&lt;j&lt;k</em></p></th>
<th><em>n</em></th>
<th rowspan="2"><blockquote>
<p>− ... <em>.</em></p>
</blockquote></th>
</tr>
<tr class="odd">
<th><em>pi</em></th>
<th><em>pipj</em></th>
<th><em>pipjpk</em></th>
</tr>
</thead>
<tbody>
</tbody>
</table>

The number of elements not divisible by any of the primes *p*1*, ···
, pm* is

<table>
<colgroup>
<col style="width: 9%" />
<col style="width: 9%" />
<col style="width: 9%" />
<col style="width: 9%" />
<col style="width: 9%" />
<col style="width: 9%" />
<col style="width: 9%" />
<col style="width: 9%" />
<col style="width: 9%" />
<col style="width: 9%" />
<col style="width: 9%" />
</colgroup>
<thead>
<tr class="header">
<th rowspan="2"><em>n</em> −</th>
<th rowspan="2">=</th>
<th><em>n</em></th>
<th rowspan="2">+</th>
<th rowspan="2">=</th>
<th><em>n</em></th>
<th rowspan="2">− ... = <em>n</em></th>
<th rowspan="2"><blockquote>
<p><em>m</em><br />
=</p>
</blockquote></th>
<th rowspan="2">=1 −1<em>pi</em></th>
<th rowspan="2">=</th>
<th rowspan="2"><blockquote>
<p><em>.</em></p>
</blockquote></th>
</tr>
<tr class="odd">
<th><em>pi</em></th>
<th><em>pipj</em></th>
</tr>
</thead>
<tbody>
</tbody>
</table>

28. Let *Ai* be the set of mappings in which the element *i* ∈ *Bn* is not hit by an arrow from *Bm*. Then the number of nonsurjections is

\|*A*1 ∪ *A*2 ∪ ... ∪ *An*\| ==*n* =(*n* − 1)*m*−=*n* =(*n* − 2)*m*+
... *.* *m* ≥ *n.*

=*n* =If we subtract this number from the number *nm*or from 0(*n* − 0)*m*of all mappings from *Bm* to *Bn*, then we get *s*(*m, n*). For *m* ≥ *n*, we get

*s*(*m, n*) ==*n* =(*n* − 0)*m*−=*n* =(*n* − 1)*m*+ ... =

+-----------------------------------+-----------------------------------+
| > *n*\                            | > =*n* =(*n* − *i*)*m.*           |
| > =(−1)*ii*=0                     |                                   |
+===================================+===================================+ +-----------------------------------+-----------------------------------+

+-----------------------+-----------------------+-----------------------+
| > 29. **First        |                       | > *.*                 |
| > solution**. We want |                       |                       |
| > to have *an* = *k*  |                       |                       |
| > if                  |                       |                       |
+=======================+=======================+=======================+
| *k*(*k* − 1)          |                       | *\< n* ≤*k*(*k* + 1)  |
|                       |                       |                       |
| 2                     |                       |                       |
+-----------------------+-----------------------+-----------------------+

6

Number Theory

Number Theory requires extensive preparation, but the prerequisites are very finite. One usually can use the prerequisites 1 to 19 without proof.
Here all variables stand for integers. The strategies are acquired by **massive problem solving**. At first the problems are far below a hard competitive level. But if you do most of the problems you are fit for any competition.

1. If *b* = *aq* for some *q* ∈ Z, then *a* **divides** *b*, and we write *a*\|*b*.

2. **Fundamental Properties of the Divisibility Relation**

I. *a* \| *b, b* \| *c* ⇒ *a* \| *c.*

II. *d* \| *a, d* \| *b* ⇒ *d* \| *ax* + *by.* Especially *d* \| *a* + *b, d* \| *a* − *b*.

III. If any two terms in *a* + *b* = *c* are divisible by *d*, the third will also be divisible by *d.*

3. **Division with Remainder.** Every integer *a* is uniquely representable by the positive integer *b* in the form

*a* = *bq* + *r,* 0 ≤ *r \< b.*

*q* and *r* are called **quotient** and **remainder** upon division of *a* by *b*.

4. **GCD and Euclidean Algorithm.** Let *a* and *b* be nonnegative integers, not both 0. Their *greatest common divisor* and *least common multiple* will be denoted by gcd(*a, b*) and lcm(*a, b*), respectively. Then

gcd(*a,* 1) = 1*,* gcd(*a, a*) = *a,* gcd(*a,* 0) = *a,* gcd(*a, b*) = gcd(*b, a*)*.*

118 6. Number Theory

*a* and *b* will be called *relatively prime* or *coprime*, if gcd(*a, b*) = 1*.* With

gcd(*a, b*) = gcd(*b, a* − *b*)*,* (4)

we can compute gcd(*a, b*) by subtracting repeatedly the smaller of the two numbers from the larger one. The following example shows this:

gcd(48*,* 30) = gcd(30*,* 18) = gcd(18*,* 12) = gcd(12*,* 6) = gcd(6*,* 6) = 6*.*

The Euclidean algorithm is a speedup of this algorithm, and it is based on

*a* = *bq* + *r* ⇒ gcd(*a, b*) = gcd(*b, r*) = gcd(*b, a* − *bq*)*.* (5)

**Theorem.** *The* gcd(*a, b*) *can be represented by a linear combination of a and b with integral coefficients, that is, there are x, y* ∈ Z*, so that* gcd(*a, b*) =*ax* + *by.*

**Special case:** *If a and b are coprime, then the equation ax* + *by* = 1 *has integral solutions.*

5. gcd(*a, b*) · lcm(*a, b*) = *a* · *b.*

6. A positive integer is called a prime if it has exactly two divisors.

7. **Euclid's Lemma.** *If p is a prime, p* \| *ab* ⇒ *p* \| *a or p*
\| *b.*

8. **Fundamental Theorem of Arithmetic.** *Every positive integer can be* *uniquely represented as a product of primes.*

9. There are infinitely many primes since *p* ̸ \| (*n*! + 1) for any prime *p* ≤ *n*.

10. *n*! + 2, *n*! + 3*, ··· , n*! + *n* are (*n* − 1) consecutive composite integers.

11. The smallest prime factor of a nonprime *n* is ≤ _sqrt_*n*.

12. All primes *p \>* 3 have the form 6*n* ± 1.

13. All pairwise prime triples of integers satisfying *x*2+ *y*2= *z*2are given by

*x* = \|*u*2− *v*2\|*, y* = 2*uv, z* = *u*2+ *v*2*,* gcd(*u, v*) = 1*, u* ̸= *v* mod 2*.*

14. **Congruences.** *a* ≡ *b* mod *m* ⇔ *m* \| *a* − *b* ⇔ *a* − *b* = *qm* ⇔ *a* = *b* + *qm* ⇔ *a* and *b* have the same remainder upon division by *m*. Congruences can be added, subtracted, and multiplied.

Suppose *a* ≡ *b* mod *m* and *c* ≡ *d* mod *m.* Then

*a* ± *c* ≡ *b* ± *d* mod *m,* and *ac* ≡ *bd* mod *m,*

6. Number Theory 119

This has several consequences:

*a* ≡ *b* mod *m* ⇒ *ak*≡ *bk*mod *m* and *a* ≡ *b* mod *m* ⇒ *f* (*a*) ≡ *f* (*b*) mod *m,*

where

*f* (*x*) = *anxn*+ *an*−1*xn*−1+ ... + *a*1*x* + *a*0*,* *ai* ∈
Z*.*

In general we cannot divide, but we have the following **cancellation rule:**

gcd(*c, m*) = 1*, ca* ≡ *cb* mod *m* ⇒ *a* ≡ *b* mod *m.*

15. **Fermat's Little Theorem (1640).** *Let a be a positive integer and p be a* *prime. Then*\ *ap*≡ *a* mod *p.*

The cancellation rule tells us that we can divide by *a* if gcd(*a, p*) = 1, getting\ gcd(*a, p*) = 1 ⇒ *ap*−1≡ 1 mod *p.*

16. Fermat's theorem is the first nontrivial theorem. So we give three proofs.

**First proof by induction.** The theorem is valid for *a* = 1, since *p*\|1*p*− 1. Suppose it is valid for some value of *a*, that is,

*p*\|*ap*− *a.* (6)

We will also show that *p*\|(*a* + 1)*p*− (*a* + 1)*.* Indeed,

*p*−1\ (*a* + 1)*p*− (*a* + 1) = *ap*+==*p* =*ap*−*i*+ 1 − (*a* + 1) (7) *i* *i*=1\ or\ *p*−1\ ==*p* =(*a* + 1)*p*− (*a* + 1) = *ap*− *a* + *ap*−*i.* (8) *i* *i*=1\ Now *p*\|=*p* =for 1 ≤ *i* ≤ *p* − 1. Also since *p*\|*ap*− *a*, we have *p*\|(*a* + 1)*p*−(*a* + 1).

**Second proof with congruences.** We may multiply congruences, that is, from *ci* ≡ *di* mod *p* for *i* = 1*, ··· , n* follows

*c*1 · *c*2 ... · *cn* ≡ *d*1 · *d*2 ... · *cn* mod *p.* (9)

Now, suppose that gcd(*a, p*) = 1*.* We form the sequence

*a,* 2*a,* 3*a, ··· ,* (*p* − 1)*a.* (10)

120 6. Number Theory

No two of its terms are congruent mod *p*, since

*i* · *a* ≡ *k* · *a* (mod *p*) ⇒ *i* ≡ *k* mod *p* ⇒ *i* = *k.*

Hence, each of the numbers in (7) is congruent to exactly one of the numbers

1*,* 2*,* 3*, ··· p* − 1*.* (11)Applying (6) to (7) and (8) gives

*ap*−1· 1 · 2 ... · · (*p* − 1) ≡ 1 · 2 ... · · (*p* − 1) mod *p.*

We may cancel with (*p* − 1)! since (*p* − 1)! and *p* are coprime.
Thus,

*ap*−1≡ 1 mod *p.*

**Thirdproofbycombinatorics.** Wehavepearlswith*a* colors.Fromthesewe make necklaces with exactly *p* pearls. First, we make a string of pearls. There are *ap*different strings. If we throw away the *a* one-colored strings *ap*− *a* strings will remain. We connect the ends of each string to get necklaces. We find that two strings that differ only by a cyclic permutation of its pearls result in indistinguishable necklaces. But there are *p* cyclic permutations of Because of its interpretation this is an integer. So*p* pearls on a string. Hence the number of distinct necklaces is (*ap*− *a*)*/p*.

*p* \| *ap*− *a.*

17. The converse theorem is not valid. The smallest counterexample is 341 \| 2341− 2*,*

where 341=31 · 11 is not a prime. Indeed, we have

2341−2 = 2(2340−1) = 2((210)34−134) = 2(210−1)(...) = 2·3·341·(· ·
·)*.*

18. **The Fermat--Euler Theorem.** Euler's *φ*-function is defined as follows:

*φ*(*m*) = number of elements from {1*,* 2*, ··· , m*}

which are prime to *m.*

gcd(*a, m*) = 1 ⇒ *aφ*(*m*)≡ 1 mod *m.*

19. **The Function Integer Part.** ⌊*x*⌋ = greatest integer ≤ *x* = integer part of *x*. *x* mod 1 = *x* − ⌊*x*⌋ = {*x*} = fractional part of *x*.

\(a\) ⌊*x* +*y*⌋ ≥ ⌊*x*⌋+⌊*y*⌋. We have equality only if *x* mod 1+*y* mod 1 *\<* 1*.*

\(b\) ⌊⌊*x*⌋*/n*⌋ = ⌊*x/n*⌋*.* This is an important special case of the formula⌊(*x* + *m*)*/n*⌋ = ⌊(⌊*x*⌋ + *m*)*/n*⌋*.* Here *m* and *n* are integers.

\(c\) ⌊*x* + 1*/*2⌋ = the integer, which is nearest to *x.* More precisely, *n* ≤ *x \< n* + 1*/*2 ⇒ ⌊*x* + 1*/*2⌋ = *n*, *n* + 1*/*2 ≤
*x \< n* + 1 ⇒ ⌊*x* + 1*/*2⌋ = *n* + 1.

\(d\) The prime *p* divides *n*! with multiplicity *e* =
⌊*n/p*⌋+⌊*n/p*2⌋+⌊*n/p*3⌋+....

6. Number Theory 121

Divisibility

The most useful formula in competitions is the fact that *a*−*b* \|
*an*−*bn*for all *n*, and *a* +*b* \| *an*+*bn*for odd *n.* The second of these is a consequence of the first. Indeed, *an*+*bn*= *an*−(−*b*)*n*forodd*n*,whichisdivisibleby*a*−(−*b*) = *a*+*b.*Inparticular, adifferenceoftwosquarescanalwaysbefactored.Wehave*a*2−*b*2= (*a*−*b*)(*a*+*b*). But a sum of two squares such as *x*2+ *y*2can only be factored if 2*xy* is also a square. Here you must add and subtract 2*xy.* The simplest example is the identity of Sophie Germain:

*a*4+ 4*b*4= *a*4+ 4*a*2*b*2+ 4*b*4− 4*a*2*b*2= (*a*2+ 2*b*2)2− (2*ab*)2

= (*a*2+ 2*b*2+ 2*ab*)(*a*2+ 2*b*2− 2*ab*)*.*

Some difficult Olympiad problems are based on this identity. For instance, in the 1978 K¨urschak Competition, we find the following problem which few students solved.

**E1.** *n \>* 1 ⇒ *n*4+ 4*nis never a prime*.

If *n* is even, then *n*4+ 4*n*is even and larger than 2. Thus it is not a prime. So we need to show the assertion only for odd *n.* But for odd *n* = 2*k* + 1, we can make the following transformation, getting Sophie Germain's identity:

*n*4+ 4*n*= *n*4+ 4 · 42*k*= *n*4+ 4 · (2*k*)4*,*

which has the form *a*4+ 4*b*4. This problem first appeared in the *Mathematics Magazine* 1950. It was proposed by A. Makowski, a leader of the Polish IMO-team.

Quite recently, the following problem was posed in a Russian Olympiad for 8th graders:

**E2.** *Is* 4545+ 5454*a prime?*

Only few saw the solution, although all knew the identity of Sophie Germain and some competitions problems based on it. In fact, it is almost trivial to see that

4545+ 5454= 5454+ 4 · (4138)4*,*

which is the left side of Sophie Germain's identity.

Now, consider the following recent competition problem from the former USSR:

**E3.** *n* ∈ N0 ⇒ *f* (*n*) = 22*n*+ 22*n*−1+ 1 *has at least n different prime factors*. Here, we use the lemma *x*4+*x*2+1 = (*x*2+1)2−*x*2= (*x*2−*x*+1)(*x*2+*x*+1).

With *x* = 22*n*−1, we get

22*n*+1+ 22*n*+ 1 = (22*n*− 22*n*−1+ 1)(22*n*+ 22*n*−1+ 1)*.*

Both right-hand side factors are prime to each other. If they had an odd divisor *q \>* 1*,* then their difference 2 · 22*n*−1= 22*n*−1+1would have the same factor. If we

122 6. Number Theory

already know that 22*n*+ 22*n*−1+ 1 has at least *n* prime factors, then by induction 22*n*+1+ 22*n*+ 1 has at least *n* + 1 prime factors.

*Remarks.* For *n \>* 4, the number has at least *n* + 1 different prime factors, since

224− 223+ 1 = 97 · 673*,* 224+ 223+ 1 = 3 · 7 · 13 · 241*.*

The product of the last two terms is *f* (5)*.* Thus *f* (5) has six factors and *f* (*n*) has at least *n* + 1 factors. The problem also shows that there are infinitely many primes. We can solve the following competition problem with the same paradigm.

**E4.** *Find all primes of the form nn*+ 1*, which are less then* 1019*.*

For *n* = 1 and *n* = 2, we get primes. An odd *n \>* 1 yields an even *nn*+ 1 *\>* 2. So *n* must be even, i.e., *n* = 22*t*(2*k*+1). Since

22*t*+ 1\|22*t*(2*k*+1)+ 1*,*

the exponent of *n* cannot have an odd divisor. Thus *n* = 22*t*, or

*nn*==22*t* =22*t .*

For*t* = 0*,* 1*,* 2weget*nn*+1 = 5*,* 257*,* 1616+1 = 264+1 *\>* 16·10006+1 *\>* 1019. So there are no other primes besides 2, 5, and 257.\ Let us consider some more competition problems.

**E5.** *Can the number A consisting of* 600 *sixes and some zeros be a square?*

**Solution.** If *A* is a square, then it ends in an even number of zeros. By canceling them we get a square 2*B*, *B* consisting of 300 threes and some zeros, with *B* ending in 3. Since *B* is odd, 2*B* cannot be a square. It has only one factor 2.

**E6.** *The equation* 15*x*2− 7*y*2= 9 *has no integer solutions.*

**Solution.** 15*x*2− 7*y*2= 9 ⇒ *y* = 3*y*1 ⇒ 15*x*2− 63*y*2 1= 9 ⇒
5*x*2 − 21*y*2 1=3 ⇒ *x* = 3*x*1 ⇒ 45*x*2 is a contradiction since *y*2 1− 21*y*2 1≡ 0 or 1 mod 3*.*1= 3 ⇒ 15*x*2 1− 7*y*2 1= 1 ⇒ *y*2 1≡
−1 mod 3. This **E7.** *A nine-digit number, in which every digit except zero occurs and which ends in 5, cannot be a square.*

**Solution.** Suppose there is such a nine-digit number *D*, so that *D* = *A*2. *A* =10*a* + 5 ⇒ *A*2= 100*a*2+ 100*a* + 25 = 100*a*(*a* + 1) + 25. Consequences:

\(a\) The next to last digit is 2.

\(b\) The third digit from the right in *D* is one, which can be the final digit in *a*(*a* + 1), that is 0, 2, or 6. See the table below:

6. Number Theory 123

+-----------------------------------+-----------------------------------+
| *a*                               | > 0 1 2 3 4 5 6 7 8 9             |
+===================================+===================================+
|                                   | > 0 2 6 2 0 0 2 6 2 0             |
+-----------------------------------+-----------------------------------+

*a*(*a* + 1) mod 10

But 0 cannot occur, and 2 has already occurred. Hence, the third digit is a 6*.* From *D* = 1000*B* + 625 follows that 125\|*D.* Since *D* = *A*2we have 54\|*D.* Thus the fourth digit from the right in *D* must be 0 or 5*.* But 0 cannot occur, and 5 has already occurred.

**E8.** *There is no polynomial f* (*x*) *with integer coefficients, so that f* (7) = 11, *f* (11) = 13.

**Solution.** Let *f* (*x*) ==*n i*=1*aixi,* *ai* ∈ *Z.* Then *a* − *b* \| *f* (*a*) − *f* (*b*), that is, *f* (11) − *f* (7) is divisible by 11 − 7 = 4*.* But *f* (11) − *f* (7) = 2. Contradiction!

**E9.** *For every positive integer p, we consider the equation*

*x*+ 1*y*= 1*p.* (1)

*We are looking for its solutions* (*x, y*) *in positive integers, with* (*x, y*) *and* (*y, x*) *being considered different. Show that if p is prime, then there are exactly three solutions. Otherwise, there are more then three solutions.*

**Solution.** We have *x \> p*, *y \> p*. Hence, we set *x* = *p* + *q*, *y* = *p* + *r* in (1) and get\ *p* + *r*= 1*p* + *q*+ *p*⇒ *p*2 = *qr.*

1 1\ If *p* is a prime, the only solutions will be (1*, p*2), (*p, p*), (*p*2*,* 1), that is, for (*x, y*), there are the three pairs of solutions (*p*+1*, p*(*p*+1)), (2*p,* 2*p*), (*p*(*p*+1)*, p*+1). If *p* is composite, then there will be obviously more solutions.

**E10.** *I start with any multidigit number a*1 *and generate a sequence a*1*, a*2*, a*3 *··· . that an is infinitely often a composite number.Here an*+1 *comes from an by attaching a digit* ̸= 9*. Then I cannot avoid the fact*

**Solution.** My strategy is to attach digits so as to get only finitely many composite digits. I cannot use 9 at all, and I can use 0*,* 2*,* 4*,* 6*,* 8*,* 5 only finitely often. Of the other digits 1*,* 3*,* 7, I may use 1 and 7 but finitely often because they change the remainder mod 3. Each time I attach 1 or 7 three times I get a number divisible by 3.
So I am forced from a place upward to attach only threes. If at some moment I have a prime *p*, then after attaching at most *p* threes, again I get a multiple of *p.* I know that gcd(10*, p*) = 1. Hence, among 1*,* 11*,* 111*, ··· ,* 111 *···* 11there is at = == =least one multiple of *p.* *p* *Remark.* If I could use 3 and 9, then I could not tell if I could get only primes length 9: 1979339333, 1979339339.from some *n* upwards. For instance, with *a*1 = 1, I get the following primes of

**E11.** *In the sequence* 1*,* 9*,* 7*,* 7*,* 4*,* 7*,* 5*,* 3*,* 9*,* 4*,* 1*, ···, every digit from the fifth on is the sum of the preceding digits mod 10. Does one of the following words ever occur in the sequence.*

+-----------------+-----------------+-----------------+-----------------+
| > 124           | 6. Number      | > *(c) 1977*    | > *(d) 0197?*   |
|                 | Theory          |                 |                 |
+=================+=================+=================+=================+
| *(a) 1234*      |                 |                 | *(b) 3269*      |
+-----------------+-----------------+-----------------+-----------------+

**Solution.** We reduce all digits mod 2 and get 111101111011110 *. .
. .* To the words 1234 and 3269 correspond 1010 and 1001. Both patterns do not occur in the reduced sequence. For (c) we observe that there are only finitely many possible 4-words. Hence, some word *abcd* will repeat for the first time:

1977 *··· abcd ···abcd.*

= == =Four successive digits determine the next digit, but they also determine the preced period p\ ing digit. Hence the sequence can be extended indefinitely in both directions. This extended sequence is purely periodic. In each period of length *p* lies one word 1977. This word is the first one to repeat, if you start with 1977.

This is an important observation. First, we show that the sequence must repeat. Then we show invertibility, which garantees a pure cycle (Fig. 6.1). For (d) we extend the sequence to the left by one term and get 0197.

\(a\) Pure cycle for invertible operation **r** **r** **r** **r** **r** **r** **r** **r** (b) Noninvertible operation **r** **r** **r** **r** **r** **r** **r** **r** **r** **r** **r** Fig. 6.1. The two types of behavior of iterates *x* → *f* (*x*).

*Remark.* Computer experimentation shows that if we start with four odd digits, the period length will be *p* = 1560 = 5 · 312*.* Starting with four even digits, we get period *p* = 312*.* If we start with at least one 5 and only zeros, the period will be *p* = 5*.*

**E12.** *The equation*\ (0)*x*2+ *y*2+ *z*2= 2*xyz*\ *has no integral solutions except x* = *y* = *z* = 0*. Show this.*

highest power of 2, which divides *x, y, z*, then**First Solution.** Let (*x, y, z*) ̸= (0*,* 0*,* 0) be an integral solution. If 2*k, k* ≥ 0 is the

*x* = 2*kx*1*,* *y* = 2*ky*1*,* *z* = 2*kz*1*,* 22*kx*2 1+ 22*ky*2 1+ 22*kz*2 1= 23*k*+1*x*1*y*1*z*1*,* *x*2 1+ *y*2 1+ *z*2 1= 2*k*+1*x*1*y*1*z*1*.* (1)

The right side of (1) is even. Hence, the left side is also even. All three terms on the left cannot be even because of the choice of *k.* Hence, exactly one term is even.

Suppose *x*1 = 2*x*2, while *y*1 and *z*1 are odd. Hence,

*y*2 1+ *z*2 1= 2*k*+2*x*2*y*1*z*1 − 4*x*2 2≡ 0 mod 4*.*

6. Number Theory 125

This contradicts *y*2 1+ *z*2 1≡ 2 mod 4.

**Second Solution: By infinite descent.** On the left side of (0), exactly one term is even or all three terms are even. If exactly one term is even, then the right side is divisible by 4, the left only by 2. Contradiction! Hence all three terms are even: *x* = 2*x*1*, y* = 2*y*1*, z* = 2*z*1 and

+-----------------------------------+-----------------------------------+
| *x*2 1+ *y*2 1+ *z*2 1=           | \(2\)                             |
| 4*x*1*y*1*z*1*.*                  |                                   |
+===================================+===================================+
| > From (2), with the same         | \(3\)                             |
| > reasoning we get *x*1 = 2*x*2*, |                                   |
| > y*1 = 2*y*2*, z*1 = 2*z*2 and   |                                   |
+-----------------------------------+-----------------------------------+
| *x*2 2+ *y*2 2+ *z*2 2=           |                                   |
| 8*x*2*y*2*z*2*.*                  |                                   |
+-----------------------------------+-----------------------------------+

Again, from (3) follows that *x*2*, y*2*, z*2 are even, and so on, that is

*x* = 2*x*1 = 22*x*2 = 23*x*3 = ... = 2*nxn* = ... *, y* = 2*y*1 = 22*y*2 = 23*y*3 = ... = 2*nyn* = ... *, z* = 2*z*1 = 22*z*2 = 23*z*3 = ... = 2*nzn* = ... *,*

that is, if (*x, y, z*) is a solution, then *x, y, z* are divisible by 2*n*for any *n*. This is only possible for *x* = *y* = *z* = 0*.*

infinitely many solutions, as will be shown later.*Remark.* The equation *x*2+ *y*2+ *z*2= *kxyz* has only for *k* = 1 and *k* = 3

**E13.** *Show that f* (*n*) = *n*5+ *n*4+ 1 *is not prime for n \>* 1*.*

**First Solution: By trial, conjecture, and verification.**

+-----------------------------------+-----------------------------------+
| *n*                               | > 1 2 3 4 ... 10                |
+===================================+===================================+
| *f* (*n*)                         | > 3 · 1 7 · 7 13 · 25 21 · 61 · · |
|                                   | > · 111 · 991                     |
+-----------------------------------+-----------------------------------+

(*n*2+*n*+1)(*n*3−*n*+1)= == =\ **Second Solution: Factoring.** We have *f* (1) ̸= 0*, f* (−1) ̸= 0.
Thus, there is no linear factor. We try a quadratic and cubic factor.
Either

*n*5+ *n*4+ 1 = (*n*2+ *an* + 1)(*n*3+ *bn*2+ *cn* + 1)

or\ *n*5+ *n*4+ 1 = (*n*2+ *an* − 1)(*n*3+ *bn*2+ *cn* − 1)*.*

We investigate the first case. By expanding the right side, we get

*n*5+ *n*4+ 1 = *n*5+ (*a* + *b*)*n*4+ (*ab* + *c* + 1)*n*3+ (*ac* + *b* + 1)*n*2+ (*a* + *c*)*n* + 1*.*

Comparing coefficients, we get four equations for *a, b, c*:

*a* + *b* = 1*,* *ab* + *c* + 1 = 0*,* *ac* + *b* + 1 = 0*,* *a* + *c* = 0

with solutions *b* = 0*,* *a* = 1*,* *c* = −1. Thus, *n*5+*n*4+1 = (*n*2+*n*+1)(*n*3−*n* + 1). The second case leads to an inconsistent system of equations.

6. Number Theory 131

A counting argument similar to the one in the preceding example shows, that exactly the triangular numbers are omitted.

Problems

1. *a* − *c* \| *ab* + *cd* ⇒ *a* − *c* \| *ad* + *bc*.

2. *a* ≡ *b* ≡ 1 mod 2 ⇒ *a*2+ *b*2 not a square.

3. (*a*) 6 \| *n*3+ 5*n.* (*b*) 30 \| *n*5− *n.* (*c*) For which *n* is 120 \| *n*5− *n*?4. (a) 3 \| *a,* 3 \| *b* ⇔ 3 \| *a*2+ *b*2. (b) 7
\| *a,* 7 \| *b* ⇔ 7 \| *a*2+ *b*2. (c) 21 \| *a*2+ *b*2⇒ 441 \| *a*2+ *b*2.

5. *n* ≡ 1 mod 2 ⇒ *n*2≡ 1 mod 8 ⇔ 8 \| *n*2− 1.

6. 6 \| *a* + *b* + *c* ⇔ 6 \| *a*3+ *b*3+ *c*3.

7. Derive divisibility criteria for 9 and 11.

8. Let *A* = 3105+ 4105*.* Show that 7 \| *A.* Find *A* mod 11 and *A* mod 13.

9. Show that 3*n* − 1*,* 5*n* ± 2*,* 7*n* − 1*,* 7*n* − 2*,* 7*n* + 3 are not squares.

10. If *n* is not a prime, then 2*n*− 1 is not a prime.

11. If *n* has an odd divisor, then 2*n*+ 1 is not prime.

12. 641 \| 232+ 1*.* No calculator allowed!

13. (a) *n \>* 2 ⇒ 2*n*− 1 is not a power of 3. (b) *n \>* 3 ⇒ 2*n*+ 1 is not a power of 3.14. A number with 3*n*equal digits is divisible by 3*n.*

15. Find all primes *p, q*, so that *p*2− 2*q*2= 1*.*

16. If 2*n* + 1 and 3*n* + 1 are squares, then 5*n* + 3 is not a prime.

17. If *p* is prime, then *p*2≡ 1 mod 24*.*

18. 9 \| *a*2+ *b*2+ *c*2⇒ 9 \| *a*2− *b*2or 9 \| *b*2− *c*2or 9 \|
*a*2− *c*2*.*

19. *n* ≡ 0 mod 2 ⇒ 323 \| 20*n*+ 16*n*− 3*n*− 1.

20. 121 ̸ \| *n*2+ 3*n* + 5.

21. If *p* and *p*2+ 2 are primes, then *p*3+ 2 is also prime.

22. 2*n*̸ \| *n*!*.*

23. How many zeros are at the end of 1000!?

24. Among five integers, there are always three with sum divisible by 3.

25. Using *x*2+ *y*2+ *z*2̸≡ 7 mod 8, find numbers which are not sums of 3 squares.

26. The four-digit number *aabb* is a square. Find it.

27. Can the digital sum of a square be (a) 3, (b) 1977?28. 1000 ...
001 with 1961 zeros is composite (not prime).

29. Let *Q*(*n*) be the digital sum of *n.* Show that *Q*(*n*) = *Q*(2*n*) ⇒ 9 \| *n.*

30. The sum of squares of five successive positive integers is not a square.

31. Let *n* = *pa*1 1*pa*2 2... *pan n*, *pi* be distinct primes.Then *n* has (*a*1+1) ... (*an*+1) divisors.

6. Number Theory 135

120. *a, b, c, d, e* ∈ N are such that *a*4+ *b*4+ *c*4+ *d*4= *e*4.
Show that among the five variables (a) at least three are even, (b) at least three are multiples of 5, (c) at least two are multiples of 10.

121. Show that, if *m* ends with the digit five, then 1991 \| 12*m*+ 9*m*+ 8*m*+ 6*m.*

122. Find all pairs (*x, y*) of nonnegative integers satisfying *x*3+ 8*x*2− 6*x* + 8 = *y*3.

123. Find all integral solutions of *y*2+ *y* = *x*4+ *x*3+ *x*2+ *x.*

124. There are infinitely many pairwise prime integers *x, z, y* such that *x*2*, z*2*, y*2are in arithmetic progression.

125. Each of the positive integers *a*1*, ··· , an* is less than 1951. The least common multiple of any two of these is greater than 1951. Show that

1\ + ... +1 *\<* 2*.a*1 *an*

126. Find the smallest integer of the form \| *f* (*m, n*) \| with (a) *f* (*m, n*) = 36*m*− 5*n.* (b) *f* (*m, n*) = 12*m*− 5*n.*

127. Find infinitely many integral solutions of (*x*2+ *x* + 1)(*y*2+ *y* + 1) = *z*2+ *z* + 1*.*

128. Let *z*2= (*x*2− 1)(*y*2− 1) + *n* for *x, y* ∈ Z*.* Are there solutions for (a) *n* = 1981. (b) *n* = 1985. (c) *n* = 1984 (IMO Jury 1981)?

129. If *a, b,* (*a*2+ *ab* + *c*2)*/*(*ab* + 1) = *q* are integers, then *q* is a perfect square.130. (a) If *a, b,* (*a*2+ *b*2)*/*(*ab* − 1) = *q* are integers, then *q* = 5*.*

\(b\) *a*2+ *b*2− 5*ab* + 5 = 0 has infinitely many solutions in N*.*

131. No prime can be written as a sum of two squares in two different ways.

132. Find infinitely many solutions of

\(a\) *x*2+ *y*2+ *z*2= 3*xyz* (b) *x*2+ *y*2+ *z*2= *xyz.*

133. Two players *A* and *B* alternately take chips from two piles with *a* and *b* chips, respectively. Initially *a \> b*. A move consists in taking from a pile a multiple of the other pile. The winner is the one who takes the last chip in one of the piles. Show that\ (a) If *a \>* 2*b*, then the first player *A* can force a win.

\(b\) For what *α* can *A* force a win, if initially *a \> αb*. (This is the game Euclid, which is due to Cole and Davie. See Math. Gaz.
LIII, 354--7 (1969). and AUO 1978.)

134. If *n* ∈ N and 3*n* + 1 and 4*n* + 1 are perfect squares, then 56\|*n*.

135. Fifty numbers *a*1*, a*2*, ··· , a*50 are written along a circle; each of the numbers is +1 or −1. You want to find the product of these numbers. You may find the product of three consecutive numbers in one question. How many questions do you need at least?

Here is a generalization you can work on: Along a circle are written *n* numbers, each number being +1 or −1. Our aim is to find the product of all *n* numbers. In one question, we can find the product of *k* successive numbers *ai* ... *ai*+*k*−1. Here *an*+1 = *a*1, and so on. How many questions *q*(*n, k*) are necessary to find the product?136. Let *n* ∈ N. If 4*n*+ 2*n*+ 1 is a prime, then *n* is a power of 3.

6. Number Theory 137

156. Several different positive integers lie strictly between two successive squares. Prove that their pairwise products are also different (AUO 1983).

157. Find the integral solutions of 19*x*3− 84*y*2= 1984 (MMO 1984).

158. Start with some positive integers. In one step you may take any two numbers *a*, *b* and replace them by gcd(*a, b*) and lcm(*a, b*).
Prove that, eventually, the numbers will stop changing.

159. The powers 2*n*and 5*n*start with the same digit *d*. What is this digit?160. If *n* = *a*2+ *b*2+ *c*2, then *n*2= *x*2+ *y*2+ *z*2, where *a, b, c, x, y, z* ∈ N.

161. For infinitely many composite *n*, we have *n*\|3*n*−1− 2*n*−1(MMO 1995).

162. The equation *x*2+ *y*2+ *z*2= *x*3+ *y*3+ *z*3has infinitely many integer solutions (MMO 1994).

163. Prove that there exist infinitely many positive integers *n* such that 2*n*ends with *n*, i.e., 2*n*= ... *n* (MMO 1978).

164. There are white and black balls in an urn. If you draw two balls at random, the probability is 1*/*2 to get a mixed couple. What can you conclude about the contents of the urn?

165. A multidigit number contains the digit 0. If you strike it the number becomes 9 times smaller. At which position is this 0 located?
Find all such numbers.

166. If you are condemned to die in Sikinia, you are put into Death Row until the last day of the year. Then all prisoners from Death Row are arranged in a circle and numbered 1*,* 2*, ··· , n.* Starting with #2 every second one is shot until only one remains who is immediately set free. How do you find the place of the sole survivor?

167. (a) Find a number divisible by 2 and 9 which has exactly 14 divisors.\ (b) Replacing 14 by 15 there will be several solutions, replacing 14 by 17 there will be none.

168. The positive integer *k* has the property: for all *m* ∈ N : *k*
\| *m* ⇒ *k* \| *mr*. Here *m* and *mr* are mutual reﬂections like 1234 and 4321. Show that *k* \| 99.

169. Let *p* and *q* be fixed positive integers. The set Z of integers is to be partitioned into three subsets *A*, *B*, *C* such that, for every *n* ∈ Z, the three integers *n*, *n* + *p*, and *n* + *q* belong to different subsets. What relationships must *p* and *q* satisfy?

170. A positive integer is the product of *n* distinct primes. In how many ways can it be represented as the difference of two squares?

Solutions

1. (*ab* + *cd*) − (*ad* + *bc*) = *a*(*b* − *d*) − *c*(*b* − *d*) = (*a* − *c*)(*b* − *d*)*.*

2. An even square is divisible by 4.

3. (a) *n*3+ 5*n* = *n*3− *n* + 6*n* = (*n* − 1)*n*(*n* + 1) + 6*n*.
(b) The three first factors of *n*5− *n* = *n*(*n* − 1)(*n* + 1)(*n*2+ 1) are successive integers. Divisibility by 5 follows from Fermat's theorem. (c) If *n* is odd, *n*5− *n* is divisible by 120.

138 6. Number Theory

4. (a) For any *x*, *x*2≡ 0 mod 3 or *x*2≡ 1 mod 3*.* (b) For any *x*, *x*2≡ 0 or 1 or 4 mod 7*.*\ (c) This follows from (a) and (b).

5. *n* = 2*q* + 1 ⇒ *n*2= 4*q*2+ 4*q* + 1 = 4*q*(*q* + 1) + 1 = 8*r* + 1*. Every odd square is* 1 mod 8*.* This fundamental fact is used very often.

6. (*a*3− *a*) + (*b*3− *b*) + (*c*3− *c*) is divisible by 2 and 3, i.e., 6.

7. 10 ≡ 1 mod 3 *,* 10 ≡ −1 mod 11*, n* ==*n i*=1*di*10*i* ⇒ *n* ≡
=*n i*=1*di* mod 3*, n* ≡8. 7 \| *A* since 105 is odd. 35≡ 1 mod 11, 45≡ 1 mod 11. 3105+ 4105= (35)21+ = *di*(−1)*i* mod 11*.*

(45)21≡ 1 + 1 ≡ 2 mod 11*.*

9. Show it by squaring the remainders of 3, 5, 7 modulo 3, 5, 7, respectively.

10. This follows from *a* − *b* \| *an*− *bn*.

11. This follows from *a* + *b* \| *an*+ *bn*for odd *n.*

12. 641 = 54+ 24= 5 · 27+ 1 divides both 54· 228+ 232and 54· 228− 1*.* Then it also divides their difference 232+ 1*.*

13. (a) Suppose *n \>* 2*.* We want to show that never 2*n*− 1 = 3*m.* For odd *m* we have 2*n*= 3*m*+ 1 = (3 + 1)(3*m*−1+ 3*m*−2+ · ·
· + 1)*.* The last factor is an odd number of odd summands. This is a contradiction.

Next suppose *m* = 2*s* is even. Then 2*n*= 1+32*s*= (9)*s*+1 = 8*q*+2*.* Contradiction, because it is not a multiple of 4*.*

\(b\) Suppose *n \>* 3*.* For odd *m*, we get 2*n*= 3*m*− 1 = (3 − 1)(3*m*−1+ ... + 1). The last factor is an odd number of odd summands. Contradiction!

Nextsuppose*m* = 2*s* iseven.Then3*s*= 2*a*+1*,* 2*n*+1 = (3*s*)2*,* 2*n*= (2*a*+1)2−1 =4*a*(*a* + 1)*.* Here *a* or *a* + 1 is odd. Thus *a* = 1, 2*n*= 32− 1*.* Hence, there is no solution for *n \>* 3*.*

14. Prove it by induction.

15. *p* must be odd. *p* = 3 and *q* = 2 are solutions as well as *p* = 5 and *q* = 3*.* Suppose both *p* and *q* are greater than 3. Then both are ≡ ±1 mod 6*.* Then we have (±1)2− 2(±1)2= 1, −1 ≡ 1 mod 6.
Contradiction.

16. 2*n* + 1 = *a*2*,* 3*n* + 1 = *b*2⇒ 5*n* + 3 = 4(2*n* + 1) − (3*n* + 1) = 4*a*2− *b*2= (2*a* + *b*)(2*a* − *b*). Hence 2*a* − *b* = 1 ⇒ (*b* − 1)2= −2*n*. Thus 2*a* − *b* ̸= 1.

17. For *p \>* 3, we have *p* = 6*n* ± 1, and the theorem is valid for such numbers.

18. *x*2≡ 0*,* 1*,* 4*,* 7*,* mod 9*.* Thus (*a*2*, b*2*, c*2) is (0,0,0), (1,1,7), (1,4,4) or (4,7,7), or permutations of these. Two elements of each of these triples are equal. So their difference is 0.

19. 323 = 17 · 19*.* Prove by congruences divisibility by 17 and 19.

20. We prove: If *n*2+3*n*+5 is divisible by 11 then it is not divisible by 121. *n*2+3*n*+5 ≡*n*2− 8*n* + 16 ≡ (*n* − 4)2mod 11*.* Thus, 11 \| *n*2+ 3*n* + 5 if *n* = 11*k* + 4*.* But then *n*2+ 3*n* + 5 = 121*k*(*k* + 1) + 33*.* This is not divisible by 121. Another solution uses *n*2+ 3*n* + 5 = (*n* − 4)(*n* + 7) + 33.

21. *p* must be odd. *p* = 3 gives *p*2+ 2 = 11, *p*3+ 2 = 29*.* For *p \>* 3, we have *p* = 6*n* ± 1, and *p*2+ 2 is divisible by 3.

140 6. Number Theory

37. gcd(2*a*−1*,* 2*b*−1) = gcd(2*a*−2*b,* 2*b*−1) = gcd\[2*b*(2*a*−*b*−1)*,* 2*b*−1\] = gcd(2*a*−*b*− 1*,* 2*b*− 1)*.* This is one step of Euclid's algorithm on the exponents.

38. If *p* and *q* are primes *\>* 3, then *p* = 6*m* ± 1, and *q* = 6*n* ± 1*.* *p*2− *q*2= (6*m* ± 1)2− (6*n* ± 1)2= 36(*m*2− *n*2) − 12(±*m* ± *n*) = 12(*m* + *n*)(3(*m* − *n*) ± 1)*.* On the right side, either *m* + *n* or 3(*m* − *n*) ± 1 are even. Thus 24 \| *p*2− *q*2*.*

39. *p*, *p* + 10, and *p* + 14 belong to three different residue classes mod 3. So one of is true for the second example.these numbers is divisible by 3. So only *p* = 3 gives the primes 3, 13, 17. The same

40. For *p* = 3, we have 2*p* + 1 = 7 and 4*p* + 1 = 13. For *p \>* 3, one of the three numbers is divisible by 3. This follows if we put *p* = 6*n* ± 1, or even simpler by looking at the numbers mod 3. Then we get *p*, −(*p* − 1) and *p* + 1 which belong to three different residue classes mod 3.

For *p* = 3, we have 8*p*2+1 = 73*.* For *p \>* 3, we have 8*p*2+1 ≡
−(*p*2−1) mod 3. The last number is −(*p* − 1)(*p* + 1) mod 3. Thus we have three different residue classes mod 3. So for *p \>* 3 *p* or (*p* − 1)(*p* + 1) is divisible by 3.

41. This follows from 10(*a* +4*b*)−(10*a* +*b*) = 39*b*, 43(3*x* +7*y*)−3(43*x* +75) = 38*y*, 10(3*a* + 2*b*) − 3(10*a* + *b*) = 17*b.* How do you get these linear combinations systematically?

42. We write *p* in the form *p* = 30*q* + *r* with *r* ∈ {7*,* 11*,* 13*,* 17*,* 19*,* 23*,* 29}*.* Then *p*2≡ *r*2mod 30*.* A simple check with the seven possible values gives the result.

43. *x*2+ *y*2= *x*2*y*2⇔ *x*2*y*2− *x*2− *y*2+ 1 = 1 ⇔ (*x*2− 1)(*y*2− 1) = 1 ⇔ *x* = *y* = 0. Another solution uses parity and infinite descent starting from the fact that both *x* and *y* must be even.

44. (a) *n*5−5*n*3+4*n* = *n*(*n*4−5*n*2+4) = *n*(*n*2−4)(*n*2−1) = (*n*−2)(*n*−1)*n*(*n*+1)(*n*+2)*.* The product of five consecutive integers is divisible by 5!*.*

\(b\) *f* (*n*) = 4*n*+ 15*n* − 1 ≡ 0 mod 3*,* but this is not enough.
We use induction. *f* (0) = 0, so 9 \| *f* (0)*.* Suppose 9 \| *f* (*n*) for any *n*. Then *f* (*n* + 1) = 4 · 4*n*+ 15*n* + 15 − 1 = 3 ·
4*n*+ 4*n*+ 15*n* − 1 + 15 = *f* (*n*) + 3(4*n*+ 5), which is divisible by 9 since 4*n*+ 5 ≡ 0 mod 3*.*

45. These are *m* consecutive integers.

46. If each of *x, y, z* is odd, we have 3 ≡ 1 mod 8*.* If any one of *x, y, z* is odd, we have odd=even. If *x* and *y* are odd and *z* even we have 2 ≡ 1 mod 4*.* If any of *x, y* is odd and the other together with *z* even, we have 1 ≡ 0 mod 4*.* Thus each of *x, y, z* is even. This starts an infinite descent with the only solution *x* = *y* = *z* = 0*.* Another solution is based on (*x*2− 1)(*y*2− 1) = *z*2+ 1*.*

47. (a) *x* + *y* = *xy* ⇒ (*x* − 1)(*y* − 1) = 1*.* Thus *x* = *y* = 2. Solve (b) yourself.

48. (a) This is *x*2≡ −1 mod 3 and has no solution. Solve (b) on your own. (b) Use infinite descent.49. (a) Use infinite descent.

50. Transform the equation into the form (*x* − 1)2+ (*y* − 1)2+ (*x* − *y*)2= 2. It has the solutions (0,0), (1,0), (0,1), (2,1), (1,2), (2,2).

51. *p* − 1 = 6*p*3*p*4 ... *pn* − 1 = 6*P* − 1 is not a square. No solution for *p* + 1.

52. We have proved a similar result by invariance. We could do this in the same way. But here we do it by number theory. One-half of the terms are +1 and one half are

148 6. Number Theory

97. We must find *x* ≡ 79999mod 1000 or 7*x* ≡ 710000mod 1000*.* But *φ*(1000) =1000(1 − 1*/*2)(1 − 1*/*5) = 400, 7400≡ 1 mod 1000*.* Since 10000 = 25 · 400*,* we have 7*x* ≡ 1 mod 1000*.* Thus we have to find the inverse of 7 mod 1000. This can be done in a standard way by solving the equation 7*x* + 1000*y* = 1 with the Euclidean algorithm.
But in this particular case, we use the fact that 1001 = 7 · 11 ·
13*,* which is well known by a high school student since his teacher uses it for many tricks. Now, obviously, 1001 ≡ 1 mod 1000*.* But 1001 = 143·7*.* so 143·7 ≡ 1 mod 1000*.* Thus, *x* = 143.

98. Multiplying by *xyz*, we get *yz*+*xz* = *xy.* Let *x* = *da, y* = *db* with gcd(*a, b*) = 1*.* Then\ *ab*\ *dbz* + *daz* = *d*2*ab* ⇒ (*a* + *b*)*z* = *dab* ⇒ *z* = *d* ·*a* + *b .*

Now gcd(*a, b*) = gcd(*a, a* + *b*) = gcd(*b, a* + *b*) = gcd(*ab, a* + *b*) = 1, that is,

*d* = *k*(*a* + *b*)*,* *z* = *kab,* *x* = *ka*(*a* + *b*)*,* *y* = *kb*(*a* + *b*)*.*

Since gcd(*x, y, z*) = 1, we have *k* = 1, and finally,

*x* = *a*(*a* + *b*) *y* = *b*(*a* + *b*) *z* = *ab.*

Indeed,\ 1\ *b*(*a* + *b*)= 1*a*(*a* + *b*)+ *ab .*

99. Multiplying with *x*2*y*2*z*2, we get (*yz*)2+ (*xz*)2= (*xy*)2*.* Using the formulas in item 13, we get *yz* = *u*2− *v*2, *xz* = 2*uv*, *xy* = *u*2+ *v*2, gcd(*u, v*) = 1, *u* ̸≡ *v* mod 2*.*

With *xyz* = *k*, we get

*kx* = 2*uv*(*u*2+ *v*2)*,* *ky* = (*u*2+ *v*2)(*u*2− *v*2)*,* *kz* = 2*uv*(*u*2− *v*2)*.*

100. Using the hint, we proceed as follows:

(*x*2− *dy*2)(*u*2− *dv*2) = (*x* + *y*_sqrt_*d*)(*x* − *y*_sqrt_*d*)(*u* + *v*_sqrt_*d*)(*u* − *v*_sqrt_*d*) = (*x* + *y* = (*xu* − *dvy* − (*xv* − *yu*)
_sqrt_*d*)(*u* − *v*_sqrt_*d*)(*x* − *y*_sqrt_*d*))(*xu* − *dvy* + (*xv* − *yu*)
_sqrt_*d*)(*u* + *v*_sqrt_*d*) _sqrt_*d*)) = (*xu* − *dvy*)2− *d*(*xv* − *yu*)2*.*

Similarly, we proceed with *x*2+ *dy*2*.* Another approach is via matrices and determinants. The matrix\ =*x* = *yd*\ *y* *x*\ is a matrix with determinant *x*2− *dy*2*.* If we are familiar with multiplication of matrices, then =*x* *yd* = =*u* *v d* = =*xu* + *dyv* *d*(*xv* + *yu*) == *.* *y* *x* *v* *u* *xv* + *uy* *xu* + *dyv*\ If *A, B* are two matrices, then the determinant of the product is the product of determinants, i.e., *det*(*A B*) = *det*(*A*) *det*(*B*)*.* Applying this rule to our matrices, we get (*x*2− *dy*2)(*u*2− *dv*2) = (*xu* + *dyv*)2− *d*(*xv* + *yu*)2*.* Similarly, we proceed with other similar so-called quadratic forms in two variables.

152 6. Number Theory

This number does not exceed 1951. Hence

+---------+---------+---------+---------+---------+---------+---------+
| 1951    | − 1 + · | − 1     |         | \+ · ·  |         | *\< n*  |
|         | · ·     | *\<*    |         | · +1951 |         | + 1951  |
|         | +1951   | 1951    |         |         |         | *\<* 2  |
|         |         | *,*1951 |         |         |         | ·       |
|         |         |         |         |         |         | 1951*,* |
+=========+=========+=========+=========+=========+=========+=========+
| *a*1    |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
|         |         | 1       |         | \+ · ·  |         | > *\<*  |
|         |         |         |         | ·       |         | > 2*.*  |
|         |         |         |         | +1*an*  |         |         |
+---------+---------+---------+---------+---------+---------+---------+
|         |         | *a*1    |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+

This problem was used at the MMO 1951. It is due to Paul Erd¨os. The 2 can be replaced by 6*/*5, but even this is not the best possible bound.

126. (a) The answer is 36 − 52= 11. The last digit of 36*k*= 62*k*is 6, the last digit of 5*m*is 5. Hence \|62*k*− 5*m*\| ends with 1 or 9.
The equation 62*k*− 5*m*= 1 has no solutions since otherwise we would have 5*m*= (6*k*− 1)(6*k*+ 1), but 6*k*+ 1 is not divisible by 5. For *k* = 1*, m* = 2, we get 36*k*− 5*m*= 11.

\(b\) \|*f* (1*,* 1)\| = 7. We prove that \|*f* (*m, n*)\| cannot assume smaller values. It cannot take the values 6*,* 5*,* 3*,* 0 since 12 and 5 are prime to each other. Because 12*m*is even and 5*n*is odd, it cannot take the values 4 and 2. Now we will exclude the value and *f* (*m, n*) = 1 ⇒ 12*m*≡\|*f* (*m, n*)\| = 1. *f* (*m, n*) = 1 ⇒ 5*n*≡ −1 mod 4*,*\ 2 mod 4. This contradicts 12*m*≡ 0 mod 4. Now, suppose *f* (*m, n*) = −1. Then

5*n*≡ 1 mod 3 ⇒ *n* = 2*k* ⇒ 12*m*= (5*k*+ 1)(5*k*− 1)*,* 5*k*≡ 1 mod 4 ⇒ 5*k*+ 1

≡ 2 mod 4. Thus 5*k*+ 1 is only divisible once by 2. From 12*m*= (5*k*+ 1)(5*k*− 1), we conclude that 5*k*+ 1 = 2 · 3*v,* 5*k*− 1 = 22*m*−13*m*−*v*. Only one of 5*k*+ 1 and 5*k*− 1 must contain a factor of 3, since their difference is 2. But *v* = 0 would imply 5*k*+ 1 = 2
⇒ *k* = 0 ⇒ *n* = 0, which is a contradiction, since 0 ̸∈ N. Second case: *v* = *m* ⇒ 5*k*− 1 = 22*m*−1*,* 5*k*+ 1 = 2 · 3*m*. The difference 2 = 2 · 3*m*− 22*m*−1⇒3*m*− 4*m*−1= 1. This is not valid for any positive integer *m*.

127. The identity (*x*2+ *x* + 1)(*x*2− *x* + 1) = *x*4+ *x*2+ 1 gives infinitely many solutions (*n,* −*n, n*2).

128. (a) We have *z*2≡ (*x*2− 1)(*y*2− 1) + 5 mod 8. Since *z*2≡ 0*,* 1*,* 4 mod 8, *x*2− 1 ≡0*,* 3*,* 7 mod 8, (*x*2− 1)(*y*2− 1) ≡ 0*,* 1*,* 5 mod 8, and (*x*2− 1)(*y*2− 1) + 5 ≡2*,* 5*,* 6 mod 8, we have *z*2̸≡ (*x*2− 1)(*y*2− 1) + 5 mod 8.

\(b\) Consider the equation mod 9 : *z*2≡ (*x*2− 1)(*y*2− 1) + 5 mod 9. We have *z*2≡0*,* 4*,* 7 mod 9, *x*2− 1 ≡ 0*,* 3*,* 6*,* 8 mod 9, (*x*2− 1)(*y*2− 1) ≡ 0*,* 1*,* 3*,* 6 mod 9, (*x*2− 1)(*y*2− 1) + 5 ≡
2*,* 5*,* 6*,* 8 mod 9. Thus, *z*2̸≡ (*x*2− 1)(*y*2− 1) + 5 mod 9. (c) *n* = 1984. Simplifying, we get *x*2+ *y*2+ *z*2− *x*2*y*2= 1985. The idea is to find a representation *x*2+ *y*2= 1985. Then *z* = *xy* gives a solution. By looking at the last digits of squares, we quickly get one of the solutions 72+ 442= 1985 and 312+322= 1985bytrialanderror.Thus(*x, y, z*) = (7*,* 44*,* 7·44)and(31*,* 32*,* 31·32) are solutions. (There are infinitely many solutions.)

129. Proceed exactly as in **E15.**

130. Proceed similarly to **E15.**

131. Suppose there is a prime *p* such that *p* = *a*2+ *b*2= *c*2+ *d*2with *a \> b, c \>* *d, a* ̸= *c.* We assume that *a \> c.* Then *p*2= *a*2*c*2+ *b*2*d*2+ *a*2*d*2+ *b*2*c*2has two representations

*p*2= (*ac* + *bd*)2+ (*ad* − *bc*)2= (*ad* + *bc*)2+ (*ac* − *bd*)2*.*

158 6. Number Theory

153. Adding *Sn,k* = 1*k*+ 2*k*+ ... *nk*and *Sn,k* = *nk*+ (*n* − 1)*k*+ ... + 1*k*, we get

2*Sn,k* = (1*k*+ *nk*) +=2*k*+ (*n* − 1)*k*=+ ... + (*nk*+ 1*k*)*.*

Since *k* is odd, we have (*n* + 1)\|2*Sn,k*. To prove that *n*\|2*Sn,k*, we may ignore the last term in *Sn,k* and add 1*k*+ · ·
· (*n* − 1)*k*to (*n* − 1)*k*+ ... 1*k*. We get *n*\|2*Sn,k*, and since gcd(*n, n* + 1) = 1, we conclude that *n*(*n* + 1)\|2*Sn,k*.

154. No! The sequence *nk* becomes constant starting with some index *p*, so that *np* =*np*+1 = .... Indeed, we have *nk* ≤ *nk*+1 ≤
*nk* + 9*c*(*nk*)for all *k*, where *c*(*nk*) is the number of digits of *nk*. Suppose that the sequence *nk* is not bounded for some choice of *n*1. We choose a positive integer *N*, such that 10*N> n*1 and 9*N\<* 10*N*−1. Such a choice is always possible. The unboundedness of *nk* implies that *nk \>* 10*N*from some number *k* on. Hence among the numbers *nk \<* 10*N*, there is a largest, say *np*.

But then

10*N*≤ *np*+1 ≤ *np* + 9*c*(*np*)*\<* 10*N*+ 9*N\<* 10*N*+ 10*N*−1*.*

This means that *np*+1 starts with 10, and *P*(*np*+1) = 0. Thus *nk* = *np*+1 for all *k* ≥ *p* + 1. This contradicts the unboundedness of the sequence *nk*. In other words, starting with any *n*1, the sequence *nk* does not change from some number *k* on.

155. (a) *Answer*: 1962 + *D*(1962) = 1980. How to guess this will be seen from (b). (b) If *n* ends with 9, then *En*+1 *\< En*, if not, *En*+1 = *En* +2. For any positive integer *m \>* 2, we choose the largest *N*, for which *EN \< m*. Then *EN*+1 ≥ *m*, and the last digit of *N* is not 9. Thus either *EN*+1 = *m* or *EN*+1 = *m* + 1.

156. Let *n*2*\< a \< b \< c \< d \<* (*n* + 1)2, *ad* = *bc*. Then

*d* − *a \<* 2*n.* (1)

Our aim is to produce a contradiction to (1). From *ad* = *bc*, we conclude that *a* \[(*a* + *d*) − (*b* + *c*)\] = (*a* − *b*)(*a* − *c*) *\>* 0. Hence,

*a* + *d \> b* + *c.*

Now (*a* + *d*)2− (*d* − *a*)2= 4*ad* = 4*bc \<* (*b* + *c*)2. We conclude that

(*d* − *a*)2*\>* (*a* + *d*)2− (*b* + *c*)2= (*a* + *d* + *b* + *c*)(*a* + *d* − *b* − *c*)*.*

Each term of the first factor on the RHS is larger than *n*2, and the second is ≥ 1. Thus we have *d* − *a \>* 2*n*, which contradicts (1).

157. Write the equation in the form 19(*x*3−100) = 84(*y*2+1). The right side is a multiple of 7, hence also the left side, i.e., *x*3− 2
≡ 0 mod 7. But *x*3̸≡ 2 mod 7.

158. Since *a* · *b* = gcd(*a, b*) · lcm(*a, b*) and *a* + *b* ≤
gcd(*a, b*) + lcm(*a, b*), the product of all the numbers is invariant while the sum increases or does not change. This is an invariance problem using number theory.

159. Suppose 2*n*and 5*n*begin with the digit *d* and have *r* +1 and *s* +1 digits, respectively. Then, for *n \>* 3, we have *d* ·10*r\<* 2*n\<* (*d* +1)·10*r*and *d* ·10*s\<* 5*n\<* (*d* +1)·10*s*.
Multiplying these inequalities, we get *d*2· 10*r*+*s\<* 10*n\<* (*d* + 1)2· 10*r*+*s*or *d*2*\<* 10*n*−*r*−*s\<* (*d* + 1)2. From 1 ≤ *d* and *d* + 1 ≤ 10, we get *n* − *r* − *s* = 1, i.e., *d*2*\<* 10 and (*d* + 1)2*\>* 10*.* This implies *d* = 3. The smallest example is 25= 32 and 55= 3125.

+---------+---------+---------+---------+---------+---------+---------+
| > We    |         |         |         |         | > 7.   | 169     |
| > in    |         |         |         |         | > Inequ |         |
| troduce |         |         |         |         | alities |         |
| > a new |         |         |         |         |         |         |
| > n     |         |         |         |         |         |         |
| otation |         |         |         |         |         |         |
| > for   |         |         |         |         |         |         |
| > the   |         |         |         |         |         |         |
| >       |         |         |         |         |         |         |
|  scalar |         |         |         |         |         |         |
| > p     |         |         |         |         |         |         |
| roduct: |         |         |         |         |         |         |
+=========+=========+=========+=========+=========+=========+=========+
| =*a*1   |         |         | *a*2    | *a*3    | =       | =       |
|         |         |         |         |         |         | *       |
|         |         |         |         |         |         | a*1*b*1 |
|         |         |         |         |         |         | +       |
|         |         |         |         |         |         | *       |
|         |         |         |         |         |         | a*2*b*2 |
|         |         |         |         |         |         | +       |
|         |         |         |         |         |         | *a*3    |
|         |         |         |         |         |         | *b*3*.* |
+---------+---------+---------+---------+---------+---------+---------+
|         |         |         | *b*2    |         |         | *b*3    |
+---------+---------+---------+---------+---------+---------+---------+

**E15.** Then

= *a* = = *a* = *b* *c* *b* *c a*3+ *b*3+ *c*3= *a*2 *b*2 *c*2 ≥ *c*2 *a*2 *b*2 = *a*2*b* + *b*2*c* + *c*2*a.*

**E16.** For any positive *a, b, c*, the two sequences (*a, b, c*) and (1*/*(*b* + *c*)*,* 1*/*(*c* + *a*)*,* 1*/*(*a* + *b*)) are sorted the same way. Thus, we have\ ⎡ *a* *b* *c* ⎤ ⎡ *a* *b* *c* ⎤⎦ ≥ ⎦ *,* 1 1 1 1 1 1 ⎣*b* + *cc* + *a* *a* + *b* ⎣*c* + *a* *a* + *bb* + *c*\ ⎡ *a* *b* *c* ⎤ ⎡ *a* *b* *c* ⎤⎦ ≥ ⎦ *.* 1 1 1 1 1 1 ⎣*b* + *cc* + *a* *a* + *b* ⎣*a* + *bb* + *cc* + *a*\ Adding the two inequalities, we get

+-------------+-------------+-------------+-------------+-------------+
| 2           | =           | *a*         | *b*         | *c*         |
|             |             |             |             |             |
|             |             | *b* + *c*+  | *c* + *a*+  |             |
+=============+=============+=============+=============+=============+
|             |             |             |             | *a* + *b*   |
+-------------+-------------+-------------+-------------+-------------+

which again is Nesbitt's inequality E7.

=≥ 3*,*

**E17.** *Let ai \>* 0*, i* = 1*, .., n and s* = *a*1 + ... + *an.
Prove the inequality* *a*1 *a*2 *an* *n*\ *s* − *a*1 + *s* − *a*2 + ... + *s* − *an*≥*n* − 1*.*

Obviously, the sequences *a*1*,* ... *, an* and 1*/*(*s* − *a*1)*,* ... *,* 1*/*(*s* − *an*) are sorted the same way. Therefore,\ ... 1⎡ *a*1 *an* ⎤ ⎡ *a*1 *a*2 *an* ⎤1 ... 1 1 1\ *s* − *a*1 *s* − *an* *s* − *ak* *s* − *ak*+1 *s* − *ak*−1⎢⎣ ⎥⎦ ≥⎢⎣ ⎥⎦
*,* (*k* = 2*,* 3*, ··· , n*)*.*Adding these (*n* − 1) inequalities gives the result.

**E18.** *Find the minimum of* sin3*x/* cos *x* + cos3*x/* sin *x*, 0 *\< x \< π/*2.\ The sequences (sin3*x,* cos3*x*) and (1*/* sin *x,* 1*/* cos *x*) are oppositely sorted.

Thus,\ ⎡⎣sin3 *x* ⎤ ⎡⎣sin3 *x* ⎤cos3*x* cos3*x* ⎦ ≥ ⎦ = sin2*x* + cos2*x* = 1*.* 1 1 1 1 cos *x* sin *x* sin *x* cos *x*

![](media/image9.png){width="1.0555555555555556in"
height="1.0416666666666667in"}

176 7. Inequalities

where

<table style="width:100%;">
<colgroup>
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 10%" />
</colgroup>
<thead>
<tr class="header">
<th rowspan="2"><em>Cn</em> =</th>
<th>1</th>
<th rowspan="2">+</th>
<th>1</th>
<th rowspan="2">+ ... +</th>
<th>1</th>
<th rowspan="2">=</th>
<th rowspan="2"><p><em>t</em></p>
<p><em>t</em>2+ 1+</p></th>
<th rowspan="2"><blockquote>
<p><em>t</em></p>
</blockquote>
<p><em>t</em>2+ 22 + ... +</p></th>
<th rowspan="2"><p><em>t</em></p>
<p><em>t</em>2+ <em>n</em>2 <em>.</em></p></th>
</tr>
<tr class="odd">
<th><em>t</em> +1</th>
<th><em>t</em> +22</th>
<th><em>t</em> +<em>n</em>2</th>
</tr>
</thead>
<tbody>
</tbody>
</table>

In Fig. 7.4, we have

+-------------+-------------+-------------+-------------+-------------+
| > 2=        |             | _sqrt_           | *t*2+ *n*2· | \(2\)       |
| > 12        |             |             | sin *αn,*   |             |
| \|*OMn*−1\| |             |             |             |             |
| > ·         |             |             |             |             |
| > \|*OMn*\| |             |             |             |             |
| > · sin     |             |             |             |             |
| > *αn* =    |             |             |             |             |
| > 1=*t*2+   |             |             |             |             |
| > (*n* −    |             |             |             |             |
| > 1)2·*t* 2 |             |             |             |             |
| > sin *αn*  |             |             |             |             |
| > =_sqrt_ *t*    |             |             |             |             |
| > *t*       |             |             |             |             |
| > *         |             |             |             |             |
| t*2+(*n*−1) |             |             |             |             |
| 2_sqrt_*t*2+*n*2 |             |             |             |             |
| > *\>       |             |             |             |             |
| > t*2+*n*2  |             |             |             |             |
| > *,*       |             |             |             |             |
+=============+=============+=============+=============+=============+
| > *t*2+*n*2 |             |             |             |             |
| > *\<* sin  |             |             |             |             |
| > *αn \<    |             |             |             |             |
| > αn,*\     |             |             |             |             |
| > *t*\      |             |             |             |             |
| > *Cn*      |             |             |             |             |
| > =*t*2+1+  |             |             |             |             |
| > ... +   |             |             |             |             |
| > *t*2+*n*2 |             |             |             |             |
| > *\< α*1 + |             |             |             |             |
| > ... +   |             |             |             |             |
| > *αn \<    |             |             |             |             |
| > π*2*,*\   |             |             |             |             |
| > (*a*1 + · |             |             |             |             |
| > · · +     |             |             |             |             |
| > *an*)     |             |             |             |             |
| 2*\<π*=*tP* |             |             |             |             |
| > +*Q*=     |             |             |             |             |
| > *.*We set |             |             |             |             |
| > *t* =     |             |             |             |             |
| > _sqrt_*Q/P*    |             |             |             |             |
| > and get   |             |             |             |             |
| > *tP* +    |             |             |             |             |
| > *Q/t* =   |             |             |             |             |
| > 2_sqrt_*PQ*.   |             |             |             |             |
| > Thus,\    |             |             |             |             |
| > (*a*1 +   |             |             |             |             |
| > *a*2 + ·  |             |             |             |             |
| > · · +     |             |             |             |             |
| > *an*)2*\< |             |             |             |             |
| > π*_sqrt_*PQ,*\ |             |             |             |             |
| > (*a*1 + · |             |             |             |             |
| > · · +     |             |             |             |             |
| > *an*)4*\< |             |             |             |             |
| > π*2 = = = |             |             |             |             |
| > = *a*2 1+ |             |             |             |             |
| > ... +   |             |             |             |             |
| > *a*2 *a*2 |             |             |             |             |
| > 1+ 22*a*2 |             |             |             |             |
| > 2+ ...  |             |             |             |             |
| > +         |             |             |             |             |
| > *n*2*a*2  |             |             |             |             |
| > *.* This  |             |             |             |             |
| > is the    |             |             |             |             |
| > second of |             |             |             |             |
| > several   |             |             |             |             |
| > Carlson   |             |             |             |             |
| > in        |             |             |             |             |
| equalities, |             |             |             |             |
| > each      |             |             |             |             |
| > odder     |             |             |             |             |
| > than the  |             |             |             |             |
| > other.    |             |             |             |             |
+-------------+-------------+-------------+-------------+-------------+
| > ==\       |             | > 1*Mn*\    |             |             |
| > = = ## \# |             | > *Mn*−1    |             |             |
| > \"\       |             |             |             |             |
| > \"\       |             |             |             |             |
| "\"\"\"\"\" |             |             |             |             |
| > ! !!!!!!! |             |             |             |             |
| > =*α*3     |             |             |             |             |
| > *α*2 *O*  |             |             |             |             |
| > = *α*1\   |             |             |             |             |
| > *t*       |             |             |             |             |
+-------------+-------------+-------------+-------------+-------------+
|             |             | > 1\        |             |             |
|             |             | > 1\        |             |             |
|             |             | > 1         |             |             |
|             |             | >           |             |             |
|             |             | > *M*2\     |             |             |
|             |             | > *M*1\     |             |             |
|             |             | > *M*0      |             |             |
+-------------+-------------+-------------+-------------+-------------+
| > Fig. 7.4. |             |             |             |             |
| > *MiMi*+1  |             |             |             |             |
| > =         |             |             |             |             |
| > 1**Three  |             |             |             |             |
| > Problems  |             |             |             |             |
| > on        |             |             |             |             |
| >           |             |             |             |             |
| Convexity** |             |             |             |             |
+-------------+-------------+-------------+-------------+-------------+

**E24.** Consider the following problem of the US Olympiad 1980:

+-----------------------+-----------------------+-----------------------+
| 1 ≥ *a, b, c* ≥ 0 ⇒   | *a*                   | > *b* *c*\            |
|                       |                       | > *c* + *a* + 1+ *a*  |
|                       | *b* + *c* + 1+        | > + *b* +             |
|                       |                       | > 1+                  |
|                       |                       | (1−*a*)(1−*b*)(1−*c*) |
|                       |                       | > ≤ 1*.*              |
+=======================+=======================+=======================+ +-----------------------+-----------------------+-----------------------+

A manipulative solution requires enormous skills, but there is a solution without any manipulation. Denote the left side of the inequality by *f* (*a, b, c*). This function is defined on a closed convex cube, and *f* (*a, b, c*) is strictly convex in each variable since the second derivative in each variable is strictly positive.
Hence, *f* assumes its maximum 1 at the *extremal points*, that is, the 8 vertices (0*,* 0*,* 0)*, ··· ,* (1*,* 1*,* 1). They are the only points of the closed cube, which are not midpoints of two other pointsofthecube.ThisproofwouldbeacceptedattheIMOifonecitesthe*Theorem of Weierstraß* that a continuous function on a bounded and closed domain assumes its maximum and minimum.

7. Inequalities 177

Consider the following problem of the Allunion Olympiad 1982 in Odessa:

**E25.** *The vertices of the tetrahedron KLMN lie inside, on the edges, or faces of another tetrahedron ABCD. Prove that the sum of the lengths of all edges of KLMN are less then* 4*/*3 *of the sum of the edges of ABCD*.

This problem is probably even more difficult than the preceding one.
Only four students solved it, two with high school mathematics, and two with college geometry. We consider the college level solution, which is quite simple. *ABCD* is a convex, bounded, and closed domain.
*K, L, M, N* ∈ *ABCD*. The function *f* (*K, L, M, N*) = \|*K* −*L*\|+\|*K* −*M*\|+ \|*K* −*N*\|+\|*L*−*M*\|+\|*L*−*N*\|+\|*M* −*N*\|
is continuous in its domain. Because of the strict convexity of *f* , it follows that it assumes its maximum at the vertices. Thus we have a finite problem. The strict convexity of *f* follows from the strict convexity of the distance function. This is an immediate consequence of the triangle inequality. The inequality cannot be improved, because for *B* = *C* = *A, D* ̸= *A, K* = *L* = *A, M* = *N* =*D*, we have equality. In the vicinity of this degenerated tetrahedron, we have nondegenerated tetrahedra with the sum of edges of *KLMN* as near to 4*/*3 of the sum of the edges of *ABCD* as we please.

The high school methods were based on the ingenious use of the triangle inequality.

**E26.** *A finite set P of n points* (*n* ≥ 2) *is given in the plane.
For any line l, denote by S*(*l*) *the sum of the distances from the points of P to the line l. Consider the set L of the lines l such that S*(*l*) *has the least possible value. Prove that there exists a line of L, passing through two points of P.*

We observe that some line in *L* passes through a point of *P*.
Indeed, displacing a line parallel to itself, we can reach a point in *P* without increasing *S*(*l*). Choose a line *l* ∈ *L* passing through a point *A* of *P*, and rotate *l* about *A*. Let *φ* be the angle of rotation, and let *φk, k* = 1*,* 2*, ··· , n* be the values of *φ* for which *l* passes through a point *Ak* of *P* (*Ak* ̸= *A*).
Let *ak* = \|*AkA*\|. Then the sum of the distances, when *l* is rotated through *φ*, is

*S*(*φ*) =

+-----------------------------------+-----------------------------------+
| > *n*−1=                          | > *ak*\| sin(*φ* − *φk*)\|*.*     |
+===================================+===================================+ +-----------------------------------+-----------------------------------+

The function *S*(*φ*) is a sum of concave functions whenever *φ* is restricted to an interval \[*φk, φk*+1\]. Hence, *S*(*φ*) is concave (as a sum of concave functions) in each such interval. Thus, *S*(*φ*) cannot attain its minimum at an internal point of \[*φk, φk*+1\]. Hence, it assumes its minimum for some *φk*.

**E27. Trigonometric Substitution.** *Prove that, for positive reals,*
_sqrt_ _sqrt_ *ab* + *cd* ≤=(*a* + *d*)(*b* + *c*)*.*

7. Inequalities 181

20. Prove that, for real numbers *x, y, z*

\|*x*\| + \|*y*\| + \|*z*\| ≤ \|*x* + *y* − *z*\| + \|*x* − *y* + *z*\| + \| − *x* + *y* + *z*\|*.*

21. If *a, b, c \>* 0, then *a*(1 − *b*) *\>* 1*/*4*, b*(1 − *c*) *\>* 1*/*4*, c*(1 − *a*) *\>* 1*/*4 cannot be valid simultaneously.

22. If *a, b, c, d \>* 0, then at least one of the following inequalities is wrong: *a* + *b \< c* + *d,* (*a* + *b*)(*c* + *d*) *\< ab* + *cd,* (*a* + *b*)*cd \< ab*(*c* + *d*)*.*

23. The product of three positive reals is 1. Their sum is greater than the sum of their reciprocals. Prove that exactly one of these numbers is *\>* 1.

24. Let *x*1 = 1, *xn*+1 = 1 + *n/xn* for *n* ≥ 1. Show that_sqrt_*n* ≤
*xn* ≤ _sqrt_*n* + 1*.*

25. If *a*, *b*, and *c* are sides of a triangle, then

+-----------------+-----------------+-----------------+-----------------+
| > 3\            | *a*             | *b*             | > *c*           |
| > 2≤            |                 |                 | >               |
|                 | *b* + *c*+      | *c* + *a*+      | > *a* + *b \<*  |
|                 |                 |                 | > 2*.*          |
+=================+=================+=================+=================+ +-----------------+-----------------+-----------------+-----------------+

26. If *a*, *b*, *c* are sides of a triangle with *γ* = 90◦, then

*cn> an*+ *bn* for *n* ∈ N*, n \>* 2*.*

27. If *x, y, z* are sides of a triangle, then \|*x/y* + *y/z* + *z/x* − *y/x* − *z/y* − *x/z*\| *\<* 1. Can you replace 1 by a smaller number?

28. A point is chosen on each side of a unit square. The four points are sides of a quadrilateral with sides *a*, *b*, *c*, *d*. Show that

<table style="width:100%;">
<colgroup>
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 10%" />
</colgroup>
<thead>
<tr class="header">
<th>2 ≤ <em>a</em>2+ <em>b</em>2+ <em>c</em>2+ <em>d</em>2≤ 4</th>
<th colspan="2">and</th>
<th colspan="5">2_sqrt_2 ≤ <em>a</em> + <em>b</em> + <em>c</em> + <em>d</em> ≤ 4<em>.</em></th>
<th rowspan="5">=2</th>
<th rowspan="5"><blockquote>
<p><em>.</em></p>
</blockquote></th>
</tr>
<tr class="odd">
<th colspan="8"><blockquote>
<p>29. Let <em>ai</em> ≥ 1 for <em>i</em> = 1<em>, ··· , n</em>. Show that</p>
</blockquote></th>
</tr>
<tr class="header">
<th colspan="2">(1 + <em>a</em>1)(1 + <em>a</em>2) ... (1 + <em>an</em>) ≥</th>
<th colspan="6"><blockquote>
<p>2<em>n</em></p>
</blockquote>
<p><em>n</em> + 1(1 + <em>a</em>1 + <em>a</em>2 + ... + <em>an</em>)<em>.</em></p></th>
</tr>
<tr class="odd">
<th colspan="8"><p>30. Let 0 <em>&lt; a</em> ≤ <em>b</em> ≤ <em>c</em> ≤ <em>d</em>. Then <em>abbccdda</em>≥ <em>bacbdcad.</em></p>
<p>31. If <em>a, b &gt;</em> 0 and <em>m</em> is an integer, then (1 + <em>a/b</em>)<em>m</em>+ (1 + <em>b/a</em>)<em>m</em>≥ 2<em>m</em>+1<em>.</em></p></th>
</tr>
<tr class="header">
<th colspan="4">32. Let 0 <em>&lt; p</em> ≤ <em>a, b, c, d, e</em> ≤ <em>q</em>. Show that<br />
(<em>a</em> + <em>b</em> + <em>c</em> + <em>d</em> + <em>e</em>)= 1<em>a</em>+ 1<em>b</em>+ 1<em>c</em>+ 1<em>d</em>+ 1</th>
<th>=</th>
<th>≤ 25 + 6</th>
<th>==<em>pq</em>−</th>
<th>= <em>qp</em></th>
</tr>
</thead>
<tbody>
</tbody>
</table>

This is a problem of the US Olympiad 1977. It is a special case of a general theorem. Also, prove this more general theorem.

33. The diagonals of a convex quadrilateral intersect in *O*. What is the smallest area this quadrilateral can have, if the triangles *AOB* and *COD* have areas 4 and 9, respectively?

34. Let *x, y \>* 0, and let *s* be the smallest of the numbers *x*, *y* + 1*/x*, 1*/y*. Find the greatest possible value of *s*. For which *x, y* is this value assumed?

8

The Induction Principle

The *Induction Principle* is of great importance in discrete mathematics: Number Theory, Graph Theory, Enumerative Combinatorics, Combinatorial Geometry, and other subjects. Usually one proves the validity of a relationship *f* (*n*) = *g*(*n*) if one has a guess from small values of *n*. Then one checks that *f* (1) = *g*(1), and, by making the assumption *f* (*n*) = *g*(*n*) for some *n*, one proves that also *f* (*n* + 1) = *g*(*n* + 1). From this one concludes by the Induction Principle that *f* (*n*) = *g*(*n*) for all *n* ∈ N. There are many variations of this principle. The relationship *f* (*n*) = *g*(*n*) is valid for 0 already, or, starting from some *n*0 *\>* 1. The inductive assumption is often *f* (*k*) = *g*(*k*) for *all k \< n*, and, from this assumption, one proves the validity of *f* (*n*) = *g*(*n*). We assume familiarity with all this and apply induction in unusual circumstances to make nontrivial proofs. We refer to Polya
\[22\] to \[24\] for excellent treatment of induction for beginners. The reader can acquire practice by proving some of the innumerable formulas for the Fibonacci sequence defined by *F*0 = 0*, F*1 = 1*, Fn*+2 = *Fn*+1 + *Fn*, *n* ≥ 0*.* We state some of these.

<table>
<colgroup>
<col style="width: 9%" />
<col style="width: 9%" />
<col style="width: 9%" />
<col style="width: 9%" />
<col style="width: 9%" />
<col style="width: 9%" />
<col style="width: 9%" />
<col style="width: 9%" />
<col style="width: 9%" />
<col style="width: 9%" />
<col style="width: 9%" />
</colgroup>
<thead>
<tr class="header">
<th colspan="7"><blockquote>
<p>1. Binet’s formula <em>Fn</em> = (<em>αn</em>− <em>βn</em>)<em>/</em>_sqrt_5<em>, α</em> = (1 +</p>
</blockquote></th>
<th colspan="2">_sqrt_5)<em>/</em>2<em>, β</em> = (1 −</th>
<th rowspan="4">_sqrt_</th>
<th rowspan="4">5)<em>/</em>2<em>.</em></th>
</tr>
<tr class="odd">
<th><blockquote>
<p>2. <em>Fn</em> ==<em>n</em>−1 =+=<em>n</em>−2 =+3.=<em>n i</em>=1<em>F</em> 2 <em>i</em>= <em>FnFn</em>+1.4. Prove</p>
</blockquote></th>
<th>=<em>n</em>−3 =</th>
<th colspan="7"><blockquote>
<p>+ ... <em>.</em></p>
</blockquote></th>
</tr>
<tr class="header">
<th colspan="2" rowspan="2">=1</th>
<th>1</th>
<th rowspan="2">=<em>n</em></th>
<th rowspan="2">=</th>
<th rowspan="2">=<em>Fn</em>+1</th>
<th><em>Fn</em></th>
<th rowspan="2">=</th>
<th rowspan="2"><blockquote>
<p><em>.</em></p>
</blockquote></th>
</tr>
<tr class="odd">
<th>0</th>
<th><em>Fn</em>−1</th>
</tr>
</thead>
<tbody>
</tbody>
</table>

8. The Induction Principle 209

29. Prove **Zeckendorf's theorem**: *Any positive integer N can be expressed uniquely as* *a sum of distinct Fibonacci numbers containing no neighbors:*

*N* =

+-----------------------+-----------------------+-----------------------+
| > *m*\                | > *Fij* +1*,*         | > \|*ij* − *ij*−1\| ≥ |
| > =                   |                       | > 2*.*                |
+=======================+=======================+=======================+ +-----------------------+-----------------------+-----------------------+

Here *F*1 = 1*, F*2 = 2*, Fn*+2 = *Fn*+1 + *Fn, n* ≥ 1. Indeed, 1 = *F*1 = 1, 2 = *F*2 =10, 3 = *F*3 = 100, 4 = *F*3 + *F*1 = 101, 5 = *F*4 = 1000, 6 = *F*4 + *F*1 = 1001, 7 =*F*4 + *F*2 = 1010, 8 = *F*5 = 10000, 9 = *F*5 + *F*1 = 10001, 10 = *F*5 + *F*2 = 10010, 11 = *F*5 + *F*3 = 10100, 12 = *F*5 + *F*3 + *F*1 = 10101*, ···*.

30. A knight is located at the (black) origin of an infinite chessboard. How many squares can it reach after exactly *n* moves?

31. (a) Consider any convex region in the plane crossed by *l* lines with *p* interior points of intersection. Find a simple relationship between *l*, *p*, and the number *r* of disjoint regions created.

\(b\) Place *n* distinct points on the circumference of a circle, and draw all possible chords through pairs of these points. Assume that no three chords are concurrent. Let *an* be the number of regions. Find *a*1*, a*2*, a*3*, a*4*, a*5 by drawing figures. Guess *an*, and check your guess by finding *a*6. Now find *an* by using the result in (a).

32. An infinite chessboard has the shape of the first quadrant. Is it possible to write a positive integer into each square, such that each row and each column contains each positive integer exactly once (TT 1988)?

33. Find the sum of all fractions 1*/xy*, such that gcd(*x, y*) = 1, *x* ≤ *n*, *y* ≤ *n*, *x*+*y \> n*.

34. Find a closed formula for the sequence *an* defined as follows:

*a*1 = 1*,* *an*+1 =1=1 + 4*an* +=1 + 24*an*= *.* 16\ 35. Prove that if *n* points are not all collinear, then at least *n* of the lines joining them are different.

36. The positive integers *x*1*, ··· , xn* and *y*1*, ··· , ym* are given. The sums *x*1 + ... + *xn* and *y*1 + ... + *ym* are equal and less than *mn*. Prove that one may cross out some of the terms in the equality *x*1 + ... + *xn* = *y*1 + ... + *ym*, so that one again gets an equality.

37. All numbers of the form 1007, 10017, 10117, *···* are divisible by 53.38. All numbers of the form 12008, 120308, 1203308, *···* are divisible by 19.

39. Let *x*1, *x*2 be the roots of the equation *x*2+*px* −1 = 0, *p* odd, and set *yn* = *xn* 1+*xn* 2, *n* ≥ 0. Then *yn* and *yn*+1 are coprime integers.

Solutions

1. We will prove the contrapositive statement: A graph with 2*n* points and no triangle has at most *n*2edges.

The theorem is obviously true for *n* = 1. Suppose the theorem is true for a graph with 2*n* points. We will prove it for 2*n* + 2 points.

8. The Induction Principle 213

\(d\) We denote the three colors in (c) by 1, 2, and 3. Orient the sides of the triangles with anticlockwise orientation *white*.1 → 2 → 3 → 1. Color the triangles with clockwise orientation *black* and those

11. We derive a recursion for *an* as follows. A word starting with 0 can be continued in *an*−1 ways. A word starting with 100 has *an*−3 continuations. A word starting with 1100 can be continued in *an*−4 ways.

+-----------------------+-----------------------+-----------------------+
| *n*                   | *Fn*                  | *an*                  |
+=======================+=======================+=======================+
| > 1\                  | > 1\                  | > 2 = 2 · 1 4 = 2 · 2 |
| > 2\                  | > 1\                  | > 6 = 2 · 3 9 = 3 · 3 |
| > 3\                  | > 2\                  |                       |
| > 4\                  | > 3\                  |                       |
| > 5                   | > 5                   |                       |
+-----------------------+-----------------------+-----------------------+

15 = 3 · 5\ Thus,\ *an* = *an*−1 + *an*−3 + *an*−4*,* *a*1 = 2*, a*2 = 4*, a*3 = 6*, a*4 = 9*.*

This recursion leads to the table above. From this table, we conjecture that

*a*2*m* = *F*2 *m*+2*,* *a*2*m*+1 = *Fm*+2 · *Fm*+3*.*

Suppose the conjecture is valid for all *k \<* 2*m*. Then,

*a*2*m* = *Fm*+1*Fm*+2 + *FmFm*+1 + *F*2 *m*= *Fm*+1*Fm*+2 + *FmFm*+2 = *F* 2 *m*+2*,a*2*m*+1 = *F*2 *m*+2+ *F* 2 *m*+1+ *FmFm*+1 = *F* 2 *m*+2+ *Fm*+1*Fm*+2 = *Fm*+2*Fm*+3*.*

12. Color the corresponding map properly with two colors. Assign to each region an integer whose magnitude is equal to the number of vertices of that region. The sign of the integer is positive for one color and negative for the other color. The sum of the integers at any side of any line will be 0. Indeed, take any of the *N* lines. If a vertex is not on that line, then it contributes +1 to two regions and −1 to two regions. If it is on the separating line, it contributes +1 to one region and −1 to another region.13. To get some clues, we try to compute the first terms of the sequence: *a*0 = 9, *a*1 = 22599*, ···*.
The next term already takes too much time. But at least we suspect that there are enough nines at the end of the numbers. In addition, we are told that *a*10 contains more than 1000 nines. But 1000 is slightly less that 210= 1024. We conjecture that *an* ends with 2*n*nines. This will be proved by induction. A number ending in *m* nines has the form *a*
·10*m*−1*, a* ∈ N. Suppose *an* = *a* ·10*m*−1. Then, *an*+1 = 3*a*4 *n*+ 4*a*3 *n*= 3(*a* · 10*m* − 1)4 + 4(*a* · 10*m* − 1)3\ = 3*a*4104*m*− 12*a*3103*m*+ 18*a*2102*m*− 12*a*10*m*\ + 3 + 4*a*3103*m*− 12*a*2102*m*+ 12*a*310*m*− 4\ = *b* · 102*m*− 1*.*

Hence the number of nines at the end doubles at each step. So

*an* = *a* · 102*n*− 1 for all *n* ≥ 0*.*

14. We try a geometric interpretation. First *a*1 = 2 cos(*π/*4).
Next, we remember the duplication formula cos 2*α* = 2 cos2*α* − 1.
Now we make the conjecture\ *π*\ *an* = 2 cos 2*n*+1 *.*

+-----------------+-----------------+-----------------+-----------------+
| 218             | > 8. The       |                 |                 |
|                 | > Induction     |                 |                 |
|                 | > Principle     |                 |                 |
+=================+=================+=================+=================+
|                 |                 |                 |                 |
+-----------------+-----------------+-----------------+-----------------+
|                 |                 |                 |                 |
+-----------------+-----------------+-----------------+-----------------+
|                 |                 |                 |                 |
+-----------------+-----------------+-----------------+-----------------+

8. The Induction Principle 219

is true for some *n*. How does *Sn*+1 differ from *Sn*? All terms 1*/xy* from the sum *Sn* with *x* + *y \> n* + 1 stay in the sum *Sn*+1. On transition from *n* to *n* + 1 we must delete the terms 1*/xy* with *x* + *y* ≤ *n* + 1 from *Sn*. These are the fractions of the form 1*/x*(*n* + 1 − *x*). For each such deleted fraction, two other fractions 1*/x*(*n* + 1) and 1*/*(*n* + 1 − *x*)(*n* + 1) must be included. Clearly, if *x* and *n* + 1 are coprime, so are *n*+1−*x* and *n*+1. Since 1*/x*(*n*+1−*x*) = 1*/x*(*n*+1)+1*/*(*n*+1−*x*)(*n*+1), we have *Sn* = *Sn*+1.

34. We can arrive at a guess *an* = *f* (*n*) in many ways and then prove it by induction. (a) Starting with *a*1 = 1. we compute *a*2*, a*3*, a*3*, ···* until we see the formula.

\(b\) Somewhat easier is to compute, successively, the ratios *an*+1*/an* for *n* =1*,* 2*,* 3*, ···* and then guess a rule which we prove by induction.

\(c\) A guess becomes easier if the sequence *an* is convergent. Then we can replace *an*+1 and *an* in the recursion formula by the limit *a* and consider the difference *an*−*a*. Now it becomes easier to guess the rule. We will use this approach. Replacing *an* and *an*+1 by *a* in *an*+1 = *g*(*an*), we get *a* = 1*/*3 and *a* = 0. Then\ *a*1−13= 12+16*, a*2−13= 1 3 · 23 *, a*3−13= 1 3= 13 · 25 *, a*4−122 + 23 + 24 + 3 · 27 *.*

11\ We conjecture that\ 3+ 1 (1) 2*n* + 3 · 4*n . an* =1\ 2\ In the recursion formula *an*+1 = *g*(*an*), we replace *an* in the right side by the right side of (1) and, after heavy computation, get

1 2\ *an*+1 =13+ 2*n*+1 + 3 · 4*n*+1 *.*

*Remark.* The sequence *an* converges to= 1 0*x*2 *dx*. The recursion is a "duplication may have been thousands of people who had this idea before.formula" for the parabola *y* = *x*2. This is the way I discovered it. Of course, there

35. The assertion is obvious for *n* = 3. Suppose we have a proof for (*n* − 1) points. We will prove it for *n* points. If another point lies on each line through two points, then all points lie on one line (See Chapter 3, **E10**). Hence there is a line joining only the points *A* and *B*. We throw away the point *A*. Now there are two cases.

\(1\) All the remaining points lie on one line *l*. Then we have *n* different lines: (*n* − 1) lines through *A* and the line *l*.

\(2\) The remaining points are not collinear. By the induction hypothesis, there are at the line *AB*, we have at least *n* lines.least (*n*−1) different connecting lines, and they are all distinct from *l*. Together with

36. The conditions of the problem imply that *s* = *x*1 + ... + *xm* = *y*1 + ... ... + *yn* is at least 2 (since *m* ≤ *s*, *n* ≤
*s*, *s \< mn*). If *m* = *n* = 2, 2 ≤ *s* ≤ 3, the assertion is easy to check. We prove it in the general case by induction on *m* + *n* = *k*, if *k* ≥ 4. Let *x*1 *\> y*1 be the **largest** numbers among *xi* and *yl*, respectively (1 ≤ *i* ≤ *m*, 1 ≤ *j* ≤ *n*). The case *xi* = *yl* is obvious. To apply the induction hypothesis to the equality\ (*x*1 − *y*1) + *x*2 + ... + *xm* = *y*2 + ... *yn*

220 8. The Induction Principle

with *k* − 1 = *m* + *n* − 1 on both sides, it is sufficient to check the inequality *s*′= *y*2 + ... + *yn \< m*(*n* − 1); since *y*1 *\>
s/n*, we have *s*′*\< s* − *s/n* =*mn*(*n* − 1)*/n* = *m*(*n* − 1).

37. The integer 1007 is divisible by 53. Any two successive terms have the difference 9010 ... 0 which is divisible by 53. By induction, each term of the sequence is divisible by 53.

38. Proceed as in the preceding problem.

39. We use induction. We have *x*0 1+ *x*0 2= 2 and *x*1 + *x*2 = −*p*. Since *p* is odd gcd(*y*0*, y*1) = 1. Suppose now that gcd(*yn, yn*+1) = 1. Then, we prove that gcd(*yn*+1*, yn*+2) = 1. Indeed,

*yn*+2 = (*xn*+1 + *xn*+1 )(*x*1 + *x*2) = *xn*+2 + *xn*+2 + *x*1*x*2(*xn* 1+ *xn* 2) = −*pyn*+1 + *yn.*

Every divisor of *yn*+2 and *yn*+1 is also a divisor of *yn*. Thus *yn*+2 and *yn*+1 have the same divisors as *yn*+1 and *yn*.

9

Sequences

**Difference Equations**. A *sequence* is a function *f* defined for every nonnegative integer *n*. For sequences one mostly sets *xn* = *f* (*n*). Usually we are given an equation of the form

*xn* = *F*(*xn*−1*, xn*−2*, xn*−3*, ···*)*.*

Sometimes we are expected to find a 'closed expression' for *xn*. Such an equation is called a *functional equation*. A functional equation of the form

*xn* = *pxn*−1 + *qxn*−2 (*q* ̸= 0) (1)

is a (homogeneous) *linear difference equation of order 2* (with constant coefficients.) To find the general solution of (1), first we try to find a solution of the form *xn* = *λn*for a suitable number *λ*. To find *λ*, we plug *λn*into (1) and get *λn*= *pλn*−1+ *qλn*−2, *λ*2= *pλ* + *q*, or

*λ*2− *pλ* − *q* = 0*.* (2)

This is the *characteristic equation* of (1). For distinct roots *λ*1 and *λ*2,

*xn* = *aλn* 1+ *bλn*

is the general solution. *a* and *b* can be found from the initial values *x*0, *x*1. If *λ*1 = *λ*2 = *λ*, the general solution has the form

*xn* = (*a* + *bn*)*λn.* (3)

228 9. Sequences

44. Does there exist a positive sequence *an*, such that=*an* and=1*/*(*n*2*an*) are conver

45. The positive real numbers *x*0*, ··· , x*1995 satisfy *x*0 = *x*1995 and

+-----------------------+-----------------------+-----------------------+
| *xi*−1 +              | 2                     | > = 2*xi* +1          |
+=======================+=======================+=======================+
|                       | *xi*−1                |                       |
+-----------------------+-----------------------+-----------------------+

for *i* = 1*, ··· ,* 1995. Find the maximum value that *x*0 can have (IMO 1995).

46. Let *k* ∈ N. Prove that there exists a real *r \>* 1, such that *k*\|⌊*rn*⌋ for all *n* ∈ N.

47. (IMO 1993.) Let *n \>* 1 be an integer. There are *n* lamps *L*0*, ··· , Ln*−1 arranged in a circle. Each lamp is either ON or OFF. A sequence of steps *S*0*, ··· , Si, ···* is carried out.
Step *Sj* affects the state of *Lj* only (leaving the states of all other lamps unaltered) as follows:

If *Lj*−1 is ON, *Sj* changes the state of *Lj* from ON to OFF or from OFF to ON;

If *Lj*−1 is OFF, *Sj* leaves the state *Lj* unchanged.

all lamps are ON. Show thatThe lamps are labeled mod *n*, that is, *L*−1 = *Ln*−1, *L*0 = *Ln*, *L*1 = *Ln*+1*.* Initially

\(a\) there is a positive integer *M*(*n*) such that after *M*(*n*) steps all the lamps are ON again;

\(b\) if *n* has the form 2*k*, then all lamps are ON after (*n*2− 1) steps;\ (c) if *n* has the form 2*k*+ 1, then all the lamps are ON after (*n*2− *n* + 1) steps.

48. The sequence *an* is defined by *a*1 = 0*,* \|*a*2\| = \|*a*1 + 1\|*, ···* \|*an*\| = \|*an*−1 + 1\|. Prove that\ *a*1 ~~+~~ *a*2 ~~+ ... +~~ *an* *n* ≥ −12*.*

49. Of the sequence *a*0*, a*1*, ··· , an* it is known that *a*0 = *an* = 0 and that *ak*−1 − 2*ak* + *ak*+1 ≥ 0 for all *k* = 1*, ···
, n* − 1. Prove that *ak* ≥ 0 for all *k*.

50. Given are the positive integers *a*0*, ··· , a*100 such that *a*1 *\> a*0, *a*2 = 3*a*1 − 2*a*0, *a*3 = 3*a*2 − 2*a*1, *··· , a*100 = 3*a*99 − 2*a*98. Prove that *a*100 *\>* 299.

51. Start with two positive integers *x*1*, x*2, both less than 10000, and for *k* ≥ 3 let *xk* be the smallest of the absolute values of the pairwise differences of the preceding terms. Prove that we always have *x*21 = 0 (AUO 1976).

52. The sequence *a*0*, a*1*, a*2*, ···* is such that, for all nonnegative *m, n* (*m* ≥ *n*), we have *am*+*n* + *am*−*n* = (*a*2*m* + *a*2*n*)*/*2. Find *a*1995 if *a*1 = 1.

53. Can the numbers 1*, ··· ,* 100 belong to 12 geometrical progressions?

54. Prove that, for any positive integer *a*1 *\>* 1 there exists an increasing sequence of positive integers *a*1*, a*2*, a*3*, ···*, such that *a*2 1+ ... + *a*2 *k*is divisible by *a*1 + ... + *ak* for all *k* ≥ 1 (RO 1995).

55. The infinite sequence *xn* is defined by 0 ≤ *x*0 ≤ 1, *xn*+1 = 1 −
\|1 − 2*xn*\|. Prove that the sequence is periodic iff *x*0 is rational.

56. The sequence *x*1*, x*2*, ···* of positive integers is defined as follows: 1, 2, 4, 5, 7, 9, 10, 12, 14, 16,*···* . Find a formula for *xn*.

9. Sequences 241

The state of the system at instant *j* can be represented by the vector ⃗*vj* =\[*xj*−*n, ··· , xj*−1\], ⃗*v*0 = \[1*, ··· ,* 1\].
Since there are only 2*n*feasible vectors, repetitions must occur in the sequence ⃗*v*0*,* ⃗*v*1*,* ⃗*v*2*, ···*. The operation that produces ⃗*vj*+1 from ⃗*vj* is invertible. Hence, the equality
⃗*vj*+*m* = ⃗*vj* implies ⃗*vm* = ⃗*v*0; the initial state recurs in at most 2*n*steps, proving (a).

To prove (b) and (c), notice that, in view of (1),

*xj* ≡ *xj*−*n* + *xj*−1 ≡ (*xj*−2*n* + *xj*−*n*+1) + (*xj*−1−*n* + *xj*−2)\ ≡ *xj*−2*n* + 2*xj*−*n*−1 + *xj*−2 ≡ *xj*−3*n* + 3*xj*−2*n*−1 + 3*xj*−*n*−2 + *xj*−3*,*and so on. After *r* applications of (1), we arrive at the equality

=*r* ==*xj* ≡ *i* *xj*−(*r*−*i*) *n*−*i* (mod 2)*,* *i*=0\ *r*\ holding for all *j* and *r* such that *j* − (*r* − *i*)*n* − *i* ≥ −*n*. In particular, if *r* is of the =*r* =form *r* = 2*k*, then the binomial coefficients *i* are even,except the two outer ones, and we obtain *xj* ≡ *xj*−*rn* + *xj*−*r* (for *r* = 2*k*)*,* (3)provided the subscripts do not go below −*n*, i.e., for *j* ≥ (*r* − 1)*n*.

Now, if *n* = 2*k*, choose *j* ≥ *n*2− *n*, and set in (3) *r* = *n*, obtaining, in view of (1),

*xj* ≡ *xj*−*n*2 + *xj*−*n* ≡ *xj*−*n*2 + (*xj* − *xj*−1)*.*

Hence, *xj*−*n*2 = *xj*−1, showing that the sequence *xj* is periodic with period *n*2− 1. Thus, the string (2) of ones reappears after exactly *n*2− 1 steps; claim (b) results.

And if *n* = 2*k*+ 1, choose *j* ≥ *n*2− 2*n*, and set in (3) *r* = *n* − 1, obtaining, in view of (1),

*xj* ≡ *xj*−*n*2+*n* + *xj*−*n*+1 ≡ *xj*−*n*2+*n* + (*xj*+1 − *xj*) ≡
*xj*−*n*2+*n* − *xj*+1 + *xj*

(because *x* ≡ −*x* mod 2). Hence *xj*−*n*2+*n* = *xj*+1, showing that the sequence *xj* is periodic with period *n*2− *n* + 1 and proving claim (c).

This problem is due to G.N. de Bruijn. The solution is due to Marcin Kuczma.

48. Square all equalities *a*1 = 0, \|*a*2\| = \|*a*1 + 1\|*, ···*
\|*an*+1 = \|*an* + 1\|, and add them. Reduction yields *a*2 *n*+1= 2(*a*1+...+*an*)+*n* ≥ 0. This implies *a*1+...+*an* ≥ −*n/*2.

49. A picture is very helpful. The broken line with vertices (*k, ak*) is convex since *ak*+1 −*ak* ≥ *ak* −*ak*−1, that is, the slope of each succeeding segment is greater than or equal to the preceding one. Hence, all the broken line, except its endpoints, lies below the axis 0*k*.

Suppose that, for some *m* ≥ 1, we have *am*−1 ≤ 1, *am \>* 0. Then

*an* − *an*−1 ≥ *an*−1 − *an*−2 ≥ ... *am*+1 − *am* ≥ *am* − *am*−1 *\>* 0*,*

and thus *an \> an*−1 *\>* ... *\> am \>* 0. This contradicts the condition *an* = 0.

50. We have *a*1−*a*0 ≥ 1. Furthermore *a*2−*a*1 = 2(*a*1−*a*0)*, ···
, a*100−*a*99 = 2(*a*99−*a*98). Multiplying these 99 equalities with both sides positive and cancelling, we get

*a*100 = *a*99 + 299(*a*1 − *a*0) ≥ 299*.*

A sharper estimate using induction *ak* ≥ 2*k, ak*+1 − *ak* ≥ 2*k*(*k* = 1*,* 2*, ···*) shows that *a*100 ≥ 2100.

10

Polynomials

1. The terms

*f* (*x*) = *anxn*+ ... + *a*0*,* *g*(*x*) = *bmxm*+ ... + *b*0*, an* ̸= 0*, bm* ̸= 0

are *polynomials* of *degrees n* and *m*: deg *f* = *n*, deg *g* = *m*. The coefficients *ai*, *bi* can be from C*,* R*,* Q*,* Z*,* Z*n*.

2. **Division with Remainder**. For polynomials *f* and *g* there exist unique polynomials *q* and *r* so that

*f* (*x*) = *g*(*x*)*q*(*x*) + *r*(*x*)*,* deg *r \<* deg *g* or *r*(*x*) = 0*.*

*q*(*x*) and *r*(*x*) are *quotient* and *remainder* on division of *f* by *g*. If *r*(*x*) = 0, then we say that *g*(*x*) divides *f* (*x*), and we write *g*(*x*)\|*f* (*x*).

yields **E1.** With *f* (*x*) = *x*7− 1*, g*(*x*) = *x*3+ *x* + 1 the grade school method of division *x*7− 1 = (*x*3+ *x* + 1)(*x*4− *x*2− *x* + 1) + 2*x*2− 2*.*

Here *q*(*x*) = *x*4− *x*2− *x* + 1*, r*(*x*) = 2*x*2− 2.

3. Let *f* be a polynomial of degree *n* and *a* ∈ R. Division by *x* − *a* yields

*f* (*x*) = (*x* − *a*)*q*(*x*) + *r,* *r* ∈ R*,* deg *q* = *n* − 1*.* (1)

Setting *x* = *a* in (1), we get *f* (*a*) = *r*, and hence

*f* (*x*) = (*x* − *a*)*q*(*x*) + *f* (*a*)*.* (2)

10. Polynomials 251

**Proof.**

+-----------------------------------+-----------------------------------+
| > *f* (*x*) = *a*0*x*2*n*+        | > =\                              |
| > *a*1*x*2*n*−1+ ... + *a*1*x*  | > *,*\                            |
| > + *a*0*,f* (*x*) = *xn* =       | > =+ ... + *an*                 |
| > *xn*−1 + *a*0*a*0*xn*+          |                                   |
| > *a*1*xn*−1+ ... + *xn* =      |                                   |
| > =*xn*+1= = 1*f* (*x*) = *xn*    |                                   |
| > *a*0 + *a*1 *xn*−1+ *xn* *xn*−1 |                                   |
+===================================+===================================+ +-----------------------------------+-----------------------------------+

We show how to express *xk*+ 1*/xk*by *z* = *x* + 1*/x*:

=*.*

+-----------------------+-----------------------+-----------------------+
| *x*2+1*x*2 =          | > =*x* +1=2=*x*       | > − 2 = *z*2− 2*,*    |
|                       | > +1=3=*x* +1=4=*x*   |                       |
|                       | > +1=5                |                       |
+=======================+=======================+=======================+
| *x*3+1*x*3 =          |                       | > − 3*x* −3*x*= *z*3  |
|                       |                       | > − 3*z,*             |
+-----------------------+-----------------------+-----------------------+
| *x*4+1*x*4 =          |                       | > − 4*x*2− 6 −4*x*2 = |
|                       |                       | > *z*4 − 4=*z*2− 2=−  |
|                       |                       | > 6 = *z*4− 4*z*2+    |
|                       |                       | > 2*,*− 5*x*3− 10*x*  |
|                       |                       | > −10*x*− 5*x*3 =     |
|                       |                       | > *z*5 − 5*z*3 +      |
|                       |                       | > 5*z.*               |
+-----------------------+-----------------------+-----------------------+
| *x*5+1*x*5 =          |                       |                       |
+-----------------------+-----------------------+-----------------------+

Without proof we state some properties of reciprocal polynomials. They are easy to prove and are left to the reader as exercises:

\(a\) Every polynomial *f* (*x*) of degree *n* with *a*0 ̸= 0 is reciprocal iff *xnf*= 1== *f* (*x*)*.x*

\(b\) Every reciprocal polynomial *f* (*x*) of odd degree is divisible by *x* + 1 and the quotient is a reciprocal polynomial of even degree.

\(c\) If *a* is a zero of the reciprocal equation *f* (*x*) = 0, then[1]{.ul}*a*is also a zero of this equation.

11. **Symmetric Polynomials**

\(a\) The elementary symmetric polynomials in *x*, *y*A polynomial *f* (*x, y*) is symmetric, if *f* (*x, y*) = *f* (*y, x*) for all *x*, *y*.
Examples:

\(b\) The power sums

*σ*1 = *x* + *y,* *σ*2 = *xy.*

*si* = *xi*+ *yi* *i* = 0*,* 1*,* 2*, ··· .*

A polynomial symmetric in *x, y* can be represented as a polynomial in *σ*1*, σ*2.

Indeed,

*sn* = *xn*+ *yn*= (*x* + *y*)(*xn*−1+ *yn*−1) − *xy*=*xn*−2+ *yn*−2== *σ*1*sn*−1 + *σ*2*sn*−2*.*

10. Polynomials 253

resulting in *σ*2 2− 50*σ*2 + 264 = 0 with solutions *σ*2 = 6*, σ*2 = 44. We must solve the system *y* + *z* = 5, *yz* = 6 with solutions (*y*1*, z*1) = (2*,* 3), (*y*2*, z*2) = (3*,* 2). Now *x*1 = 16, *x*2 = 81. The solutions *y* + *z* = 5, *yz* = 4 give complex values.

**E9.** *What is the relationship between a, b, c if the system*

*x* + *y* = *a,* *x*2+ *y*2= *b,* *x*3+ *y*3= *c*

*is compatible (has solutions)?*

**Solution.** We eliminate *x, y*: *σ*1 = *a*, *σ*2 1− 2*σ*2 = *b*, *σ* 3 1− 3*σ*1*σ*2 = *c* with the result *a*3− 3*ab* + 2*c* = 0*.* (c) Polynomials with three variables have the elementary symmetric polynomials\ *σ*1 = *x* + *y* + *z,* *σ*2 = *xy* + *yz* + *zx,*\ *σ*3 = *xyz.*The power sums *si* = *xi*+ *yi*+ *zi, i* = 0*,* 1*,* 2*,*
... can be represented by *σ*1*, σ*2*, σ*3. Show that the following identities are valid:

*s*0 = *x*0+ *y*0+ *z*0*, s*1 = *x* + *y* + *z* = *σ*1*,* *s*2 = *x*2+ *y*2+ *z*2= *σ*2 1− 2*σ*2*,*\ *s*3 = *x*3+ *y*3+ *z*3= *σ*3 1− 3*σ*1*σ*2 + 3*σ*3*,* *s*4 = *σ*4 1− 4*σ* 2 1*σ*2 + 2*σ* 2\ 2+ 4*σ*1*σ*3*, x*2*y* + *xy*2+ *x*2*z* + *xz*2+ *y*2*z* + *yz*2= *σ*1*σ*2 − 3*σ*3*, x*2*y*2+ *y*2*z*2+ *z*2*x*2 = *σ*2 2− 2*σ*1*σ*3*.*

Systems of equations which are symmetric in *x, y, z* can be expressed through *σ*1*, σ*2*, σ*3. As soon as we have *σ*1*, σ*2*, σ*3, we find the solutions *u*1*, u*2*, u*3 of the cubic equation *u*3− *σ*1*u*2+ *σ*2*u* − *σ*3 = 0*.* Then (*x*1*, y*1*, z*1) = (*u*1*, u*2*, u*3) is one solution. We get the others by permuting the variables.

**E10.** *Solve the system of equations*

*x* + *y* + *z* = *a,* *x*2+ *y*2+ *z*2= *b*2*,* *x*3+ *y*3+ *z*3= *a*3*.*

We set *x* + *y* + *z* = *σ*1*, xy* + *yz* + *zx* = *σ*2*, xyz* = *σ*3 and get

+-----------------------------------+-----------------------------------+
| > *σ*1 = *a,* *σ*2                | > *,*                             |
| > =[1]{.ul}=*a*2− *b*2= *,* *σ*3  |                                   |
| > =12*a* =*a*2− *b*2=*u*3−        |                                   |
| > *au*2+1=*a*2− *b*2=*u* −1 2*a*  |                                   |
| > =*a*2− *b*2== 0*,* (*u* −       |                                   |
| > *a*)=*u*2−[1]{.ul}=*b*2−        |                                   |
| > *a*2=== 0*,* *u*1 = *a,* *u*2   |                                   |
| > ==*b*2−*a*22 *,* *u*3 =         |                                   |
| > −=*b*2−*a*2*.*                  |                                   |
| >                                 |                                   |
| > There are six solutions (*u*1*, |                                   |
| > u*2*, u*3) and its              |                                   |
| > permutations.                   |                                   |
+===================================+===================================+ +-----------------------------------+-----------------------------------+

**E11.** *Find all real solutions of the system x* + *y* + *z* = 1*, x*3+ *y*3+ *z*3+ *xyz* =*x*4+ *y*4+ *z*4+ 1*.*

254 10. Polynomials

Introducing elementary symmetric polynomials yields *σ*1 = 1, *x*3+ *y*3+ *z*3=*σ*3 second equality becomes 2*σ*2 1− 3*σ*1*σ*2 + 3*σ*3, *x*4 + *y*4 + *z*4 = *σ* 4 2− *σ*2 + 1 = 0, which has no solutions.1− 4*σ* 2 1*σ*2 + 2*σ* 2 2+ 4*σ*1*σ*3. For *σ*1 = 1, the **E12.** *Given* 2*n distinct numbers a*1*, ··· , an, b*1*, ··· , bn, an n* × *n table is filled as Prove that if the product of each column is the same, then also the product of each follows: into the cell in the ith row and jth column is written the number ai* + *bj. row is the same* (AUO 1991).

Consider the polynomial

+-----------------------+-----------------------+-----------------------+
| *f* (*x*) =           | > *n*\                | > *n*\                |
|                       | > =(*x* + *ai*)       | > =(*x* − *bj*)*j*=1  |
|                       | > −*i*=1              |                       |
+=======================+=======================+=======================+ +-----------------------+-----------------------+-----------------------+

of degree less than *n*. If

*f* (*bj*) =

*n*\ =(*ai* + *bj*) = *ci*=1

for all *j* = 1*, ··· , n* then the polynomial *f* (*x*)−*c* has at least *n* distinct roots. This implies *f* (*x*) − *c* = 0 for all *x*. But then

*c* = *f* (−*ai*) = −

Problems

+-----------------------+-----------------------+-----------------------+
| > *n*\                | > *n*\                | > QED.                |
| > =(−*ai* − *bj*) =   | > =(*ai* + *bj*)*,    |                       |
| > (−1)*n*+1 *j*=1     | > j*=1                |                       |
+=======================+=======================+=======================+ +-----------------------+-----------------------+-----------------------+

1. Factor *x*3+ *y*3+ *z*3− 3*xyz* by elementary symmetric functions.

2. For which *a* ∈ R is the sum of the squares of the zeros of *x*2− (*a* − 2)*x* − *a* − 1 minimal?

3. If *x*1*, x*2 are the zeros of the polynomial *x*2− 6*x* + 1, then for every nonnegative integer *n*, *xn* 1+ *xn* 2is an integer and not divisible by 5.

4. Given a monic polynomial *f* (*x*) of degree *n* over Z and *k, p*
∈ N, prove that if none of the numbers *f* (*k*), *f* (*k* + 1), *. .
. , f* (*k* + *p*) is divisible by *p* + 1, then *f* (*x*) = 0 has no rational solution.

5. The polynomial *x*2*n*− 2*x*2*n*−1+ 3*x*2*n*−2− ... − 2*nx* + 2*n* + 1 has no real roots.

6. *a, b, c* ∈ R*, a* + *b* + *c \>* 0*, bc* + *ca* + *ab \>* 0*, abc
\>* 0 ⇒ *a, b, c \>* 0.

7. A polynomial *f* (*x, y*) is *antisymmetric*, if *f* (*x, y*) = −*f* (*y, x*). Prove that every antisymmetric polynomial *f* (*x, y*) has the form *f* (*x, y*) = (*x* − *y*)*g*(*x, y*), where *g*(*x, y*) is symmetric.

8. The polynomial *f* (*x, y, z*) is antisymmetric if the sign changes on switching any two variables. Prove that every antisymmetric polynomial *f* (*x, y, z*) can be written in the form *f* (*x, y, z*) = (*x* −*y*)(*x* −*z*)(*y* −*z*)*g*(*x, y, z*), where *g*(*x, y, z*) is symmetric.

9. If *f* (*x, y*) is symmetric and *x* − *y*\|*f* (*x, y*), then (*x* − *y*)2\|*f* (*x, y*).

256 10. Polynomials

33. Let *f* (*x*) = *ax*2+ *bx* + *c*. Suppose *f* (*x*) = *x* has no real roots. Show that the equation *f* (*f* (*x*)) = *x* has also no real solutions.

34. Let *f* (*x*) be a monic polynomial with integral coefficients. If there are four different integers *a, b, c, d*, so that *f* (*a*) = *f* (*b*) = *f* (*c*) = *f* (*d*) = 5, then there is no integer *k*, so that *f* (*k*) = 8.

35. Let *f* (*x*) = *x*4+ *x*3+ *x*2+ *x* + 1. Find the remainder on dividing *f* (*x*5) by *f* (*x*).36. Find all polynomials *P* (*x*), so that *P*\[*F*(*x*)\] = *F*\[*P* (*x*)\]*, P*(0) = 0, where *F*(*x*) is a given function with the property *F*(*x*) *\> x* for all *x* ≥ 0.

37. Find all polynomial solutions of the functional equation

*f* (*x*)*f* (*x* + 1) = *f* (*x*2+ *x* + 1)*.*

38. Find all pairs of positive integers (*m, n*), so that

1 + *x* + *x*2+ ... + *xm*\|1 + *xn*+ *x*2*n*+ ... + *xmn* (USO 1977).

39. If *a* and *b* are two solutions of *x*4+ *x*3− 1 = 0, then *ab* is a solution of

*x*6+ *x*4+ *x*3− *x*2− 1 = 0 (USO 1977).

40. Find the polynomial *p*(*x*) = *x*2+ *px* + *q* for which max*x*∈\[−1*,*1\] \|*p*(*x*)\| is minimal.41. Let *f* (*x*) ==*x*1958+ *x*1957+ 2=1959 = *a*0 + *a*1*x* + ... + *anxn*. Find\ *a*0 − *a*1*/*2 − *a*2*/*2 + *a*3 − *a*4*/*2 − *a*5*/*2 + *a*6 − ...
*.*

42. Find the remainder on dividing *x*1959− 1 by (*x*2+ 1)(*x*2+ *x* + 1).

43. Is there a nonconstant function *f* (*x*) so that *xf* (*y*) + *yf* (*x*) = (*x* + *y*)*f* (*x*)*f* (*y*) for all *x, y* ∈ R?

44. Find all positive solutions of the equation *nxn*+1− (*n* + 1)*xn*+ 1 = 0.

45. Let *p*(*x*) be a polynomial over Z. If *p*(*a*) = *p*(*b*) = *p*(*c*) = −1 with integers *a, b, c*, then *p*(*x*) has no integral zeros.

46. Find all polynomials *p*(*x*) with *xp*(*x* − 1) = (*x* − 26)*p*(*x*) for all *x*.

47. The polynomial *ax*4+ *bx*3+ *cx*2+ *dx* + *e* with integral coefficients is divisible by 7 for every integer *x*. Show that 7\|*a,* 7\|*b,* 7\|*c,* 7\|*d,* 7\|*e*.

48. Let *a, b* ∈ R. For *x* ∈ \[−1*,* 1\] we have −1 ≤ *ax*2+ *bx* + *c* ≤ 1. Show that in the same interval, −4 ≤ 2*ax* + *b* ≤ 4.

49. The polynomial 1 + *x* + *x*2*/*2! + *x*3*/*3! + ... + *x*2*n/*(2*n*)! has no real zeros.

50. If *x*3+ *px*2+ *qx* + *r* = 0 has three real zeros, then *p*2≥ 3*q*.

51. *f* (*n*) = *n*2− *n* + 41 gives primes for *n* = 1*, ··· ,* 40. Find 40 successive values of *n* for which *f* (*n*) is composite.
Generalize.

52. Find the smallest value of the polynomial *x*3(*x*3+ 1)(*x*3+ 2)(*x*3+ 3).

53. Does there exist a polynomial *f* (*x*), for which *xf* (*x* − 1) = (*x* + 1)*f* (*x*)?

54. (1 + *x* + ... + *xn*)2− *xn*is the product of two polynomials.

55. A polynomial *f* (*x*) over Z has no integral zero if *f* (0) and *f* (1) are both odd.

264 10. Polynomials

51. Let *ak* = *k*2− *k* + 41 for *k* = 1*, ··· ,* 40. Let *A* = *a*1 · *a*2 ... *a*40. Then for *k* =1*,* 2*, ··· ,* 40, we have

*f* (*A* + *k*) = (*A* + *k*)2− (*A* + *k*) + 41 = *A*2+ (2*k* − 1)*A* + *ak.*

Since *ak*\|*A*, it follows that *A* is composite. This can be generalized to any quadratic polynomial *f* (*n*) = *an*2+ *bn* + *c*.
Let *x* = *f* (1) ... *f* (*k*). Then *f* (*x* + *i*) = *ax*2+ 2*aix* + *bx* + *f* (*i*), and *f* (*i*)\|*f* (*x* + *i*) for *i* = 1*, ··· k*. The sequence of *k* consecutive values is *x* + 1*, . .
. , x* + *k*.

52. With *t* = *x*3we get *f* (*x*) = *t*(*t* + 1)(*t* + 2)(*t* + 3) = (*t*2+ 3*t*)(*t*2+ 3*t* + 2) =have *f*min = −1 for the real roots of *x*6+ 3*x*3+ 1 = 0.*u*(*u* + 2) = (*u* + 1)2− 1 = (*t*2+ 3*t* + 1)2− 1 ==*x*6+ 3*x*3+ 1=2 − 1 ≥ −1. We 53. For *x* = 0, we get *f* (0) = 0.
If *f* (*n*) = 0, then *f* (*n* + 1) = 0 since (*n* + 1)*f* (*n*) =(*n* + 2)*f* (*n* + 1). Thus *f* (*n*) has infinitely many zeros, i.e., *f* (*x*) ≡ 0.

54. (1 + *x* + ... + *xn*)2− *xn*==1 + *x* + ... + *xn*−1= =1 + *x* + ... + *xn*+1=.55. *Hint*: Of the two integers −*a* and 1 − *a*, exactly one is even. If *f* (*a*) = 0, then *f* (1) cannot be odd.*f* (*x*) = (*x* − *a*)*g*(*x*). But *f* (0) = −*ag*(*a*), and *f* (1) = (1 − *a*)*g*(*a*). Both *f* (0) and

56. Let *P* be the given polynomial and *Q* the polynomial to be found. Then *Q*(*x*3) =(*x*3− *x*3 1)(*x*3 − *x*3 2)(*x*3 − *x*3 1) = *P*(*x*)*P* (*ωx*)*P*(*ω*2*x*) because of *x*3 − *x*3 1= (*x* −identity*x*1)(*ωx* − *x*1)(*ω*2*x* − *x*1)*, ω*3= 1. The calculation is simplified by means of the

(*u* + *v* + *w*)(*u* + *ωv* + *ω*2*w*)(*u* + *ω*2*v* + *ωw*) = *u*3+ *v*3+ *w*3− 3*uvw.*

**Second solution**. By brute force. *P*(*x*) = *x*3+*ax*2+*bx*+*c* = (*x*−*x*1)(*x*−*x*2)(*x*−*x*3), *x*1 + *x*2 + *x*3 = −*a, x*1*x*2 + *x*2*x*3 + *x*3*x*1 = *b, x*1*x*2*x*3 = −*c*, *Q*(*x*) = *x*3+ *Ax*2+ *Bx* + *C* = (*x* − *x*3 1)(*x* − *x*3 2)(*x* − *x*3 3), *A* = −(*x*3 1+ *x*3 2+ *x*3 3)*, B* = *x*3 1*x*3 2+ *x*3 2*x*3 3+ *x*3 3*x*3 1*, C* = −(*x*1*x*2*x*3)3 = *c*3*,* (*x*1 + *x*2 + *x*3)3 = *x*3 1+ *x*3 2+ *x*3 3+ 3(*x*1 + *x*2 + *x*3)(*x*1*x*2 + *x*2*x*3 + *x*3*x*1) − 3*x*1*x*2*x*3, −*a*3= −*A* − 3*ab* + 3*c* ⇒ *A* = *a*3− 3*ab* + 3*c*, *b*3= (*x*1*x*2 + *x*2*x*3 + *x*3*x*1)3= *B* + 3*bca* − 3*c*2⇒ *B* = *b*3− 3*abc* + 3*c*2, *Q*(*x*) = *x*3+ (*a*3− 3*ab* + 3*c*)*x*2+ (*b*3− 3*abc* + 3*c*2)*x* + *c*3*.*

57. *f* (*x*) ≡ 0 is a solution. Now let *f* (*x*) ̸≡ 0. By comparing coefficients of both sides, we conclude that both the leading coefficient and *f* (0) are equal to 1. *f* (0) = 1 is the product of all zeros. Let *α* be a zero. Then 2*α*3+ *α* is also a zero. The triangle inequality implies \|*α*\| *\>* 1 ⇒ \|2*α*3+ *α*\|2≥
\|2*α*3\| − \|*α*\| *\>* \|*α*\| *\>* 1 Thus, we get infinitely many zeros by means of *α*1 = *α, αn*+1 = 2*α*3 *n*+*αn.* Contradiction!
But the product of all zeros is 1. So all zeros have absolute value 1.
Let \|*α*\| = 1. Then also \|2*α*3+ *α*\| = \|*α*\|\|2*α*2+ 1\| =
\|2*α*2+ 1\| = 1, that is, 1 = \|2*α*2+ 1\| ≥ \|2*α*2\| − 1 = 1.

1 + *x*2=*n*.58. Let (*x* −*a*1) ... (*x* −*an*)−1 = *f* (*x*)*g*(*x*), where *f* (*x*)*, g*(*x*) are polynomials with inHence, *α*2= −1. We conclude that *f* (*x*) ==\ tegral coefficients. Then *f* (*ai*) = −*g*(*ai*) = ±1 for *i* = 1*, .
. . , n*. If the polynomials *f, g* and hence also *f* (*x*)+*g*(*x*) would be of degree ≤ *n*−1, then *f* (*x*)+*g*(*x*) ≡ 0, since it has *n* zeros. Hence, we would have (*x* − *a*1) ... (*x* − *an*) − 1 = −\[*f* (*x*)\]2. This is a contradiction since the coefficient of *xn*on the left is 1, on the right *\<* 0.

59. (a) *f* (*z*) = 0 ⇒ *f* (*z*2) = 0*, f* \[(*z* − 1)2\] = 0. The set of zeros of *f* is finite and closed with respect to the map *z* =→ *z*2. Hence *z* lies in O or on the unit circle. Closure

266 10. Polynomials

For *x* = −1 and *x* = 0, we get: 2 ≥ \|*f* (−1) − *f* (0)\| = \|*a* − *b* + *c* − *c*\| = \|*a* − *b*\|. Hence,\ (*a* − *b*)2≤ 4*.* (3) From (2) and (3) we get 4*a*2+ 3*b*2= 2(*a* + *b*)2+ 2(*a* − *b*)2− *b*2≤ 16. We have equality if *b* = 0, and therefore \|*a* + *b*\| = \|*a* − *b*\| = \|*a*\| = 2. Then \|*f* (1) −*f* (0)\| = \|(*a* + *c*) − *c*)\| = \|*a*\| = 2. From (1) we get
\|*c*\| = 1 and \|*a* + *c*\| = 1. Hence, we have either *c* = 1*, a* = −2*, b* = 0 or *c* = −1*, a* = 2*, b* = 0. In these two cases 0 ≤
\|*x*\| ≤ 1 ⇒ 0 ≤ *x*2≤ 1*,* −1 ≤ 2*x*2− 1 ≤ 1. Hence, \|2*x*2− 1\| =
\| − 2*x*2+ 1\| = \|*ax*2+ *bx* + *c*\| ≤ 1. Thus,\ =83*a*2 + 2*b*2==23(4*a*2 + 3*b*2) ≤ 23· 16 = 1023*.*

67. Setting *a* = *b* = *c* in (ii), we get *P*(2*a, a*) = 0 for all *a*, that is,\ *P*(*x, y*) = (*x* − 2*y*)*Q*(*x, y*)*,* (1) where *Q* is homogeneous of degree *n* − 1. Since *P*(1*,* 0) = *Q*(1*,* 0) = 1, condition (*ii*) with *b* = *c* says *P*(2*b, a*) + 2*P*(*a* + *b, b*) = 0. From (1) we get\ (2*b* − 2*a*)*Q*(2*b, a*) + 2(*a* − *b*)*Q*(*a* + *b, b*) = 2(*a* − *b*) \[*Q*(*a* + *b, b*) − *Q*(2*b, a*)\] *.*

Hence,\ whenever *a* ̸= *b.* (2) *Q*(*a* + *b, b*) = *Q*(2*b, a*)\ But (2) holds also for *a* = *b*. With *a* + *b* = *x, b* = *y, a* = *x* − *y*, (2) becomes *Q*(*x, y*) = *Q*(2*y, x* − *y*). Applying this functional equation repeatedly, we get*Q*(*x, y*) = *Q*(2*y, x*−*y*) = *Q*(2*x*−2*y,* 3*y*−*x*) = *Q*(6*y*−2*x,* 3*x*−5*y*) = ... *,* (3)where the sum of the arguments is always *x* + *y*. Each member of (3) has the form *Q*(*x, y*) = *Q*(*x* + *d, y* − *d*) with\ (4)*d* = 0*,* 2*y* − *x, x* − 2*y,* 6*y* − 3*x, ··· .*

These values of *d* are all distinct if *x* ̸= *y*. For any fixed values *x, y*, the equation *Q*(*x* + *d, y* − *d*) − *Q*(*x, y*) = 0 is a polynomial of degree *n* − 1 in *d*, and if *x* ̸= 2*y*, it has infinitely many solutions, some of which are given by (4). Hence, for *x* ̸= 2*y* the equation *Q*(*x* + *d, y* − *d*) = *Q*(*x, y*) holds for all *d*. By continuity it also holds for *x* = 2*y*, that is, *Q*(*x, y*) is a function of the single variable *x* + *y*. Since it is homogeneous of degree *n*−1, we have *Q*(*x, y*) = *c*(*x* +*y*)*n*−1, where *c* is a constant.

Since *Q*(1*,* 0) = 1, we have *c* = 1, and hence\ *P*(*x, y*) = (*x* − 2*y*)(*x* + *y*)*n*−1*.*

68. We set *x*(*t*) = 2 cos *t.* This function maps 0 ≤ *t* ≤ *π* into 2 ≥ *x* ≥ −2. With the duplication formula for the cosine, we get

*P*1(*x*) = *P*1(2 cos *t*) = 4 cos2*t* − 2 = 2 cos 2*t,*\ *P*2(*x*) = *P*1(*P*1(*x*)) = 4 cos22*t* − 2 = 2 cos 4*t, ··· , Pn*(*x*) = 2 cos 2*nt.*

The equation *Pn*(*x*) = *x* is transformed into 2 cos 2*nt* = 2 cos *t* with solutions 2*nt* = ±*t* + 2*kπ, k* = 0*,* 1*, ···*, i.e., the following 2*n*values of *t*\ 2*kπ* 2*kπ*\ *t* =2*n*− 1 and *t* =2*n*+ 1\ give 2*n*real distinct values of *x* = 2 cos *t* satisfying the equation *Pn*(*x*) = *x*.

10. Polynomials 267

69. *Proof*. *a* + *b* + *c* ≥ 0 ⇔ 1 +*[b]{.ul}a*+ *~~c~~a*≥ 0 ⇔ (1 − *x*1)(1 − *x*2) ≥ 0*.*

*a* − *b* + *c* ≥ 0 ⇔ 1 −*ba*+ *ca*≥ 0 ⇔ 1 + *x*1 + *x*2 + *x*1*x*2 ≥ 0 ⇔ (1 + *x*1)(1 + *x*2) ≥ 0*,*\ *a* − *c* ≥ 0 ⇔ 1 −*ca*≥ 0 ⇔ 1 − *x*1*x*2 ≥ 0*.*

Let *s*1 = (1 − *x*1)(1 − *x*2)*, s*2 = (1 + *x*1)(1 + *x*2)*, s*3 = 1 − *x*1*x*2. Obviously we have\ \|*xi*\| ≤ 1 for *i* = 1*,* 2 ⇒ *sk* ≥ 0 for *k* = 1*,* 2*.*

We will show the inverse. Because of the symmetry in *x*1 and *x*2, it is sufficient to consider the cases *x*1 *\>* 1 and *x*1 *\<* −1.

*x*1 *\>* 1*, x*2 *\<* 1 ⇒ *s*1 *\<* 0*,* *x*1 *\>* 1*, x*2 ≥ 1 ⇒ *s*3 *\<* 0*,x*1 *\<* −1*, x*2 *\>* −1 ⇒ *s*3 *\<* 0*,* *x*1 *\<* −1*, x*2 *\>* −1 ⇒ *s*2 *\<* 0*.*

70. Let *z* be a zero of *f* . Then *z*2also is a zero. If \|*z*\| *\>* 1, there are infinitely many zeros, many zeros. So all zeros must lie in O or on the unit circle. which is impossible for polynomials. If 0 *\<*
\|*z*\| *\<* 1 there will also be infinitely Let us find some such polynomials.

\(a\) *Constant polynomials: f* (*x*) ≡ 0, and *f* (*x*) ≡ 1.

\(b\) *Linear polynomials: f* (*x*) = *b* + *ax, a* ̸= 0. Putting this into the functional equation, we get (*b* + *ax*)(*b* − *ax*) = *b* + *ax*2or *ax*2+ *b* = −*a*2*x*2+ *b*2. Since *a* ̸= 0, we have *a* = −1. *b*2= *b* implies *b* = 0 or *b* = 1. Thus we have two linear polynomial solutions, *f* (*x*) = −*x* and *f* (*x*) = 1 − *x*.

\(c\) *Quadratic polynomials: f* (*x*) = *ax*2+ *bx* + *c, a* ̸= 0. We get

*f* (*x*)*f* (−*x*) = (*ax*2+ *bx* + *c*)(*ax*2− *bx* + *c*) = *a*2*x*4+ (2*ac* − *b*2)*x*2+ *c*2*.*

Comparing with *f* (*x*2) = *ax*4+ *bx*2+ *c* we get *a*2= *a*, 2*ac* − *b*2= *b*, and *c*2= *c*. Since *a* ̸= 0, we have the unique solution *a* = 1. For *c*2= *c*, we have two solutions *c* = 0 and *c* = 1. For each of these values of *c*, we have two values for *b*. For *c* = 0 we get *b* = 0 and *b* = −1. For *c* = 1, we get *b* = 1 and *b* = −2. Thus we have four candidates:

*f* (*x*) = *x*2*, f* (*x*) = *x*2− *x, f* (*x*) = *x*2− 2*x* + 1 = (*x* − 1)2*, f* (*x*) = *x*2+ *x* + 1*.*

We rewrite the second and third function in the form *f* (*x*) = −*x*(1 − *x*) and *f* (*x*) =(1 − *x*)2. Now we can write a very general solution

*f* (*x*) = (−*x*)*p*(1 − *x*)*q*(*x*2+ *x* + 1)*r,* *p, q, r* ∈ Z*.*

Since *f* (−*x*) = *xp*(1 + *x*)*q*(*x*2− *x* + 1)*r*, we have

*f* (*x*2) = (−*x*2)*p*(1 − *x*2)*q*(*x*4+ *x*2+ 1)*r,*

have some rational solutions. Indeed, *p, q, r* could also be negative.so that *f* (*x*)*f* (−*x*) = *f* (*x*2). Are these all polynomial solutions? Note that we also

10. Polynomials 269

78. This problem looks hopeless. Since it cannot be hopeless, it must be trivial, that is, it splits into a straight line and a conic or into three linear factors. We start with the simpler case of three linear factors. Then one of the lines must pass through the origin, that is, one of the factors must be *x* − 2*y* = 0. Replacing *x* by 2*y*, in the original equation we get an identity. Hence *x* − 2*y* is a factor of the equation. We get the other factor 4*x*2+ 12*xy* − 12*x* + 9*y*2− 18*y* + 5 = 0 dividing by *x* − 2*y*. We transform it into the form

(2*x* + 3*y*)2− 6(2*x* + 3*y*) + 5 = 0 ⇐⇒ (2*x* + 3*y* − 5)(2*x* + 3*y* − 1) = 0*.*

From (*x* − 2*y*)(2*x* + 3*y* − 5)(2*x* + 3*y* − 1) = 0, by inspection we get the solution set consisting of the pair (1*,* 1) and the infinitely many pairs (2*n, n*)*, n* ∈ N.

79. This is a quadratic equation in the variable *x*. To have any real solutions, its discriminant *D* must be nonnegative. We write this quadratic in standard form and compute its discriminant *D*:

8*x*2+ (4*y*2+ 4*y* − 40)*x* + *y*4− 11*y*2− 8*y* + 52 = 0*,*

*D* = 16(*y*2+ *y* − 10)2− 32(*y*4− 11*y*2− 8*y* + 52) = −16(*y*2− *y* − 2)2*.*

We must have *D* = 0 or *y*2− *y* − 2 = 0 with two solutions *y*1 = 2 and *y*2 = −1. From *x* = −(*y*2+ *y* − 10)*/*4, we get *x*1 = 1 and *x*2 = 5*/*2.

80. The following factorization (which is not unique) is the most natural one:

*x*8+ 98*x*4+ 1 = (*x*4+ 1)2+ 96*x*4\ = (*x*4+ 1)2+ 16*x*2(*x*4+ 1) + 64*x*4− 16*x*2(*x*4+ 1) + 32*x*4= (*x*4+ 8*x*2+ 1)2− 16*x*2(*x*4− 2*x*2+ 1)\ = (*x*4+ 8*x*2+ 1)2− (4*x*3− 4*x*)2\ = (*x*4− 4*x*3+ 8*x*2+ 4*x* + 1)(*x*4+ 4*x*3+ 8*x*2− 4*x* + 1)*.*

81. We observe that *p*(*z*)−*p*(*x*) is divisible by *z*−*x*. Take a *z* such that *z*−*x* is divisible by *p*(*x*), for example, *z* = *q*(*x*) = *x* +*p*(*x*). Thus *p*\[*q*(*x*)\] is divisible by *p*(*x*). Since the degree of *p*\[*q*(*x*)\] is greater than that of *p*(*x*), the second factor is not constant.

82. No solution.

272 11. Functional Equations

some additional properties, for example, all continuous, monotonic, bounded, or differentiable solutions.

Withoutadditionalassumptions,itmaybepossibletofindonlycertainproperties of the functions. We give some examples:

**E1.** First we consider the equation

*f* (*xy*) = *f* (*x*) + *f* (*y*)*.* (1)

One solution is easy to guess: *f* (*x*) = 0 for all *x*. This is the only solution which is defined for *x* = 0. If *x* = 0 belongs to the domain of *f* , then we can set *y* = 0 in (1), and we get *f* (0) = *f* (*x*) + *f* (0), implying *f* (*x*) = 0 for all *x*. Let *x* = 1 be in the domain of *f* . With *x* = *y* = 1, we get *f* (1) = 2*f* (1), or

*f* (1) = 0*.* (2)

If both 1 and −1 belong to the domain, then *f* is an even function, i.e., *f* (−*x*) =*f* (*x*) for all *x*. To prove this, we set *x* = *y* = −1 in (1), and because of (2), we get

*f* (1) = 2*f* (−1) = 0 ⇒ *f* (−1) = 0*.*

Setting *y* = −1 in (1), we get *f* (−*x*) = *f* (*x*) + *f* (1), or

*f* (−*x*) = *f* (*x*) for all *x.*

Assume that *f* is differentiable for *x \>* 0. We keep *y* fixed and differentiate for *x*. Then we get *yf*′(*xy*) = *f*′(*x*). For *x* = 1, one gets *yf*′(*y*) = *f*′(1)*.* Change of notation leads to *f*′(*x*) = *f*′(1)*/x*, or\ = *xf* (*x*) = 1 *t* *dt* = *f*′(1) ln *x.*

*f*′(1)

If the function is also defined for *x \<* 0, then we have *f* (*x*) = *f*′(1) ln \|*x*\|.

**E2.** A famous classical functional equation is

*f* (*x* + *y*) = *f* (*x*) + *f* (*y*)*.* (1)

First, we try to get out of (1) as much information as possible without any additional assumptions. *y* = 0 yields *f* (*x*) = *f* (*x*) + *f* (0), that is,

*f* (0) = 0*.* (2)

For *y* = −*x*, we get 0 = *f* (*x*) + *f* (−*x*), or

*f* (−*x*) = −*f* (*x*)*.* (3)

Now we can confine our attention to *x \>* 0. For *y* = *x*, we get *f* (2*x*) = 2*f* (*x*), and by induction,\ *f* (*nx*) = *nf* (*x*) for all *n* ∈ N. (4)

274 11. Functional Equations

solutions. If we succeed in finding a solution for all rationals, then we can extend them to reals by continuity or monotonicity, etc.

**E3.** Another classical equation is

*f* (*x* + *y*) = *f* (*x*)*f* (*y*)*.* (1)

If there is an *a* such that *f* (*a*) = 0, then *f* (*x* + *a*) = *f* (*x*)*f* (*a*) = 0 for all *x*, that is, *f* is identically zero. For all other solutions, *f* (*x*) ̸= 0 everywhere. For *x* = *y* = *t/*2, we get\ *f* (*t*) = *f*2= *t*=*\>* 0*.* 2\ The solutions we are looking for are everywhere positive. For *y* = 0, we get and by induction *f* (*x*) = *f* (*x*)*f* (0) from (1), that is, *f* (0) = 1. For *x* = *y*, we get *f* (2*x*) = *f*2(*x*), *f* (*nx*) = *fn*(*x*)*.* (2)

Let *x* =*[m]{.ul}n*(*m, n* ∈ N), that is, *n* · *x* = *m* · 1.
Applying (2), we get *f* (*nx*) = *n* (1). If we set *f* (1) = *a*, then *[m]{.ul}*\ *f* (*m* · 1) ⇒ *fn*(*x*) = *fm*(1) ⇒ *f* (*x*) = *f*

=*m*= *[m]{.ul}*\ *f* = *a n ,* *n*\ that is, *f* (*x*) = *ax*for rational *x*. With a weak additional assumption (continuity, monotonicity, boundedness), as in **E2**, we can show that

*f* (*x*) = *ax* for all *x.*

The following procedure is simpler: Since *f* (*x*) *\>* 0 for all *x*, we can take logarithms in (1):\ ln ◦*f* (*x* + *y*) = ln ◦*f* (*x*) + ln ◦*f* (*y*)*.*

Let ln ◦*f* = *g*. Then *g*(*x* + *y*) = *g*(*x*) + *g*(*y*) ⇒
*g*(*x*) = *cx* ⇒ ln ◦*f* (*x*) = *cx*, and\ *f* (*x*) = *ecx.*

**E4.** We treat the following equation more generally:

*f* (*xy*) = *f* (*x*) + *f* (*y*)*,* *x, y \>* 0*.* (1)

We set *x* = *eu, y* = *ev, f* (*eu*) = *g*(*u*). Then (1) is transformed into *g*(*u* + *v*) =*g*(*u*) + *g*(*v*) with solution *g*(*u*) = *cu*, and *f* (*x*) = *c* ln *x*, as in **E1**, where we used differentiability.

**E5**. Next we consider the last Cauchy equation

*f* (*xy*) = *f* (*x*)*f* (*y*)*.* (1)

278 11. Functional Equations

6. Find all functions *f* which are defined for all *x* ∈ R and, for any *x, y*, satisfy

*xf* (*y*) + *yf* (*x*) = (*x* + *y*)*f* (*x*)*f* (*y*)*.*

7. Find all real, not identically vanishing functions *f* with the property

*f* (*x*)*f* (*y*) = *f* (*x* − *y*) for all *x, y.*

8. Find a function *f* defined for *x \>* 0, so that *f* (*xy*) = *xf* (*y*) + *yf* (*x*).

9. The rational function *f* has the property *f* (*x*) = *f* (1*/x*). Show that *f* is a rational function of *x* + 1*/x*.

*Remark*. A rational function is the quotient of two polynomials.

10. Find all "tame" solutions of *f* (*x* + *y*) + *f* (*x* − *y*) = 2 \[*f* (*x*) + *f* (*y*)\].

11. Find all "tame" solutions of *f* (*x* + *y*) − *f* (*x* − *y*) = 2*f* (*y*).

12. Find all "tame" solutions of *f* (*x* + *y*) + *f* (*x* − *y*) = 2*f* (*x*).

13. Find all tame solutions of

+-----------------------------------+-----------------------------------+
| *f* (*x* + *y*) =                 | > *f* (*x*)*f* (*y*)              |
|                                   | >                                 |
|                                   | > *f* (*x*) + *f* (*y*)*.*        |
+===================================+===================================+ +-----------------------------------+-----------------------------------+

14. Find all tame solutions of *f*2(*x*) = *f* (*x* + *y*)*f* (*x* − *y*). Note the similarity to 11.

15. Find the function *f* which satisfies the functional equation

  -----------------------------------------------------------------------
  *f* (*x*) + *f*         =                       1   ----------------------- ----------------------- -----------------------
                                                  1 − *x*

  -----------------------------------------------------------------------

== *x* for all *x* ̸= 0*,* 1*.*

16. Find all continuous solutions of *f* (*x* − *y*) = *f* (*x*)*f* (*y*) + *g*(*x*)*g*(*y*).

17. Let *f* be a real-valued function defined for all real numbers *x* such that, for some positive constant *a*, the equation

*f* (*x* + *a*) =12+=*f* (*x*) − *f*2(*x*)holds for all *x*.

\(a\) Prove that the function *f* is periodic, i.e., there exists a positive number *b* such that *f* (*x* + *b*) = *f* (*x*) for all *x*.

\(b\) For *a* = 1, give an example of a nonconstant function with the required properties (IMO 1968).

18. Find all continuous functions satisfying *f* (*x* + *y*)*f* (*x* − *y*) = \[*f* (*x*)*f* (*y*)\]2.

19. Let *f* (*n*) be a function defined on the set of all positive integers and with all its values in the same set. Prove that if

*f* (*n* + 1) *\> f* \[*f* (*n*)\]

for each positive integer *n*, then *f* (*n*) = *n* for each *n* (IMO 1977).20. Find all continuous functions in 0 which satisfy the relations

*f* (*x* + *y*) = *f* (*x*) + *f* (*y*) + *xy*(*x* + *y*)*,* *x, y* ∈
R*.*

11. Functional Equations 279

21. Find all functions *f* defined on the set of positive real numbers which take positive real values and satisfy the conditions:

+-----------------------------------+-----------------------------------+
| \(i\)                             | > *f* \[*xf* (*y*)\] = *yf* (*x*) |
|                                   | > for all positive *x, y*;*f*     |
|                                   | > (*x*) → 0 as *x* → ∞ (IMO       |
|                                   | > 1983).                          |
+===================================+===================================+
| \(ii\)                            |                                   |
+-----------------------------------+-----------------------------------+

22. Find all functions *f* , defined on the nonnegative real numbers and taking nonnegative real values, such that

+-----------------------+-----------------------+-----------------------+
| \(i\)                 | > *f* \[*xf* (*y*)\]  | > for all *x, y* ≥ 0; |
|                       | > *f* (*y*) = *f*     |                       |
|                       | > (*x* + *y*) *f* (2) |                       |
|                       | > = 0;\               |                       |
|                       | > *f* (*x*) = 0 for 0 |                       |
|                       | > ≤ *x \<* 2          |                       |
+=======================+=======================+=======================+
| \(ii\)                |                       |                       |
+-----------------------+-----------------------+-----------------------+
| \(iii\)               |                       | > (IMO 1986).         |
+-----------------------+-----------------------+-----------------------+

23. Find a function *f* : Q+=→ Q+, which satisfies, for all *x, y* ∈
Q+, the equation

*f* (*xf* (*y*)) = *f* (*x*) */y* (IMO 1990).

24. Find all functions *f* : R =→ R such that

*f* =*x*2+ *f* (*y*)== *y* + \[*f* (*x*)\]2 for all *x, y* ∈ R (IMO 1992).25. Does there exist a function *f* : N =→ N such that

*f* (1) = 2*, f* \[*f* (*n*)\] = *f* (*n*)+*n, f* (*n*) *\< f* (*n* + 1) for all *n* ∈ N (IMO 1993)?

26. Find all continuous functions *f* : R =→ R+ which transform three terms of the arithmetic progression *x, x* + *y, x* + 2*y* into corresponding terms *f* (*x*)*, f* (*x* + *y*)*, f* (*x* + 2*y*) of a geometric progression, that is,

\[*f* (*x* + *y*)\]2= *f* (*x*) · *f* (*x* + 2*y*)*.*

27. Find all continuous functions *f* satisfying *f* (*x* + *y*) = *f* (*x*) + *f* (*y*) + *f* (*x*)*f* (*y*).

28. Guess a simple function *f* satisfying *f*2(*x*) = 1 + *xf* (*x* + 1).

29. Find all continuous functions which transform three terms of an arithmetic progres sion into three terms of an arithmetic progression.

30. Find all continuous functions *f* satisfying 3*f* (2*x* + 1) = *f* (*x*) + 5*x*.

31. Which function is characterized by the equation *xf* (*x*) + 2*xf* (−*x*) = −1?

32. Find the class of continuous functions satisfying *f* (*x* + *y*) = *f* (*x*) + *f* (*y*) + *xy*.

33. Let *a* ̸= ±1. Solve *f* (*x/*(*x* − 1)) = *af* (*x*) + *φ*(*x*), where *φ*(*x*) is a given function, which is defined for *x* ̸= 1.

34. The function *f* is defined on the set of positive integers as follows:

*f* (1) = 1*,* *f* (3) = 3*,* *f* (2*n*) = *f* (*n*)*,*\ *f* (4*n* + 1) = 2*f* (2*n* + 1) − *f* (*n*)*,* *f* (4*n* + 3) = 3*f* (2*n* + 1) − 2*f* (*n*)*.*

Find all values of *n* with *f* (*n*) = *n* and 1 ≤ *n* ≤ 1988 (IMO 1988).

284 11. Functional Equations

19. *f* has a unique minimum at *n* = 1. For, if *n \>* 1, we have *f* (*n*) *\> f* \[*f* (*n* − 1)\]. By the same reasoning, we see that the second smallest value is *f* (2), etc. Hence, *f* (1) *\< f* (2) *\< f* (3) *\<* ... *.*

Since *f* (*n*) ≥ 1 for all *n*, we also have *f* (*n*) ≥ *n*. Suppose that, for some positive integer *k*, we have *f* (*k*) *\> k*. Then *f* (*k*) ≥ *k* + 1. Since *f* is increasing, *f* (*f* (*k*)) ≥*f* (*k* + 1), contradicting the given inequality. Hence *f* (*n*) = *n* for all *n*.

20. It is easy to guess the solution from this property. The function *x*3*/*3 satisfies the relationship. So we consider *g*(*x*) = *f* (*x*) − *x*3*/*3. For *g* we get the functional equation *g*(*x* + *y*) = *g*(*x*) + *g*(*y*). Since *g*(*x*) = *cx* is the only continuous solution in 0, we have *f* (*x*) = *cx* + *x*3*/*3.

21. We show that 1 is in the range of *f* . For an arbitrary *x*0 *\>* 0, let *y*0 = 1*/f* (*x*0).

Then (*i*) yields *f* \[*x*0*f* (*y*0)\] = 1, so 1 is in the range of *f* . In the same way, we can show that any positive real is in the range of *f* . Hence there is a value *y* such that *f* (*y*) = 1.
Together with *x* = 1 in (*i*), this gives *f* (1 · 1) = *f* (1) = *yf* (1). Since *f* (1) *\>* 0 by hypothesis, it follows that *y* = 1, and *f* (1) = 1. We set *y* = *x* in (*i*) and get\ *f* \[*xf* (*x*)\] = *xf* (*x*) for all *x \>* 0. (1)Hence, *xf* (*x*) is a fixed point of *f* . If *a* and *b* are fixed points of *f* , that is, if *f* (*a*) = *a* and *f* (*b*) = *b*, then (*i*) with *x* = *a, y* = *b* implies that *f* (*ab*) = *ba*, so *ab* is also a fixed point of *f* . Thus the set of fixed points of *f* is closed under multiplication. In particular, if *a* is a fixed point, all nonnegative integral powers of *a* are fixed points.

Since *f* (*x*) → 0 for *x* → ∞ by (*ii*), there can be no fixed points *\>* 1. Since *xf* (*x*) is a fixed point, follows that

*xf* (*x*) ≤ 1 ⇔ *f* (*x*) ≤1 for all *x*. (2) *x*

Let *a* = *zf* (*z*), so *f* (*a*) = *a*. Now set *x* = 1*/a* and *y* = *a* in (*i*) to give\ = 1 = = 1= = 1==1 = =*f* *a f* (*a*) = *f* (1) = 1 = *af* *a* *,* *f* *a* *a ,* *f* *zf* (*z*) =*zf* (*z*)*.*

1 1

This shows that 1*/xf* (*x*) is also a fixed point of *f* for all *x
\>* 0. Thus, *f* (*x*) ≥ 1*/x*. Together with (2) this implies that

*f* (*x*) =1*x .* (3)The function (3) is the only solution satisfying the hypothesis.

22. No solution.

23. If *f* (*y*1) = *f* (*y*2), the functional equation implies that *y*1 = *y*2. For *y* = 1, we get *f* (1) = 1. For *x* = 1, we get *f* (*f* (*y*)) = *y*for all *y* ∈ Q+. Applying *f* to this implies that *f* (1*/y*) = 1*/f* (*y*) for all *y* ∈ Q+. Finally setting *y* = *f* (1*/t*) yields *f* (*xt*) = *f* (*x*) · *f* (*t*) for all *x, t* ∈ Q+.

Conversely, it is easy to see that any *f* satisfying

\(a\) *f* (*xt*) = *f* (*x*)*f* (*t*)*,* (b) *f* \[*f* (*x*)\] = 1*/x* for all *x, t* ∈ Q+

solves the functional equation.

11. Functional Equations 285

A function *f* : Q+=→ Q+satisfying (*a*) can be constructed by defining arbitrarily on prime numbers and extending as

*f*=*pn*1 1*pn*2 2... *pnk* == \[*f* (*p*1)\]*n*1\[*f* (*p*2)\]*n*2·
· · \[*f* (*pk*)\]*nk,*\ where *pj* denotes the *j*th prime and *nj* ∈ Z. Such a function will satisfy (*b*) for each prime. A possible construction is as follows:

*f* (*pj*) =

+-----------------------------------+-----------------------------------+
| > = *pj*+1                        | > if *j* is odd,                  |
|                                   |                                   |
| *pj*−1                            |                                   |
+===================================+===================================+
|                                   | > if *j* is even.                 |
+-----------------------------------+-----------------------------------+

for each prime *p*. Hence *f* satisfies the functional equation.Extending it as above, we get a function *f* : Q+=→ Q+. Clearly *f* \[*f* (*p*)\]
= 1*/p* 24. No solution.

25. Starting with *f* (1) = 2 and using the rule *f* \[*f* (*n*)\] = *f* (*n*)+*n*, we get, successively, *f* (2) = 2 + 1 = 3, *f* (3) = 3 + 2 = 5, *f* (5) = 5 + 3 = 8, *f* (8) = 8 + 5 = 13*, ···* that is, the map of a Fibonacci number is the next Fibonacci number. Complete this by induction.

It remains to assign other positive integers to the remaining numbers satisfying the functional equation. We use Zeckendorf's theorem, which says that every positive integer *n* has a unique representation as a sum of non-neighboring Fibonacci numbers. We have proved this in Chapter 8, problem 29. We write this representation in the form\ *m*\ *n* ==*Fij ,* \|*ij* − *ij*−1\| ≥ 2*,j*=1\ where the summands have increasing indices. We will prove that the function *f* (*n*) ==*m j*=1*Fij*+1 satisfies all conditions of the problem. Indeed, since 1 represents itself as a Fibonacci number, we have *f* (1) = 2, the next Fibonacci number. Then

⎛ ⎞ *m* *m* *mf* \[*f* (*n*)\] = *f* =*Fij* +1⎠ ==*Fi*1+2 ==⎝*ij* +1 *j*=1 *j*=1 *m* *m*\ ==*Fij* +1 +=*Fij* = *f* (*n*) + *n.*

=*Fij* +1 + *Fij*=

Now we distinguish two cases.

\(a\) The Fibonacci representation of *n* contains neither *F*1 nor *F*2. Then the representation of *n* + 1 contains the additional summand 1. The representations of *f* (*n*) and *f* (*n*+1) differ also by an additional summand in *f* (*n*+1), so that *f* (*n*) *\< f* (*n*+1). (b) The Fibonacci representation of *n* contains either *F*1 or *F*2. On adding of 1, some largest Fibonacci number which is larger than the largest Fibonacci representation of summands will become bigger Fibonacci numbers. The representation of *n*+1 has a since the summands in the representation of *f* (*n*) are nonneighboring Fibonacci *n*. This property remains invariant after the application of *f* . Hence *f* (*n*+1) *\> f* (*n*), numbers and cannot add up to the greatest Fibonacci number in *f* (*n* + 1).

*Remark*. The function *f* is not uniquely determined by the three conditions.

288 11. Functional Equations

hypothesis *f* (*p*) = *p* = *f* (*k*), and this contradicts the injectivity of *f* . If *f* (*k*) *\> k*, then *f* \[*f* (*k*)\] ≥ *k*. If we had *f* \[*f* (*k*)\] *\< k*, then, as before, we would get the contradiction

*f* {*f* \[*f* (*k*)\]} = *f* \[*f* (*k*)\]*,* *f* \[*f* (*k*)\] = *f* (*k*)*,* *f* (*k*) = *k.*

Similarly, we have *f* {*f* \[*f* (*k*)\]} ≥ *k*. Hence, *f* {*f*
\[*f* (*k*)\]} + *f* \[*f* (*k*)\] + *f* (*k*) *\>* 3*k*, which contradicts the original condition. Thus *f* (*k*) = *k*.

12

Geometry

12.1 Vectors

*12.1.1* *Affine Geometry*

We consider the space with any number of dimensions. For competitions only 2 or 3 dimensions will be relevant. Points of the space will be denoted by capital letters *A, B, C ···*. One point will be distinguished and will be denoted by O (for origin). The most important mappings of the space are the *translations* or *vectors*. A translation *T* is determined by any point *X* and its map *T* (*X*) = *Y*. The translation taking point *A* into *B* is denoted by−→*AB*. It is usual practice to use *O OA*. Since *O* is always as the first point. The translation taking *O* to *A* is then−→the same point, we drop it and get⃗*A*. After a while one also drops the arrow on *A* and gets the point *A*. We simply identify points *A* and their vectors beginning in *O* and ending in *A*. We need not distinguish between points and vectors since all that is valid for points is also valid for vectors.

Now we define *addition* of two points *A, B* and *multiplication* of a point *A* by a real number *t*.

*A* + *B* = reﬂection of the origin *O* at the midpoint *M* of (*A, B*)*.*

The point *tA* lies on the line *OA*. Its distance from *O* is \|*t*\|
times the distance of *A*. For *t \<* 0 both *A* and *tA* are separated by *O*. For *t \>* 0 they lie on the same side of *O*. For this reason multiplication with a real number is also called a *stretch* from *O* by the factor *t*. For the points (vectors) of the space, we have the following

+---------+---------+---------+---------+---------+---------+---------+
| 294     | *A*     | > 12.  | > *C*   | *A*     | > *D*   |         |
|         |         | > G     |         |         | > *a*   |         |
|         |         | eometry |         |         | > *B*   |         |
|         |         |         |         |         | >       |         |
|         |         |         |         |         |  ====== |         |
|         |         |         |         |         | > @     |         |
|         |         |         |         |         | > =*b*  |         |
|         |         |         |         |         | > =*e*  |         |
|         |         |         |         |         | > @ *f* |         |
|         |         |         |         |         | > =*b*= |         |
|         |         |         |         |         | > *a* @ |         |
|         |         |         |         |         | > =*C*  |         |
+=========+=========+=========+=========+=========+=========+=========+
|         |         | >       |         |         |         |         |
|         |         | *D*H*c* |         |         |         |         |
|         |         | > *B*   |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
|         |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+

298 12. Geometry

that is, *A, B, C, D* lie on a circle or, for *α* = *µ* = 0◦, on a line.
Note that in Fig. 12.7, *α* and *µ* are equal and oppositely oriented.
\|*α*\| = \|*µ*\| is necessary and sufficient for an inscribed quadrilateral.

*z*4

==@@\ = = @ @ *µ* =*z*3 ==\ = =\ [=]{.ul}*α* =\ *z*1 *z*2

Fig. 12.7

Problems

1. Show that

\|*AC*\|2+ \|*BD*\|2= \|*AB*\|2+ \|*BC*\|2+ \|*CD*\|2+ \|*DA*\|2⇐⇒ *A* + *C* = *B* + *D.*

2. Let *A, B, C, D* be four space points. Prove the theorem: *If, for all points X in space,* \|*AX*\|2+ \|*CX*\|2= \|*BX*\|2+ \|*DX*\|2*, then ABCD is a rectangle.*

3. Rectangles *ABDE*, *BCFG*, *CAHI* are erected outwardly on the sides of a triangle *ABC*. Show that the perpendicular bisectors of the segments *HE, DG, FI* are concurrent.

4. A regular *n*-gon *A*1 ... *An* is inscribed in a circle with center *O* and radius *R*. *X* is 5. Let *ABC* be a regular triangle inscribed in a circle. Then *PAn*+ *P Bn*+ *PCn*is any point with *d* = \|*OX*\|. Then=*n i*=1\|*AiX*\|2 = *n*(*R*2 + *d*2).

independent of the choice of *P* on the circle for *n* = 2*,* 4.

6. For any point *P* of the circumcircle of the square *ABCD*, the sum *PAn*+ *PBn*+ *PCn*+ *P Dn*is independent of the choice of *P* if *n* = 2*,* 4*,* 6.

7. Prove Euler's theorem: *In a quadrilateral ABCD with medians MN and P Q,* \|*AC*\|2+ \|*BD*\|2= 2=\|*MN*\|2+ \|*PQ*\|2= .8. Find the locus of all points *X*, which satisfy−→*AX* · −→*CX* = −→*CB* ·
−→*AX*.

9. Three points *A, B, C* are such that \|*AC*\|2+ \|*BC*\|2=
\|*AB*\|2*/*2. What is the relative position of these points?

10. If *M* is a point and *ABCD* a rectangle, then−→*MA* · −→*MC* = −→*MB* · −−→*MD*.

11. The points *E, F, G, H* divide the sides of the quadrilateral *ABCD* in the same ratios. Find the condition for *EFGH* to be a parallelogram.

12. Let *Q* be an arbitrary point in the plane and *M* be the midpoint of *AB*. Then \|*QA*\|2+ \|*QB*\|2= 2\|*QM*\|2+
\|*AB*\|2*/*2.

13. Let *A, B, C, D* denote four points in space and *AB* the distance between *A* and *B*, and so on. Show that *AC*2+ *BD*2+ *AD*2+ *BC*2≥ *AB*2+ *CD*2.

300 12. Geometry

28. A triangle with vertices *a*, *b*, *c* is equilateral iff *a*2+ *b*2+ *c*2− *ab* − *bc* − *ca* = 0.

29. Regular triangles are erected on the sides of a point symmetric hexagon, and its neighboring vertices are joined by segments. Show that the midpoints of these segments are vertices of a regular hexagon.

30. *ABC* is a regular triangle. A line parallel to *AC* intersects *AB* and *BC* in *M* and *P* , respectively. *D* is the centroid of *PMB*, *E* is the midpoint of *AP* . Find the angles of △*DEC*.

31. *OAB* and *OA*1*B*1 are positively oriented regular triangles with a common vertex *O*. Show that the midpoints of *OB*, *OA*1, and *AB*1 are vertices of a regular triangle.

32. *OAB* and *OA*′*B*′are regular triangles of the same orientation, *S* is the centroid of△*OAB*, and *M* and *N* are the midpoints of *A*′*B* and *AB*′, respectively. Show that△*SMB*′∼ △*SNA*′(IMO jury 1977).

33. A trapezoid *ABCD* is inscribed in a circle of radius \|*BC*\| =
\|*DA*\| = *r* and center *O*. Show that the midpoints of the radii *OA*, *OB* and the midpoint of the side *CD* are vertices of a regular triangle.

34. Regular triangles *DAS*, *ABP*, *BCQ*, and *CDR* are erected outwardly on the sides of the quadrilateral *ABCD*. *M*1 and *M*2 are the centroids of *DAS* and *CDR*. The triangle *M*1*M*2*T* is oppositely oriented with respect to *ABCD*. Find the angles of△*PQT* .

35. Regular triangles with the vertices *E, F, G, H* are erected on the sides of a plane quadrilateral *ABCD*. Let *M, N, P, Q* be the midpoints of the segments *EG*, *HF*, *AC*, *BD*, respectively. What is the shape of *PMQN*?

36. The convex quadrilateral *ABCD* is cut by its diagonals (intersecting in *O*) into four triangles *AOB*, *BOC*, *COD*, *DOA*.
Let *S*1 and *S*2 be the centroids of the first and third of those triangles, and *H*1, *H*2 the orthocenters of the other two triangles.
Then *H*1*H*2 ⊥ *S*1*S*2.

37. Regular triangles with vertices *D* and *E*, respectively, are erected outwardly on the sides *AB* and *BC* of △*ABC*. Prove that the midpoints of *BD*, *BE* and *AC* are vertices of a regular triangle.

38. A point *D* is chosen inside a scalene triangle *ABC* such that*ADB* =*ACB* +90◦

and \|*AC*\| · \|*BD*\| = \|*AD*\| · \|*BC*\|. Find

+-----------------------------------+-----------------------------------+
| > \|*AB*\| · \|*CD*\|\            | > (IMO 1993).                     |
| > \|*AC*\| · \|*BD*\|             |                                   |
+===================================+===================================+ +-----------------------------------+-----------------------------------+

39. Regular triangles *OAB*, *OA*1*B*1 and *OA*2*B*2 are positively oriented with common vertex *O*. Show that the midpoints of *BA*1, *B*1*A*2, and *B*2*A* are vertices of a regular triangle.

40. If *Pi,* (*i* = 1*,* ... *, n*) are points on a unit sphere, then=*i*≤*j*\|*PiPj*\|2 ≤ *n*2.

• *The sum of the squares of the space diagonals is four times the sum of the squares of the of the three edges.*

• *The square of a space diagonal starting in some vertex is the sum of the squares of the face diagonals which start at the same point minus the sum of the squares* *of the three edges.*

12.1 Vectors 301

• *The sum of the lengths of a space diagonal starting at some point and the edges is greater then the sum of the face diagonals starting at the same point.*

• \|⃗*a* + ⃗*b* + ⃗*c*\| + \|⃗*a*\| + \|⃗*b*\| + \|⃗*c*\| *\>* \|⃗*a* + ⃗*b*\| + \|⃗*b* + ⃗*c*\| + \|⃗*c* + ⃗*a*\| (ATMO 1972).

42. Equilateral triangles are erected to the outside on the sides of a convex quadrilateral. Prove that the segment *PQ* joining the vertices of *ABP* and *CDQ* is perpendicular to the segment *RS* joining the centers of the two other triangles, and, in addition,
\|*PQ*\| =_sqrt_3\|*RS*\|.

43. A point *P*0 and a triangle *A*1*A*2*A*3 are given in a plane.
Let us set *As* = *As*−3 for all *s* ≥ 4. We construct the sequence *P*0*, P*1*, P*2*, ···* of points, so that the point *Pk*+1 is the map of *Pk* rotated around *Ak*+1 by 120◦clockwise (mathematically negative sense) (*k* = 0*,* 1*,* 2*, ···*). Show that if *P*1986 = *P*0, then triangle *A*1*A*2*A*3 is regular (IMO 1986).

44. Construct regular hexagons on the sides of a centrally symmetric hexagon. Their centers form the vertices of a regular hexagon. (A special case of a theorem of A.

Barlotti.)

45. Equilateral triangles *ABK, BCL, CDM, DAN* are constructed inside the square *ABCD*. Prove that the midpoints of the four segments *KL*, *LM*, *MN*, *NK* and the midpoints of the eight segments *AK*, *BK*, *BL*, *CL*, *CM*, *DM*, *DN*, *AN* are the twelve vertices of a regular dodecagon.

Solutions

1. Expanding and collecting terms in the LHS of the equivalence yields (*A* + *C* − *B* − *D*)2= 0, or *A* + *C* = *B* + *D*, i.e., *ABCD* is a parallelogram.

2. Routine transformation yields *A*2+ *C*2− *B*2− *D*2= 2*X*(*A* + *C* − *B* − *D*). This is valid for all points *X* of the plane iff

+-----------------------+-----------------------+-----------------------+
| > and                 | *A* + *C* = *B* +     | \(1\)                 |
|                       | *D,*                  |                       |
+=======================+=======================+=======================+
|                       | *A*2+ *C*2= *B*2+     | \(2\)                 |
|                       | *D*2*.*               |                       |
+-----------------------+-----------------------+-----------------------+

From (1) we get

(*A* + *C*)2= (*B* + *D*)2⇐⇒ *A*2+ *C*2+ 2*A* · *C* = *B*2+ *D*2+ 2*B*
· *D.* (3)

Subtracting (2) from (3), we get

2*A* · *C* = 2*B* · *D.* (4)equal diagonals. Hence it is a rectangle.
We have shown that this property characSubtracting (4) from (2), we get (*A* − *C*)2= (*B* − *D*)2*,* i.e., the parallelogram has terizes rectangles. This will be useful in several later problems, e.g., the next one.

+-----------------------+-----------------------+-----------------------+
| <table>               | > pppppppppppppppppp  |                       |
| <colgroup>            | ppppppppppppppppppppp |                       |
| <col                  | ppppppppppppppppppppp |                       |
| style="width: 33%" /> | ppppppppppppppppppppp |                       |
| <col                  | ppppppppppppppppppppp |                       |
| style="width: 33%" /> | ppppppppppppppppppppp |                       |
| <col                  | ppppppppppppppppppppp |                       |
| style="width: 33%" /> | ppppppppppppppppppppp |                       |
| </colgroup>           | ppppppppppppppppppppp |                       |
| <thead>               | ppppppppppppppppppppp |                       |
| <tr class="header">   | ppppppppppppppppppppp |                       |
| <th><blockquote>      | ppppppppppppppppppppp |                       |
| <p>310</p>            | ppppppppppppppppppppp |                       |
| </blockquote></th>    | > *B*′                |                       |
| <th><blockquote>      |                       |                       |
| <p>12. Geometry</p>   |                       |                       |
| </blockquote></th>    |                       |                       |
| <th row               |                       |                       |
| span="2"><blockquote> |                       |                       |
| <p><em>B</em></p>     |                       |                       |
| </blockquote></th>    |                       |                       |
| </tr>                 |                       |                       |
| <tr class="odd">      |                       |                       |
| <th col               |                       |                       |
| span="2"><blockquote> |                       |                       |
| <p><strong>pppppppppp |                       |                       |
| ppppppppppppppppppppp |                       |                       |
| ppppppppppppppppppppp |                       |                       |
| ppppppppppppppppppppp |                       |                       |
| ppppppppppppppppppppp |                       |                       |
| ppppppppppppppppppppp |                       |                       |
| ppppppppppppppppppppp |                       |                       |
| ppppppppppppppppppppp |                       |                       |
| ppppppppppppppppppppp |                       |                       |
| ppppppppppppppppppppp |                       |                       |
| ppppppppppppppppppppp |                       |                       |
| ppppppppppppppppppppp |                       |                       |
| ppppppppppppppppppppp |                       |                       |
| ppppppppppppppppppppp |                       |                       |
| ppppppppppppppppppppp |                       |                       |
| pppppppppppppp</stron |                       |                       |
| g><em>P</em> <strong> |                       |                       |
| ==</strong><em>q</em> |                       |                       |
| <strong>@@</strong> < |                       |                       |
| em>Q</em> <strong>=</ |                       |                       |
| strong> <strong>@</st |                       |                       |
| rong> <strong>ppppppp |                       |                       |
| ppppppppppppppppppppp |                       |                       |
| ppppppppppppppppppppp |                       |                       |
| ppppppppppppppppppppp |                       |                       |
| ppppppppppppppppppppp |                       |                       |
| ppppppppp</strong> <e |                       |                       |
| m>r</em><strong>@</st |                       |                       |
| rong> <strong>=</stro |                       |                       |
| ng> <em>p</em> <stron |                       |                       |
| g>@</strong> <em>A</e |                       |                       |
| m> <em>R</em> = <em>R |                       |                       |
| </em>′ Fig. 12.15</p> |                       |                       |
| </blockquote></th>    |                       |                       |
| </tr>                 |                       |                       |
| </thead>              |                       |                       |
| <tbody>               |                       |                       |
| </tbody>              |                       |                       |
| </table>              |                       |                       |
+=======================+=======================+=======================+
|                       |                       |                       |
+-----------------------+-----------------------+-----------------------+

12.2 Transformation Geometry 311

+-----------------------------------+-----------------------------------+
| > *D* **!***C* **!!!!!!!** **c**  | > *P*                             |
| > **A**\                          |                                   |
| > **=** **=***Q* **=** **=HH**    |                                   |
| > **c** **c** *X* **A** **A** *A* |                                   |
| > **H** *B* *Y* *M* **H c H c H c |                                   |
| > H** **A** **A** **c**           |                                   |
+===================================+===================================+
| Fig. 12.18                        |                                   |
+-----------------------------------+-----------------------------------+

+-----------------------------------+-----------------------------------+
| > ====\`\`\`\`\`                  | > *C*                             |
| \`\`\`\`\`\`\`\`\`\`\`\`\`\`\`\`\ |                                   |
| `\`\`\`\`\`\`\`\`\`\`\`\`\`\`\`\` |                                   |
| \`\`\`\`\`\`\`\`\`\`\`\`\`\`\`\`\ |                                   |
| `\`\`\`\`\`\`\`\`\`\`\`\`\`\`\`\` |                                   |
| \`\`\`\`\`\`\`\`\`\`\`\`\`\`\`\`\ |                                   |
| `\`\`\`\`\`\`\`\`\`\`\`\`\`\`\`\` |                                   |
| \`\`\`\`\`\`\`\`\`\`\`\`\`\`\`\`\ |                                   |
| `\`\`\`\`\`\`\`\`\`\`\`\`\`\`\`\` |                                   |
| \`\`\`\`\`\`\`\`\`\`\`\`\`\`\`\`\ |                                   |
| `\`\`\`\`\`\`\`\`\`\`\`\`\`\`\`\` |                                   |
| > *X* @                           |                                   |
| > ppppppppppp                     |                                   |
| ppppppppppppppppppppppppppppppppp |                                   |
| > **D**                           |                                   |
| > \`\`\`\`\`\`\`\`\`\`            |                                   |
| \`\`\`\`\`\`\`\`\`\`\`\`\`\`\`\`\ |                                   |
| `\`\`\`\`\`\`\`\`\`\`\`\`\`\`\`\` |                                   |
| \`\`\`\`\`\`\`\`\`\`\`\`\`\`\`\`\ |                                   |
| `\`\`\`\`\`\`\`\`\`\`\`\`\`\`\`\` |                                   |
| \`\`\`\`\`\`\`\`\`\`\`\`\`\`\`\`\ |                                   |
| `\`\`\`\`\`\`\`\`\`\`\`\`\`\`\`\` |                                   |
| \`\`\`\`\`\`\`\`\`\`\`\`\`\`\`\`\ |                                   |
| `\`\`\`\`\`\`\`\`\`\`\`\`\`\`\`\` |                                   |
| \`\`\`\`\`\`\`\`\`\`\`\`\`\`\`\`\ |                                   |
| `\`\`\`\`\`\`\`\`\`\`\`\`\`\`\`\` |                                   |
| > *D* = *W* **DD**=@ == = EE=     |                                   |
| > ==*A* **EE**===== *B* @ @**E**  |                                   |
| > *Y* Fig. 12.19                  |                                   |
+===================================+===================================+ +-----------------------------------+-----------------------------------+

**E5.** *On the sides AB, BC, CD, DA of a quadrilateral ABCD, we construct, alternately to the outside and inside, regular triangles with vertices Y, W, X, Z, respectively. Show that YWXZ is a parallelogram.*

A parallelogram is generated by translation. So we try to find some mappings is a translation which takes *Y* to *W* and *Z* to *X*.
Thus,−→which give a translation as a product. Such a product is easy to find. *A*60◦◦ *C*−60◦ *YW* = −−→*WX*. Indeed, *A*60◦ *C*−60◦ *A*60◦
*C*−60◦*Y* =−→ *B* =−→ *W,* *Z* =−→ *D* =−→ *X.*

**E6.** *This is a generalization of the preceding example. Suppose, we replace the regular triangles with directly similar triangles. See Fig. 12.19. The result still seems to be a parallelogram.*

Indeed, with \|*AY*\|*/*\|*AB*\| = *r*, we have\ *Aα* ◦ *A*=1=◦ *C*(*r*) ◦ *C*−*α* = *f,* a translation*.* =−→ *X* ⇒
−→*YW* = −→*Y* =−→ *W,* *Z* *ZX.*

*f* *f*

**E7.** *Construct a parallelogram, given two opposite vertices A, C, if the other two vertices lie on a given circle.*

A parallelogram is a centrally symmetric figure. The center *M* is the midpoint of *AC*. A half turn about *M* interchanges the other two vertices, but they must lie on the reﬂected circle. So they are the intersections of the given circle and its reﬂection.

**E8.** *Construct a parallelogram ABCD, given the vertices A, C and the distances r and s of the points B and D from a given point E.*

Reﬂect *E* at the midpoint *M* of AC to *E*′. Now *B* is constructible from *EE*′and circles with radii *r* and *s* and centers *E* and *E*′, respectively.

**E9.** *Construct a parallelogram ABCD from C, D and the distances r and s of A and B from a given point E.*

The translation−→*AD* takes *E* to *E*′. Now △*DE*′*C* is constructible from the three sides \|*CD*\|*,* \|*DE*′\| = *r,*
\|*E*′*C*\| = *s*. Now translate *DC* by−−→*E*′*E*. The image of *DC* is *AB*.

312 12. Geometry

**E10.** *Two circles α and α*1 *and a point P are given. Find a circle which is tangent to α and α*1*, such that the line through the two points of tangency passes through P.*

pppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppp

314 12. Geometry

4. Three lines *x, y, z* are incident with a point *P* and are orthogonal to the sides *c, a, b* of a triangle *ABC*. Now *x, y, z* are reﬂected at the midpoints of *c, a, b* to *u, v, w*, respectively.
Prove that *u, v, w* also pass through a point *Q*.

5. Take a point *A* inside an acute angle. Construct the triangle *ABC* of minimum perimeter if *B* and *C* lie on the legs of the angle.

6. Two circles are tangent internally at point *A*. A secant intersects the circles in *M, N, P, Q*. Prove that*MAP* =*NAQ*.

7. A chord *MN* is drawn in a circle *ω*. In one of the circular segments, the circles *ω*1, *ω*2 are inscribed touching the arc in *A* and *C* and the chord in *B* and *D*. Show that the point of intersection of *AB* and *CD* is independent of the choice of *ω*1*,
ω*2.

8. Consider *n* circles *Ci* (*Cn*+1 = *C*1) with *Ci* touching *Ci*+1 externally at *Ti* for *i* = 1 to *n*. Start at any point *A*1 on *C*1, and, for *i* = 1 to *n*, draw straight lines *AiTi* intersecting *Ci*+1 a second time in *Ai*+1. What is the relative position of *A*1 and *An*+1 on *C*1? Generalize.

9. Assume a line *a* and a point *P*. Using as few lines as possible (circles or segments), construct the line perpendicular to *a* which passes through *P*. If *P* ̸∈ *a* the problem is well known to every high school student of geometry. But suppose *P* ∈ *a*. The minimal construction is hardly known. See the solution for a proof of our contention.

10. *A, B, C, D* are four points on a line. Through *A* and *B*, draw a pair (*a, b*) of parallels and, through *C* and *D*, another pair (*c, d*) of parallels so that (*a, b*)∪(*c, d*) = *P QRS* is a square.

11. Draw through a point *P* inside an angle a segment, which cuts off a triangle of minimum area.

12. On the sides *CA* and *CB* of △*ABC*, squares *CAMN* and *CBPQ* with centers *O*1 and *O*2 are constructed to the outside. The points *D* and *F* are the midpoints of the segments *MP* and *NQ*. Prove that the triangles *ABD* and *O*1*O*2*F* are rectangular and isosceles.

13. What can you say about lines *a* and *b* if *a* ◦ *b* ◦ *a* = *b*
◦ *a* ◦ *b*. Here we identify a line *a* with the reﬂection in *a*.

14. What is the relative position of *a, b, c, d* if *a* ◦ *b* ◦ *c*
◦ *d* = *b* ◦ *a* ◦ *d* ◦ *c*?

15. In a quadrilateral *ABCD*, we reﬂect *A* at *B* to *A*1, *B* at *C* to *B*1, *C* at *D* to *C*1, *D* at *A* to *D*1. Suppose, only *A*1*, B*1*, C*1*, D*1 are given. Reconstruct *ABCD*. Compare the areas of *ABCD* and *A*1*B*1*C*1*D*1.

16. In a quadrilateral *ABCD*, reﬂect *A* at *C* to *A*1, *B* at *D* to *B*1, *C* at *A* to *C*1, *D* at *B* to *D*1. Compare the areas of *ABCD* and *A*1*B*1*C*1*D*1.

17. On the sides *BC*, *CA*, and *AB* of triangle *ABC*, regular triangles with vertices *D*, *E*, and *F* are erected. Reconstruct *ABC* from *D, E, F*.

18. On the sides *AB* and *DA* of a parallelogram *ABCD*, regular triangles with vertices *E* and *F* are erected. Prove that *E, C, F* are vertices of a regular triangle.

19. On the sides of △*ABC*, the points *P*, *Q*, *R* are chosen, such that *AP* = 2*PB, BQ* = 2*QC, CR* = 2*RA*. Reconstruct the triangle from *P, Q, R*.

20. Construct a triangle *ABC* from two sides *b, c*, if it is known that the median *AD* divides the angle at *A* in the ratio 1 : 2, so that*BAD* = *α,DAC* = 2*α*, *α* being unknown.

12.2 Transformation Geometry 315

+-----------------------------------+-----------------------------------+
| *A*                               | > pppppppppp                      |
|                                   | pppppppppppppppppppppppppppppp*u* |
|                                   | > *w* *C*                         |
+===================================+===================================+ +-----------------------------------+-----------------------------------+

+-----------------------------------+-----------------------------------+
| 318                               | > 12. Geometry                   |
+===================================+===================================+
| 12.3                              | > Classical Euclidean Geometry    |
+-----------------------------------+-----------------------------------+

This topic is the most important one in competitions. At the IMO usually two of the six problems come from elementary geometry. Some of them can be treated conveniently with vectors, complex numbers, or transformation geometry. But usually ingenuity plus a few quite elementary facts from Euclidean geometry are required. We will not give a list of prerequisites, but just use them. We start with a set of easy problems, which can be used in a regular classroom. The main part consists of a mixture of more difficult to very hard problems. We give just one typical example.

**E1.** *One of the cross sections in a rectangular box is a regular hexagon. Prove that the box is a cube.*

**E1** belongs to the category of easy problems, yet it is by no means trivial. As soon as you have the right idea, it is immediately trivialized. The trivializing idea is to extend every second side of the hexagon to get a regular triangle. In Fig. 12.34 the vertices *K*, *L*, and *M* of this triangle lie on the extensions of the edges *AB*, *AA*1 and *AD* of the box. We have △*KLA*∼= △*LMA* since *KL* = *LM*, *KAL* =
̸ *LAM* = 90◦and *AL* is a common side. This implies *KA* = *MA*.
Similarly *KA* = *LA*. Since *PQ* = *KM/*3, we have *LPQ* ∼ *LKM* and *LPA*1 ∼*LKA*. Hence *AA*1 = 2*AL/*3, *AB* = 2*AK/*3, *AD* = 2*AM/*3.
This implies *AB* = *AA*1 = *AD*, i.e., the box is a cube. If the box is not rectangular, it can still have a cross section in the shape of a regular hexagon. Stretch the cube in Fig. 12.34 along the diagonal *AC*1.

*L*\ *C*1 *Q*\ *D*1\ *B*1 = A\ AA

12.3 Classical Euclidean Geometry 321

42. Suppose that the sun is exactly overhead. How should I hold a rectangular box over a horizontal table so that its shadow has maximum area?

43. Solve the preceding problem for a regular tetrahedron.

44. Take any convex *n*-gon. Select any *m* points inside of it. Cut the polygon into non intersecting triangles whose vertices are these *m* + *n* points. How many triangles do you get in terms of *m* and *n*?

45. Points of space are colored with five colors (all five colors do occur). Prove that there exists a plane, the points of which are colored by at least four different colors.

46. Many identical rectangular boxes are available. Give a practical method for measur ing a space diagonal.

47. The midpoints of the altitudes of a triangle are collinear. Find the shape of the triangle.

48. A convex quadrilateral is cut by its diagonals into four triangles of equal perimeter. What can you infer for the shape of this quadrilateral?

49. A point *P* is chosen inside a square, and parallels to the sides and diagonals are drawn through *P* . They split the square into eight parts, which we label 1 and 2 alternately around *P*. Prove that the parts labeled 1 and those labeled 2 have equal areas.

50. Any four of five circles have a common point. Prove that all five circles have a common point.

51. Two parallel planes and two spheres are given in space. The first plane touches the first sphere in *A*, the second plane touches the second sphere in *B*, and the spheres touch in *C*. Prove that *A, B, C* are collinear.

52. Can you cut a hole into a cube so that a slightly larger cube can pass through the hole?

53. An equilateral triangle *ABC* is inscribed in a circle. An arbitrary point *M* is chosen on the arc *BC*. Prove that \|*MA*\| =
\|*MB*\| + \|*MC*\|.

54. If the incircle of a quadrangle *ABCD* has radius *r*, then
\|*AB*\| + \|*CD*\| ≥ 4*r*.

55. Given three points in a plane, construct a quadrilateral for which these points are midpoints of three successive equal sides.

56. If the angles *α, β, γ* of a triangle satisfy cos 3*α* + cos 3*β* + cos 3*γ* = 1, then one of its angles is 120◦.

57. The base of a pyramid is an *n*-gon, *n* odd. Can you place arrows on the edges of this pyramid, such that the sum of the vectors is = −→*O* ?

58. Prove that a square has the smallest perimeter of all quadrilaterals circumscribed about a given circle of radius *r*.

59. From a point *O* inside an equilateral triangle *ABC*, perpendiculars *OM*, *ON*, *OP* are dropped onto the sides *BC, CA, AB*. Prove that \|*AP* \|+\|*BM*\|+\|*CN*\| does not depend on the location of the point *O*.

60. Circles with centers *O* and *O*′are disjoined. A tangent from *O* to the second circle intersects the first circle in *A* and *B*. A tangent from *O*′to the first circle intersects the second circle in *A*′and *B*′, and *A* and *A*′lie on the same side of *OO*′. Suppose we know the distances \|*AA*′\| = *a* and \|*BB*′\| = *b*. Find \|*OO*′\|.

322 12. Geometry

61. Let *ABCD* be a convex quadrilateral with area *F*. Suppose that
\|*AM*\|2+ \|*BM*\|2+ \|*CM*\|2+ \|*DM*\|2= 2*F* for some point *M* of the plane. What can you say about *A, B, C, D, M*?

62. A trapezoid *ABCD* is drawn on paper, together with the median *EF* connecting the midpoints of *AD* and *BC*, and the segment *OK* ⊥
*AB*, where *O* = *AC* ∩ *BD* and *K* ∈ *AB*. Now everything is erased except the segments *EF* and *OK*. Reconstruct the trapezoid.

63. A right triangle *D* is divided by its altitude into two triangles *D*1 and *D*2. Prove that the sum of the radii of the incircles of *D, D*1*, D*2 is equal to the altitude of *D*.

64. Inscribe squares with sides *x, y, z* into a triangle with sides *a, b, c*, so that two vertices lie on *BC*, *CA*, *AB*, respectively.
Then *x* = *y* = *z* ⇒ *a* = *b* = *c*.

65. In a triangle, *ha* = 12, *hb* = 20. Prove that 7*.*5 *\< hc \<* 30.

66. The distance between any two trees in a forest is less than the difference of their altitudes. Any tree has altitude *\<* 100 m. Prove that the forest can be surrounded by a fence of length 200 m.

67. The radii of the insphere and circumsphere of a tetrahedron are *r* and *R*, respectively. Prove or disprove that *R* ≥ 3*r*.

68. The skew edges of a tetrahedron are pairwise equal. Prove that the centers of its insphere and circumsphere coincide.

69. A point *O* inside a convex quadrilateral is joined to its vertices. Find the area of the quadrilateral with vertices in the centroids *S*1 to *S*4 of the four triangles *ABO*, *BCO*, *CDO*, *DAO*.

70. By means of a ruler in the shape of a semicircular disk draw the perpendicular to a given line *l* through a given point *A*.

71. Fig. 12.37 shows a four-bar linkage. The longest link *a* is fixed. When the shortest link *d* makes a complete revolution, the rocker *b* oscillates between two extreme positions. How do you find these extreme positions? Show that *a* + *d* ≤ *b* + *c*, i.e., the sum of the shortest and longest link does not surpass the sum of the other two links.

+-------+-------+-------+-------+-------+-------+-------+-------+-------+
| *A*   | <t    |       | *A*   | >     |       |       |       | 325   |
|       | able> |       |       |  12.3 |       |       |       |       |
|       | <colg |       |       | >     |       |       |       |       |
|       | roup> |       |       |  Clas |       |       |       |       |
|       | <     |       |       | sical |       |       |       |       |
|       | col s |       |       | >     |       |       |       |       |
|       | tyle= |       |       |  Eucl |       |       |       |       |
|       | "widt |       |       | idean |       |       |       |       |
|       | h: 50 |       |       | > Geo |       |       |       |       |
|       | %" /> |       |       | metry |       |       |       |       |
|       | <     |       |       |       |       |       |       |       |
|       | col s |       |       |       |       |       |       |       |
|       | tyle= |       |       |       |       |       |       |       |
|       | "widt |       |       |       |       |       |       |       |
|       | h: 50 |       |       |       |       |       |       |       |
|       | %" /> |       |       |       |       |       |       |       |
|       | <     |       |       |       |       |       |       |       |
|       | /colg |       |       |       |       |       |       |       |
|       | roup> |       |       |       |       |       |       |       |
|       | <t    |       |       |       |       |       |       |       |
|       | head> |       |       |       |       |       |       |       |
|       | <tr   |       |       |       |       |       |       |       |
|       | class |       |       |       |       |       |       |       |
|       | ="hea |       |       |       |       |       |       |       |
|       | der"> |       |       |       |       |       |       |       |
|       | <     |       |       |       |       |       |       |       |
|       | th><b |       |       |       |       |       |       |       |
|       | lockq |       |       |       |       |       |       |       |
|       | uote> |       |       |       |       |       |       |       |
|       | <p>   |       |       |       |       |       |       |       |
|       | =</p> |       |       |       |       |       |       |       |
|       | </b   |       |       |       |       |       |       |       |
|       | lockq |       |       |       |       |       |       |       |
|       | uote> |       |       |       |       |       |       |       |
|       | </th> |       |       |       |       |       |       |       |
|       | <th>@ |       |       |       |       |       |       |       |
|       | </th> |       |       |       |       |       |       |       |
|       | </tr> |       |       |       |       |       |       |       |
|       | </t   |       |       |       |       |       |       |       |
|       | head> |       |       |       |       |       |       |       |
|       | <t    |       |       |       |       |       |       |       |
|       | body> |       |       |       |       |       |       |       |
|       | </t   |       |       |       |       |       |       |       |
|       | body> |       |       |       |       |       |       |       |
|       | </t   |       |       |       |       |       |       |       |
|       | able> |       |       |       |       |       |       |       |
+=======+=======+=======+=======+=======+=======+=======+=======+=======+
|       |       |       |       | >     | *B*   | *D*   | > r   | > h   |
|       |       |       |       |  *C*\ |       |       | > *r* | >     |
|       |       |       |       | > *p  |       |       | > *M* | =*R*\ |
|       |       |       |       | *==@@ |       |       | > *r  | >     |
|       |       |       |       | >     |       |       | *Fig. |  *E*r |
|       |       |       |       |  *q*\ |       |       | >     | >     |
|       |       |       |       | > *P* |       |       | 12.47 |  *r*\ |
|       |       |       |       | > =   |       |       |       | > *C* |
|       |       |       |       | > @\  |       |       |       |       |
|       |       |       |       | >     |       |       |       |       |
|       |       |       |       |  *Qp* |       |       |       |       |
|       |       |       |       | > =   |       |       |       |       |
|       |       |       |       | > =AA |       |       |       |       |
|       |       |       |       | > A   |       |       |       |       |
|       |       |       |       | > *p* |       |       |       |       |
|       |       |       |       | > =   |       |       |       |       |
|       |       |       |       | > ==  |       |       |       |       |
|       |       |       |       | > *q* |       |       |       |       |
|       |       |       |       | > @ @ |       |       |       |       |
|       |       |       |       | > *q* |       |       |       |       |
+-------+-------+-------+-------+-------+-------+-------+-------+-------+
| *O*   |       |       |       | *D*   |       |       |       |       |
+-------+-------+-------+-------+-------+-------+-------+-------+-------+
|       | Fig.  |       |       |       |       |       |       | > *B* |
|       | 12.45 |       |       |       |       |       |       |       |
+-------+-------+-------+-------+-------+-------+-------+-------+-------+
|       |       |       | >     |       |       |       |       |       |
|       |       |       |  Fig. |       |       |       |       |       |
|       |       |       | >     |       |       |       |       |       |
|       |       |       | 12.46 |       |       |       |       |       |
+-------+-------+-------+-------+-------+-------+-------+-------+-------+

  -----------------------------------------------------------------------
  *P*   -----------------------------------------------------------------------

  -----------------------------------------------------------------------

+-------------+-------------+-------------+-------------+-------------+
| 326         | > 12.      | > *C*       | > Z         |             |
|             | > Geometry  |             |             |             |
+=============+=============+=============+=============+=============+
|             |             |             |             |             |
+-------------+-------------+-------------+-------------+-------------+
|             |             |             |             |             |
+-------------+-------------+-------------+-------------+-------------+

![](media/image10.png){width="1.2777777777777777in"
height="0.8055555555555556in"}

+---------+---------+---------+---------+---------+---------+---------+
| 330     | > 12.  |         | > *C*   | *P*     | *S*     | > *R*   |
|         | > G     |         |         |         |         |         |
|         | eometry |         |         |         |         |         |
+=========+=========+=========+=========+=========+=========+=========+
|         | *A*     |         |         | > ==    |         | > @=    |
|         |         |         |         | > ===HH |         |         |
|         |         |         |         | HHHHH== |         |         |
|         |         |         |         | > ===   |         |         |
|         |         |         |         | > ==    |         |         |
|         |         |         |         | > *B*\  |         |         |
|         |         |         |         | > Fig.  |         |         |
|         |         |         |         | > 12.61 |         |         |
+---------+---------+---------+---------+---------+---------+---------+
|         |         |         |         |         |         | *Q*     |
+---------+---------+---------+---------+---------+---------+---------+
|         |         |         |         |         |         | Fig.    |
|         |         |         |         |         |         | 12.62   |
+---------+---------+---------+---------+---------+---------+---------+

+-----------------+-----------------+-----------------+-----------------+
| ==*D*=\         |                 | <table>         |                 |
| =\              |                 | <colgroup>      |                 |
| =               |                 | <col style=     |                 |
|                 |                 | "width: 50%" /> |                 |
|                 |                 | <col style=     |                 |
|                 |                 | "width: 50%" /> |                 |
|                 |                 | </colgroup>     |                 |
|                 |                 | <thead>         |                 |
|                 |                 | <tr             |                 |
|                 |                 | class="header"> |                 |
|                 |                 | <th>@@</th>     |                 |
|                 |                 | <               |                 |
|                 |                 | th><blockquote> |                 |
|                 |                 | <p              |                 |
|                 |                 | ><em>C</em></p> |                 |
|                 |                 | </b             |                 |
|                 |                 | lockquote></th> |                 |
|                 |                 | </tr>           |                 |
|                 |                 | </thead>        |                 |
|                 |                 | <tbody>         |                 |
|                 |                 | </tbody>        |                 |
|                 |                 | </table>        |                 |
|                 |                 |                 |                 |
|                 |                 | @               |                 |
+=================+=================+=================+=================+
|                 |                 |                 |                 |
+-----------------+-----------------+-----------------+-----------------+
| @               |                 | ==              |                 |
|                 |                 |                 |                 |
| *A*             |                 | *B*             |                 |
+-----------------+-----------------+-----------------+-----------------+
|                 |                 |                 |                 |
+-----------------+-----------------+-----------------+-----------------+

43. The square *ABCD* in Fig. 12.62 must be placed horizontally. It is parallel to two opposite edges of the tetrahedron.

44. Let *x* be the number of triangles formed. We can compute the sum *S* of their angles in two ways. On the one hand, *S* = 180◦*x*. On the other hand, *S* = 360◦*m*+180◦(*n*−2). The first term is the sum of the angles of all *m* interior points. The second term is the sum of the angles of an *n*-gon. By equating the right sides of the two equations, we get *x* = 2*m* + *n* − 2.

Do this problem by induction, or use Euler's formula *f* + *v* = *e* + 2.

45. We denote the five colors by *a, b, c, d, e*. Corresponding points are denoted by *A, B, C, D, E*. We prove two lemmas.

*Lemma 1 (L1): Suppose the conditions of the problem are satisfied. If there exists a three-colored straight line, then there exists in space a four-colored plane.*

*Proof*. Suppose the straight line *v* consists of points with colors *a, b, c*. We know that there exists a point *D* in space with color *d*. Every plane (at least one) containing *v* and *D* is four-colored.

*Lemma 2 (L2): Suppose the conditions of the problem are satisfied. If there exists a three-colored plane and a straight line, which contains points of the two other colors, and which intersects this plane, then there exists a four-colored plane.*

*Proof*. Suppose the plane *S* contains points with colors *a, b, c* and *v* contains points with colors *d, e*. Let *P* ∈ *v* ∩ *S*. If *P* has one of the colors *a, b, c*, then *v* is threecolored, and according to L1 there exists a four-colored plane. If *P* has one of the colors *d* or *e*, then *S* is four-colored.

*Proof of the theorem*: If four of the points *A, B, C, D, E* are in one plane, then we are done. Otherwise *ABCD* is a tetrahedron. One of its faces, for instance, *S* = (*BCD*), separates the other two points *A* and *E*. Then line *AE* intersects the plane *S*, and the theorem is correct according to L2.

Otherwise, *E* is contained in the tetrahedron, and *A* ̸= *E*. Hence, *AE* intersects *S*, and the theorem is correct according to L2.

Since the problem is so simple, there are many other proofs. Let us sketch another one.

*m* intersect, the theorem is valid according to L2. Otherwise *ABCD* is four-colored.*Second proof*. Let *ABC* = *S*1*, CDE* = *S*2*, S*1∩*S*2 = *m, C* ∈ *m*. If *AB* or *DE* and

46. In Fig. 12.63, it is easy to measure the segment *AB*.

+-----------------+-----------------+-----------------+-----------------+
| 332             | > 12. Geometry | > *C*           |                 |
+=================+=================+=================+=================+
|                 |                 |                 |                 |
+-----------------+-----------------+-----------------+-----------------+

12.3 Classical Euclidean Geometry 333

But from (1), we have cos 3*α* + cos 3*β* = 1 − cos 3*γ* . This implies (2).

57. No! Project the vectors onto the altitude *SO* of the pyramid.
The projection of the vectors of the base is−→*O* . The projection of each lateral edge is ±−→*OS*. Adding them we get at least one vector
±−→*OS*. So the total sum is ̸= −→*O* .

58. The area of the inscribed circle is *r* · *p*, where *p* is the perimeter. Thus we can also minimize area. Let *Q* be the square circumscribed about the circle *C* with radius *r*, and let *C*′be the circle circumscribed about *Q*. We denote by *s* the segment cut off from *C*′by a side of the square. Then \|*Q*\| = \|*C*′\|−4*s* (Fig.
12.66). If *ABCD* in Fig. 12.67 is not a square, at least one vertex, in our case *D*, will lie inside *C*′. Any side of *ABCD* cuts off the same segment *s* from *C*′. Since at least two of the segments overlap (at D), the area \|*C*′\| − 4*s* is smaller than \|*ABCD*\|, i.e.,
\|*ABCD*\| *\>* \|*Q*\|.

*C*′ =*C* *C* =*D*= = ===== DD D D = D *s* = D *C*′ = D *A* [=]{.ul}\ [D]{.ul} *BQ*![](media/image11.png){width="1.1805555555555556in"
height="1.1805555555555556in"}

Fig. 12.66 Fig. 12.67

59. Draw perpendiculars through *A, B, C* to *AB, BC, CA*, respectively. We get△*A*′*B*′*C*′, where \|*OM*′\|*,* \|*ON*′\|*,*
\|*OP*′\| are the distances from *O* to the sides *B*′*C*′*, C*′*A*′*, A*′*B*′, respectively. Since \|*AP* \| = \|*OM*′\|*,* \|*BM*\| =
\|*ON*′\|*,* \|*CN*\| =\|*OP*′\|, we have \|*AP*\|+\|*BM*\|+\|*CN*\| =
\|*OM*′\|+\|*ON*′\|+\|*OP*′\|. But the right side is the sum of the distances of *O* from the sides of the equilateral triangle *A*′*B*′*C*′, which is a constant. If *a* is the side of △*ABC*, then this sum is the altitude of *A*′*B*′*C*′, i.e., 3*a/*2.

60. If *AA*′*B*′*B* is a trapezoid and *OO*′is its median, then
\|*OO*′\| = (*a* + *b*)*/*2.

61. *AM*2+ *BM*2≥ 2*AM* · *BM, BM*2+ *CM*2≥ 2*BM* · *CM, CM*2+ *DM*2≥2*CM* · *DM, DM*2+ *AM*2≥ 2*DM* · *AM*. Adding these inequalities and dividing by 2, we get *AM*2+*BM*2+*CM*2+*DM*2≥ *AM*
·*BM* +*BM* ·*CM* +*CM* ·*DM* + *DM* · *AM* = (*AM* + *CM*)(*BM* + *DM*) ≥ *AC* · *BD* ≥ 2*F*. The first inequality becomes an equality for *AM* = *BM* = *CM* = *DM*. The second inequality is valid if *AM*
⊥ *BM, BM* ⊥ *CM, CM* ⊥ *DM, DM* ⊥ *AM*. Thus *ABCD* is a square, and *M* is its center.

62. We use the following property: *O* the midpoint *M* of *EF* and the midpoint *N* of *AB* are collinear. *EN* and *FN* are the midlines of *ABD* and *BCD* and thus are parallel to the diagonals.

63. Drop the only nontrivial altitude *h* of *D* which splits the opposite side into segments of lengths *p* and *q*, *p* +*q* = *c*.
Denote the radii of the incircles by *r, r*1*, r*2. It is easy to prove that *r* = (*a*+*b*−*c*)*/*2. Do it! Hence, *r*1 = (*p*+*h*−*a*)*/*2, *r*2 = (*q* +*h*−*b*)*/*2, or *r* + *r*1 + *r*2 = *h*.

64. Prove that *x* = 2*A/*(*a* + *ha*), *y* = 2*A/*(*b* + *hb*), *c* = 2*A/*(*c* + *hc*), where *A* is the area of the triangle. *x* = *y* = *z* implies *a* + *ha* = *b* + *hb* = *c* + *hc*. Let *a* ̸= *b*.
Then*a* − *b* = *hb* − *ha* = 2*A/b* − 2*A/a* = 2*A*(*a* − *b*)*/*(*ab*) ⇒ 2*A* = *ab.*

12.3 Classical Euclidean Geometry 337

48. Twoacuteangles*α* and*β* satisfysin2*α*+sin2*β* = sin(*α*+*β*).Provethat*α*+*β* = *π/*2.49. Regular triangles *ABC*, *CDE*, and *EHK* (vertices given counterclockwise) withpairwise common vertices *C* and *E* are located in a plane so that−→*AD* = −→*DK*.
Prove that △*BHD* is also regular.

50. Prove that if the opposite sides of a skew quadrilateral are congruent, then the line joining the midpoints of the two diagonals is perpendicular to these diagonals, and conversely, if the line joining the midpoints of the two diagonals of a skew quadrilateral is perpendicular to these diagonals, then the opposite sides of the quadrilateral are congruent. (This is again USO 1977. Now we are looking for a short geometric solution.)

51. In △*ABC*, the bisectors of *α, β, γ* meet the circumcircle in *A*1, *B*1, *C*1. Prove that \|*AA*1\| + \|*BB*1\| + \|*CC*1\| *\>*
\|*AB*\| + \|*BC*\| + \|*CA*\| (AuMO 1982).

52. All angles in a convex hexagon are equal. Prove that the differences of opposite sides are equal.

53. From a variable point *P* of the circumcircle of triangle *ABC*, we drop the perpendiculars *P M* and *P N* to the straight lines *AB* and *AC*, respectively. For what position of *P* is \|*MN*\| maximal and find this maximal length?

54. If an acute triangle has circumradius *R* and perimeter *p*, then *p \>* 4*R*.

55. Let *A*1*A*2 ... *An* be a regular plane polygon, and let *P* be any point of the plane. Prove that one can construct some *n*-gon from the segments *P Ai, i* = 1*, ··· n*.

56. Prove that, if there exists a polygon with sides *a*1*, a*2*, . .
. an*, then there exists an inscribed polygon with these sides.

57. The six planes bisecting the angles of neighboring faces of a tetrahedron meet in one point.

58. The six planes through the midpoints of the edges of a tetrahedron and perpedicular to them pass through one point.

59. A space polygon is called regular, if all its sides are equal and all its angles are equal. In problem \# 12, we have shown that a space pentagon does not exist. For what *n* do regular space polygons exist, which are not plane?

60. Does a polyhedron exist with all of its plane sections triangular?

61. Prove that the sum of the lengths of all edges of a polyhedron is greater than 3*d*, where *d* is the distance of two vertices *A* an *B* of maximal distance.

62. (a) Every diagonal of a convex quadrilateral *ABCD* divides its area into two equal parts. Prove that *ABCD* is a parallelogram.

\(b\) The diagonals *AD*, *BE*, *CF* divide the convex hexagon *ABCDEF* into two equal parts. Prove that these diagonals pass through one point.

63. The circumscribed sphere of a tetrahedron *ABCD* has center *O*.
Find a simple condition for the tetrahedron so that *O* lies inside of it.

64. Find the highest number of acute angles in a plane, nonintersecting *n*-gon.

65. Three circles in space touch in pairs, and the three points of tangency are distinct. Prove that these circles lie on one sphere or in one plane.

66. If each vertex of a convex polyhedron is joined to every other vertex by edges, then it is a tetrahedron (HMO 1948).

340 12. Geometry

93. A rectangle is erected outwardly on every side of an inscribed quadrilateral *Q*. The second side of each rectangle is equal to the opposite side of *Q*. Prove that the midpoints of the four rectangles are vertices of a rectangle.

94. Perpendiculars *BE* and *CF* are dropped onto *AD* from the points *B* and *C* of a semicircle with diameter *AD*. The straight lines *AB* and *DC* intersect in *P* , and the segments *EC* and *BF* intersect in *Q*. Prove that *PQ* ⊥ *AD*.

95. Given a wooden ball, ruler and, compasses, construct the radius of the ball.

96. Three points are given on the surface of a wooden ball. Construct a circle through these points on the surface of the ball.

97. Two points are given on the surface of a wooden ball, which are not antipodes. Construct a great circle (circle of largest radius) through these two points.

98. 4 points are chosen in a 3 × 4 rectangle. Prove that among them there are two with distance ≤ 25*/*8.

99. Let *ABCDEF* be a convex hexagon such that *AB* ∥ *DB*, *BC* ∥
*EF* and *CD* ∥ *AF*. Let *RA*, *RC*, *RE* denote the circumradii of triangles *FAB*, *BCD*, *DEF*, respectively, and let *P* denote the perimeter of the hexagon. Prove that

*RA* + *RC* + *RE* ≥*P* (IMO 1996). 2

100. Prove that, if one of the diagonals in a cyclic quadrilateral is a diameter of the circumcircle, then the the projections of the opposite sides on the other diagonal are equal.

101. *P* is an internal point of the tetrahedron *ABCD*. At least how many edges can be seen at an obtuse angle from *P*?

102. Two convex polygons have an even number of vertices, and the midpoints of their edges coincide. Prove that they have equal areas.

103. Two nonoverlapping squares of sides *a* and *b* are placed inside a square of side 1. Prove that *a* + *b* ≤ 1 (HMO 1974;
originally due to Erd¨os).

Solutions

1. Suppose the source of light is in *O*. We construct a regular tetrahedron *ABCD* with center *O*. Consider the four infinite circular cones, each containing strictly the four pyramids *OBCD, OACD, OABC, OABD* and common vertex *O*. These cones partly intersect, so that every light ray from *O* lies inside some cone. Let us inscribe four spheres into the cones so that they do not intersect. This is easy to achieve if the radii of the spheres differ greatly from each other.
Obviously every ray from *O* intersects one of the four spheres. This cannot be achieved with four spheres of equal radius. It can be proved that six spheres of equal radius are needed to shield the light completely. Try to find such a distribution of equal spheres.

2. Yes, it is possible in both cases. For (a) an H-shaped slot will do. For (b) we can use a T-shaped slot. Try to describe how this can be done.

12.3 Classical Euclidean Geometry 341

3. Reﬂect the triangles *A*1*A*2*A*6, *A*2*A*3*A*4, and *A*4*A*5*A*6 at their bases, and you get a partition of the hexagon into three rhombi. From there it is easy to see that opposite angles are equal.
We leave it to the reader to complete this sketch.

4. If *O* ∈ *C*, the proposition is obvious. Now suppose that *O* ̸∈
*C*. Reﬂect *C* at *O* to *C*′. If *C* ∩ *C*′= ∅, the line *C* cannot partition the area into two equal parts. Hence *C* ∩ *C*′̸= ∅. Let *A* be one point of *C* ∩ *C*′and *B* its reﬂection at *O*. Since the curve *C*′has image *C* on reﬂection at *O*, *B* ∈ *C*. Hence, *AB* passes through *O*.

5. *Answer*: *n* must be a multiple of 8. This necessary condition is also sufficient as is shown by the two sums below:

(1 − 3 − 5 + 7) + (9 − 11 − 13 + 15) + ... = 0*,*

(2 − 4 − 6 + 8) + (10 − 12 − 14 + 16) + ... = 0*.*

6. *Answer*: *n* must be a multiple of 12. This necessary condition is also sufficient as is shown by the three sums below:

(1 − 4 − 7 + 10) + ... + (3*k* − 11 − (3*k* − 8) − (3*k* − 5) + 3*k* − 2) = 0*,*

(2 − 5 − 8 + 11) + ... + (3*k* − 10 − (3*k* − 7) − (3*k* − 4) + 3*k* − 1) = 0*,*

(3 − 6 − 9 + 12) + ... + (3*k* − 9 − (3*k* − 6) − (3*k* − 3) + 3*k*) = 0*.*

7. Suppose a convex hull of *N* points is an *r*-gon, 3 ≤ *r* ≤ *N*.
There will be (*N* − *r*) interior points. To find the number of triangles in a triangulation, we find the sum of the angles of all triangles of the triangulation: 180◦(*r* − 2) + 360◦(*N* − *r*). The first term is the sum of the angles of the *r*-gon. The second term gives the contribution of the interior points. The number of triangles is *r* − 2 + 2(*N* − *r*) = 2*N* − *r* − 2, and the number of its sides is 3(2*N* − *r* − 2) = 3(2*N* − 2) − 3*r*. Of these sides, the *r* sides of the convex hull are counted once and the remaining 3(2*N* − 2) − 4*r* sides are counted twice. Hence the number of segments will be *s* = *r* + 3*N* − 3 − 2*r*. Since 3 ≤ *r* ≤ *N*, we get 2*N* − 3 ≤
*s* ≤ 3*N* − 6 for the number of segments.

8. In Fig. 12.68, *A*1 to *A*4 are the areas of the four triangles.
We have *A*1*/A*4 = *A*2*/A*3, or *A*1*A*3 = *A*2*A*4. Thus, *A*1*A*2*A*3*A*4 = (*A*1*A*3)2.

9. Let *S* be the centroid of *H*, and *S*′= *f* (*S*). Then we have

+-------------+-------------+-------------+-------------+-------------+
| <table>     |             |             | =           | > *.*       |
| <colgroup>  |             |             |             |             |
| <col        |             |             |             |             |
|  style="wid |             |             |             |             |
| th: 50%" /> |             |             |             |             |
| <col        |             |             |             |             |
|  style="wid |             |             |             |             |
| th: 50%" /> |             |             |             |             |
| </colgroup> |             |             |             |             |
| <thead>     |             |             |             |             |
| <tr clas    |             |             |             |             |
| s="header"> |             |             |             |             |
| <th><table> |             |             |             |             |
| <colgroup>  |             |             |             |             |
| <col        |             |             |             |             |
| style="widt |             |             |             |             |
| h: 100%" /> |             |             |             |             |
| </colgroup> |             |             |             |             |
| <thead>     |             |             |             |             |
| <tr clas    |             |             |             |             |
| s="header"> |             |             |             |             |
| <th><       |             |             |             |             |
| blockquote> |             |             |             |             |
| <p><em>     |             |             |             |             |
| S</em> =1 < |             |             |             |             |
| em>S</em>′= |             |             |             |             |
| 1=<em>n</em |             |             |             |             |
| >(<em>A</em |             |             |             |             |
| >1 + ...  |             |             |             |             |
| + <em>An</e |             |             |             |             |
| m>) <em>,</ |             |             |             |             |
| em> <em>n</ |             |             |             |             |
| em> <em>A</ |             |             |             |             |
| em>′1+ · ·  |             |             |             |             |
| · + <em>A</ |             |             |             |             |
| em>′<em>n</ |             |             |             |             |
| em>But {<em |             |             |             |             |
| >A</em>′1<e |             |             |             |             |
| m>, ··· , |             |             |             |             |
|  A</em>′<em |             |             |             |             |
| >n</em>} is |             |             |             |             |
|  a permutat |             |             |             |             |
| ion of <em> |             |             |             |             |
| H</em>. Hen |             |             |             |             |
| ce, <em>S</ |             |             |             |             |
| em> = <em>S |             |             |             |             |
| </em>′.</p> |             |             |             |             |
| </block     |             |             |             |             |
| quote></th> |             |             |             |             |
| </tr>       |             |             |             |             |
| </thead>    |             |             |             |             |
| <tbody>     |             |             |             |             |
| </tbody>    |             |             |             |             |
| </table>    |             |             |             |             |
| <p          |             |             |             |             |
| >=</p></th> |             |             |             |             |
| <th>=</th>  |             |             |             |             |
| </tr>       |             |             |             |             |
| </thead>    |             |             |             |             |
| <tbody>     |             |             |             |             |
| </tbody>    |             |             |             |             |
| </table>    |             |             |             |             |
|             |             |             |             |             |
| *.*         |             |             |             |             |
+=============+=============+=============+=============+=============+
| *A*         |             |             | > *C*\      | > *B*       |
|             |             |             | >           |             |
|             |             |             |  \"\"\"\"JJ |             |
|             |             |             | >           |             |
|             |             |             |  =*D*==*A*4 |             |
|             |             |             | > P = P     |             |
|             |             |             | > *A*3 =    |             |
|             |             |             | > *A*1 P P  |             |
|             |             |             | > *A*2 P J  |             |
|             |             |             | > P J P     |             |
+-------------+-------------+-------------+-------------+-------------+

Fig. 12.68

10. We conjecture that *P* = *O* = the center of the pentagons. We want to show in Fig. 12.69 that=\|*P Ai*\| ≥=\|*OAi*\|, with equality iff *P* = *O*. *In a regular pentagon,*

342 12. Geometry

*you should try rotation about its center by* 72◦*!* This paradigm gives us Fig. 12.70, where, from *P* , we get the points *P*1*, ···
, P*5, then Fig. 12.71 where the segments *P*1*Ai* go by rotation into *A*1*Pi*, that is,=\|*P*1*Ai*\| ==\|*A*1*Pi*\|. Now we interpret the

*A*1*Pi* Then *O* is the centroid of points *Pi*, i.e.,

*A*1*O* =1= −−→*A*1*Pi.* 5\ The triangle inequality gives 5\|−−→*A*1*O*\| ==\|*OAi*\| = \|= −−→*A*1*Pi*\| ≤ \|*A*1*Pi*\| == \|*P*1*Ai*\|, that is, = \|*P*1*Ai*\|
≥ = \|*OAi*\|. We have equality iff *P* = *O*.*A*4 r*P*5 *A*4 *A*4 r*P*5

+-----------------------------------+-----------------------------------+
| 346                               | > 12. Geometry                   |
+===================================+===================================+
|                                   | > at *P, Q* intersect the sphere  |
|                                   | > in a circle, or they do not cut |
|                                   | > *S* at all. These circles are   |
+-----------------------------------+-----------------------------------+
|                                   | > pairwise disjoint, and their    |
|                                   | > union is *S*\\{*P, Q*}. Let *c* |
|                                   | > be a circle through *O* with    |
|                                   | > radius 1.Then all spheres *Sr*  |
|                                   | > := {*P*\|*d*(*P, Q*) = *r*} for |
|                                   | > 0 *\< r \<* 2, except the the   |
|                                   | > two points belonging to *c*,    |
|                                   | > can be partitioned. In this way |
|                                   | > we partition *M*                |
|                                   | > :==0*\<r\<*2*Sr* ∪ *c*, that is |
|                                   | > the open ball about *O* of      |
|                                   | > radius 2 plus one point *X*     |
|                                   | > with *d*(*O, X*) = 2. If we     |
|                                   | > translate *M* by all multiples  |
|                                   | > of 4, then all translates are   |
|                                   | > disjoint but cover the line     |
+-----------------------------------+-----------------------------------+
|                                   | > *OX*. Let *T* be the union of   |
|                                   | > these translates of *M* (which  |
|                                   | > consequently are partitioned    |
+-----------------------------------+-----------------------------------+
|                                   | > into disjoint circles). Let *=* |
|                                   | > be any plane perpendicular to   |
|                                   | > *OX*. Then *=*\\*T* is a plane  |
|                                   | > with a closed disk or point     |
|                                   | > missing. This can be            |
|                                   | > partitioned into concentric     |
|                                   | > circles                         |
+-----------------------------------+-----------------------------------+
|                                   | > about the midpoint of the disk. |
+-----------------------------------+-----------------------------------+

31. Yes. Here is one example: Take any straight line *a*. Through two points *A, B* ∈ *a* draw two lines *b, c*, so that *b* ⊥ *a*, *c* ⊥
*a*, and *b* ∦ *c*. Consider the set of all planes parallel to each other and parallel to *a*. Take any of these planes. The lines *b* and *c* intersect it in two points which we join by a straight line. This is done for every one of the parallel planes. We get a wall of skew lines separating space into two half spaces. Now consider all rotations around the axis *a*. The images of the wall give the required partition of space into skew lines.

Another nonelementary construction consists of the union of all hyperboloids of one sheet with the same focus. See \[14\].

32. Let *R, S, T, U* be the points of contact of the quadrilateral with the sphere. Assign the masses 1*/a,* 1*/b,* 1*/c,* 1*/d* to *A, B, C, D*, respectively. Because *a*(1*/a*) =*b*(1*/b*) = *c*(1*/c*) = *d*(1*/d*) = 1 the centroid of *A* and *B* is *R*, and the centroid of *C* and *D* is *T* . The centroid of all four masses lies on the segment *RT* . We can find the centroid in another way: *A, D* have the centroid *U* and *B, C* have the centroid *S*. Thus the centroid of all four vertices lies on the segment *SU*. Hence the two segments *SU* and *RT* must intersect in the centroid of all four points. Thus *R, S, T, U* are coplanar.

33. *Hint*: Easy! The axes of these cylinders are pairwise perpendicular.

34. Pick's theorem with *i* = *b* = 0 gives *f* (*ABC*) = 1*/*2 for the triangle. Heron's formula gives *s*(*s* − *a*)(*s* − *b*)(*s* − *c*) = 1*/*4. Simplifying we get that the square of any side is at least equal to the sum of the sqares of the other two sides. Thus for an acute triangle, at least one lattice point must be on the sides or inside.

35. Take the circle of **largest radius**, and consider a new concentric circle of **radius three times larger**. Now we remove all circles which are inside the new circle. The remaining circles do not intersect the first circle. Among the remaining circles, we take the **maximal circle**, and we repeat with it the same procedure. We continue until we get several blown up circles, with union greater than 1. The original circles of radius three times smaller do not intersect, and their common area is larger than 1*/*9.

36. Cut up the yard into 50 strips of width 2. Fig. 12.79 shows one of the strips *S* together with its horizontal symmetry line *m* of length 100. If the center of a barrel is outside *S*, then the barrel will have no point in common with *m*. These barrels will leave at most eight pieces of *m* uncovered. Each piece has length at most 10, because there cannot be a segment of length 10 having no point in common with any barrel. Under each barrel, there lies a piece of length at most 2. But 8 · 10 + 7 · 2 *\<* 100. Thus at least eight barrels have their centers inside *S*. This holds for each of the 50 strips. Hence there are at least 8 · 50 or 400 barrels inside the yard.

+-----------------+-----------------+-----------------+-----------------+
|   ------------- | 12.3 Classical  |                 | 351             |
|   ==     ==     | Euclidean       |                 |                 |
|   ------ ------ | Geometry        |                 |                 |
|   ==     ==     |                 |                 |                 |
|                 |                 |                 |                 |
|   ------------- |                 |                 |                 |
+=================+=================+=================+=================+
|                 |   --------      |                 | > 7             |
|                 | --------------- |                 |                 |
|                 |   2   4         |                 |                 |
|                 |          6   @@ |                 |                 |
|                 |   --- ----      |                 |                 |
|                 | ------ --- ---- |                 |                 |
|                 |   1             |                 |                 |
|                 | \`\`\`== 3      |                 |                 |
|                 |                 |                 |                 |
|                 | 5\              |                 |                 |
|                 |                 |                 |                 |
|                 | Fig. 12.86      |                 |                 |
|                 |                 |                 |                 |
|                 |   --------      |                 |                 |
|                 | --------------- |                 |                 |
+-----------------+-----------------+-----------------+-----------------+
| Fig. 12.85      |                 |                 |                 |
+-----------------+-----------------+-----------------+-----------------+

  -----------------------------------------------------------------------

  -----------------------------------------------------------------------

  -----------------------------------------------------------------------

  -----------------------------------------------------------------------

  ----------------------------------- -----------------------------------

  ----------------------------------- -----------------------------------

60. Take a section parallel to an edge *e* intersecting all edges which end in *e*. Since at least two other edges have ends at each endpoint of *e*, the section has at least four vertices.

61. Construct planes perpendicular to *AB* through *A* and *B*. Draw a plane perpendicular to *AB* through each other vertex of the polyhedron. Consider two neighboring planes. Between them there are at least three segments of edges. Each segment is at least as long as its projection on *AB*. In addition there are segments not parallel to *AB*. Thus, the sum of all the edges is greater than 3*d*.

Expressed more brieﬂy, the orthogonal projection of the carcass of the polyhedron on *AB* covers the segment *AB* at least three times.

62. Easy.

63. Reﬂect the spherical triangle *ABC* in *O* to *A*′*B*′*C*′. Then *D*′must lie inside *A*′*B*′*C*′.64. Let *k* be the number of acute angles in an *n*-gon. We can express the sum of its angles in two ways.
First, it is *k* · 90◦+ (*n* − *k*) · 360◦, and secondly, it is also (*n* − 2) · 180◦.

Thus, *k* · 90◦+ (*n* − *k*) · 360◦*\>* (*n* − 2) · 180◦, i.e., 3*k
\>* 2*n* + 4. Consequently, *k* ≤ \[2*n/*3\] + 1. Fig. 12.87 shows examples of *n*-gons with \[2*n/*3\] + 1 acute angles for *n* = 3*r, n* = 3*r* + 1*, n* = 3*r* + 2.

XXX XXXXXX\ == == ==\ =

12.3 Classical Euclidean Geometry 353

\(b\) First we show that we can interchange *u* and *v* in the first inequality (1). Indeed, reﬂect *P* at the bisector of *γ* to *P*′.
Then \|*CP* \| = \|*CP*′\| = *z*, and the distances from *P*′to *BC* and *AC* are *y* and *x*, respectively. Applying the above inequality to *P*′, we get

*cz* ≥ *av* + *bu,* and similarly, *ax* ≥ *bw* + *cv,* *by* ≥ *aw* + *cu.* (2)

Solving the inequalities (2) for *x, y, z* and adding, we get

*x* + *y* + *z* ≥=*bc*+ *c*=*u* += *ca*+ *a*=*v* +=*ba*+ *a*=*w* ≥ 2(*u* + *v* + *w*)*.*

= == = = == = = == =This is the famous *Erd˝os--Mordell inequality*, first posed by Erd˝os in 1935 in the *American Mathematical Monthly* and solved by Mordell in 1937. There is equality for the equilateral triangle.

\(c\) From the inequalities (1) we get *xu* = *b/auv* + *c/awu* and similarly, *yv* =*a/buv* + *c/bwu, zw* ≥ *a/cuw* + *b/cvw*. Adding, we get

*xu*+*yv*+*zw* ≥=*ba*+ *a*=*uv*+=*bc*+ *c*=*vw*+=*ac*+ *c*=*wu* ≥ 2(*uv*+*vw*+*wu*)*.*72. Given a quadrilateral *ABCD* with *a* + *c* = *b* + *d* and area *A* =_sqrt_*abcd*, we want to prove that *β* + *δ* = *π*.
We can express the square of *AC* in two ways:

*a*2+ *b*2− 2*ab* cos *β* = *c*2+ *d*2− 2*cd* cos *δ.* (1)

From *a* + *c* = *b* + *d*, we get (*a* − *b*)2= (*c* − *d*)2, or

*a*2+ *b*2− 2*ab* = *c*2+ *d*2− 2*cd.* (2)

Subtracting (2) from (1) and dividing by 2, we get

*ab*(1 − cos *β*) = *cd*(1 − cos *δ*)*.* (3)

The area of *ABCD* can be expressed in two ways and equated:

*ab* _sqrt_2 sin *β* + *cd*2 sin *δ* = *abcd.*

Multiplying by two and squaring, we get

4*abcd* = *a*2*b*2(1 − cos2*β*) + *c*2*d*2(1 − cos2*δ*) + 2*abcd* sin *β* sin *δ.*

Using (3), we get

4*abcd* = *ab*(1 + cos *β*)*cd*(1 − cos *δ*) + *cd*(1 + cos *δ*)*ab*(1 − cos *β*)

\+ 2*abcd* sin *β* sin *δ.*

Dividing by *abcd*, expanding and collecting terms, we get

cos(*β* + *δ*) = −1 ⇒ *β* + *δ* = *π.*

This is a Putnam Competition problem. The other two problems are left to the reader.

+-------+-------+-------+-------+-------+-------+-------+-------+-------+
| *W*   | *O*4  | >     |       |       |       |       |       |       |
|       |       |  *U*\ |       |       |       |       |       |       |
|       |       | > *   |       |       |       |       |       |       |
|       |       | V*!!! |       |       |       |       |       |       |
|       |       | !!LL\ |       |       |       |       |       |       |
|       |       | >     |       |       |       |       |       |       |
|       |       | ppppp |       |       |       |       |       |       |
|       |       | ppppp |       |       |       |       |       |       |
|       |       | ppppp |       |       |       |       |       |       |
|       |       | ppppp |       |       |       |       |       |       |
|       |       | ppppp |       |       |       |       |       |       |
|       |       | ppppp |       |       |       |       |       |       |
|       |       | ppppp |       |       |       |       |       |       |
|       |       | ppppp |       |       |       |       |       |       |
|       |       | ppppp |       |       |       |       |       |       |
|       |       | ppppp |       |       |       |       |       |       |
|       |       | ppppp |       |       |       |       |       |       |
|       |       | ppppp |       |       |       |       |       |       |
|       |       | ppppp |       |       |       |       |       |       |
|       |       | ppppp |       |       |       |       |       |       |
|       |       | ppppp |       |       |       |       |       |       |
|       |       | ppppp |       |       |       |       |       |       |
|       |       | ppppp |       |       |       |       |       |       |
|       |       | ppppp |       |       |       |       |       |       |
|       |       | ppppp |       |       |       |       |       |       |
|       |       | ppppp |       |       |       |       |       |       |
|       |       | ppppp |       |       |       |       |       |       |
|       |       | ppppp |       |       |       |       |       |       |
|       |       | ppppp |       |       |       |       |       |       |
|       |       | ppppp |       |       |       |       |       |       |
|       |       | ppppp |       |       |       |       |       |       |
|       |       | ppppp |       |       |       |       |       |       |
|       |       | ppppp |       |       |       |       |       |       |
|       |       | ppppp |       |       |       |       |       |       |
|       |       | ppppp |       |       |       |       |       |       |
|       |       | ppppp |       |       |       |       |       |       |
|       |       | ppppp |       |       |       |       |       |       |
|       |       | ppppp |       |       |       |       |       |       |
|       |       | ppppp |       |       |       |       |       |       |
|       |       | ppppp |       |       |       |       |       |       |
|       |       | ppppp |       |       |       |       |       |       |
|       |       | ppppp |       |       |       |       |       |       |
|       |       | ppppp |       |       |       |       |       |       |
|       |       | ppppp |       |       |       |       |       |       |
|       |       | ppppp |       |       |       |       |       |       |
|       |       | ppppp |       |       |       |       |       |       |
|       |       | ppppp |       |       |       |       |       |       |
|       |       | ppppp |       |       |       |       |       |       |
|       |       | ppppp |       |       |       |       |       |       |
|       |       | ppppp |       |       |       |       |       |       |
|       |       | ppppp |       |       |       |       |       |       |
|       |       | ppppp |       |       |       |       |       |       |
|       |       | ppppp |       |       |       |       |       |       |
|       |       | ppppp |       |       |       |       |       |       |
|       |       | ppppp |       |       |       |       |       |       |
|       |       | ppppp |       |       |       |       |       |       |
|       |       | ppppp |       |       |       |       |       |       |
|       |       | ppppp |       |       |       |       |       |       |
|       |       | ppppp |       |       |       |       |       |       |
|       |       | ppppp |       |       |       |       |       |       |
|       |       | ppppp |       |       |       |       |       |       |
|       |       | ppppp |       |       |       |       |       |       |
|       |       | ppppp |       |       |       |       |       |       |
|       |       | ppppp |       |       |       |       |       |       |
|       |       | ppppp |       |       |       |       |       |       |
|       |       | ppppp |       |       |       |       |       |       |
|       |       | ppppp |       |       |       |       |       |       |
|       |       | ppppp |       |       |       |       |       |       |
|       |       | ppppp |       |       |       |       |       |       |
|       |       | ppppp |       |       |       |       |       |       |
|       |       | ppppp |       |       |       |       |       |       |
|       |       | > LL  |       |       |       |       |       |       |
|       |       | >     |       |       |       |       |       |       |
|       |       |  *O*3 |       |       |       |       |       |       |
|       |       | > L\  |       |       |       |       |       |       |
|       |       | > L   |       |       |       |       |       |       |
|       |       | > =@  |       |       |       |       |       |       |
|       |       | > L   |       |       |       |       |       |       |
|       |       | > *C* |       |       |       |       |       |       |
+=======+=======+=======+=======+=======+=======+=======+=======+=======+
|       |       |       |       |       |       |       |       |       |
+-------+-------+-------+-------+-------+-------+-------+-------+-------+
|       |       |       |       |       |       |       |       |       |
+-------+-------+-------+-------+-------+-------+-------+-------+-------+
|       |       |       |       |       |       |       |       |       |
+-------+-------+-------+-------+-------+-------+-------+-------+-------+
|       |       |       |       |       |       |       |       |       |
+-------+-------+-------+-------+-------+-------+-------+-------+-------+
|       |       |       |       |       |       |       |       |       |
+-------+-------+-------+-------+-------+-------+-------+-------+-------+

360 12. Geometry

△*M*′*N*′*P*′ ∼= △*MNP*, and find its circumcircle with center *O*′.
Then *M*′*O*′is the radius of the circumcircle. From the leg *M*′*O*′and hypotenuse *A*′*M*′, which is *AM*, we construct a right triangle *M*′*O*′*A*′. We construct the perpendicular to *M*′*A*′which intersects the line *A*′*O*′in *B*′. Then *A*′*B*′is equal to the diameter *AB*.

96. In the plane we construct △*A*′*B*′*C*′ ∼= △*ABC* and find its circumcircle. Then we find the radius *R* of the ball as in the preceding problem. After drawing a circle with radius *R*, we draw a chord *K*′*L*′into it which is equal to the diameter of the circumcircle. The distance from *K*′to the midpoint *P*′of the arc *K*′*L*′is the radius of the circle on the ball through *A*, *B*, *C*.
We get the midpoint of the circle by drawing about *A* and *B* circles with distance *K*′*P*′. They intersect in the center of the circle through *A, B, C*.

97. Draw circles on the ball about *A* and *B* with the same radius which intersect in *K, L*. Draw circles about *K* and *L* with the same radius which intersect in *M, N*. Then *M, N* lie together with *A* and *B* on the great circle. From *A, B, M*, we can construct the circle.

98. *Hint*: It is easy to see that the minimum distance between the four points is maximal, when they are vertices of a rhombus with side 25*/*8, two opposite vertices of which are vertices of the rectangle, and the remaining two lie on the long sides of the rectangle.

99. This is the most difficult problem ever proposed at the IMO.
Before 1996, the most difficult problem was **E15** in Chapter 6.
Although the jury correctly judged the extreme difficulty of **E15**, it estimated the difficulty of this problem as medium. We give no proof, but if you are interested you can find the solution in many sources.

13

Games

We begin by describing so-called *Nim Games* in some detail. Most of the games in competitions are of this type, but some do not fit into any category known to the contestant. Still, most of the following definitions are useful even in those situations.

We consider games for two players *A* and *B*, who move alternately.
*A* always moves first but otherwise the rules are the same for *A* and *B*. A draw cannot occur. We are given the starting state and the set *M* of legal moves. A player loses if he finds himself in a position from which no legal move can be made. We can think of each position as a vertex of a graph and each move as a directed edge. We consider games with finitely many vertices and no directed circuit (a position can not repeat). This ensures that one of the players will lose.

The set *P* of all positions can be partitioned into the set *L* of losing and the set *W* of winning positions: *P* = *L* ∪ *W*, *L* ∩ *W* = ∅. A player finding himself in a position in *L* will lose provided his opponent plays correctly. A player finding herself in a position in *W* can force a win whatever her opponent does.

To win, a player must always move so as to force his opponent into a position belonging to *L*. From each position in *L*, every move must result in a position in *W*. From every position in *W*, a move to a position in *L* must be possible. *L* must contain at least one final position *f* from which there is no move out. The player who leaves his opponent facing such a position has won the game. The problem is to identify the set *L* of losing positions.

*Most of the following problems can be solved by a simple strategy*:

**Divide the set of all positions into pairs, so that there is a move from the first to the second element of the pair. Whenever my opponent occupies one**

362 13. Games

**element of a pair, I move to the other element of the pair. Thus, I win, since my opponent runs out of moves first.**

Initially, if there is one position without a pair, I should occupy it.
Otherwise, I should be the second player to win. In more complicated games, a table of losing positions should be used in playing.

As a warmup, we will consider some examples with solutions.

1. *Bachet's Game*. Initially there are *n* checkers on the table.
The set of legal moves is the set *M* = {1*,* 2*,* 3*, ··· , k*}.
The winner is the one to take the last checker. Find the losing positions.

The set *L* consists of all multiples of *k* + 1. Indeed, if *n* is not a multiple of *k* + 1, then I can always move to a multiple of *k* + 1. My opponent cannot move to the next multiple of *k* + 1 since he can only subtract *k* or less checkers. So he has to move to some number, which is not a multiple of *k* + 1. Then I simply move into *L*. Thus, I will finally reach 0, which is also a multiple of *k* + 1.

2. In problem #1, let *M* = {1*,* 2*,* 4*,* 8*,* ...} (any power of 2). Find the set *L*.

*L* consists of all multiples of 3. Indeed, a player confronted with a multiple of 3 cannot move to another multiple of 3, since 2*m*is never a multiple of 3. But from a nonmultiple of 3, I can always move to a multiple of 3, by subtracting 1 or 2 mod 3.

3. In problem #1, let *M* = {1*,* 2*,* 3*,* 5*,* 7*,* 11*, ···*} (1 and primes). Find *L*.

*L* consists of all multiples of 4. From a nonmultiple of 4, I can always move to a multiple of 4 by subtracting 1*,* 2 or 3 mod 4. But from a multiple of 4, I cannot move to another multiple of 4.

4. Find the set of losing positions for *M* = {1*,* 3*,* 8}.

Translate the game into a board game by starting with a row of empty cells. Then place a chip on the *n*th cell. Now *A* and *B* alternately move the chip to the left by 1 or 3, or 8 places. Start at the end and work upward by finding the losing positions until you detect a periodicity. You will find that *L* consists of all nonnegative integers of the form 11*n,* 11*n* + 2*,* 11*n* + 4*,* 11*n* + 6.

Problems

1. *Wythoff's Game*: There are two piles of checkers on a table. *A* takes any number of checkers from one pile or the same number of checkers from each pile. Then *B* does the same. The winner is the one to take the last chip. Positions are pairs \[*x*(*i*)*, y*(*i*)\] of nonnegative integers. By starting with small numbers, try to find the losing positions until you see a recursive rule. Also try to find a
"closed" expression for the positions in *L*.

13. Games 363

2. There are initially 107chips on a table. The set of moves consists of *pn*, where *p* is any prime and *n* can be any nonnegative integer. The winner is the one to take the last chip. Find *L*.

3. Start with *n* = 2. Two players *A* and *B* move alternately by adding a proper divisor of *n* to the current *n*. The goal is a number ≥ 1990. Who wins?

4. A modification of Wythoff's game. You may remove any number from a single pile, or numbers from both piles differing in absolute value by less than 2. Find some pairs belonging to *L* by trial and error. Can you find formulas for the pairs in *L*?

5. *A* and *B* alternately put white and black knights on the squares of a chessboard, which are unoccupied. In addition a knight may not be placed on a square threatened by an enemy knight (of the other color).
The loser is the one who cannot move any more. Who wins?

6. *A* and *B* place white and black bishops on squares of a chessboard, which are free and not threatened by an enemy bishop. The loser is the one who cannot move any more. (The one who moves may place his bishop on squares of both colors.)

7. *A* and *B* alternately draw diagonals of a regular 1988-gon. They may connect two vertices if the diagonal does not intersect an earlier one. The loser is the one who cannot move. Who wins?

8. Given a triangular cake *PQR* of area 1, *A* chooses a point *X* of the plane. *B* makes a straight cut through *X*. What maximal area can *B* cut off?

9. Given a triangle *P QR* of area 1, *A* chooses a point *X* ∈ *P Q*. Then *B* chooses a point *Y* ∈ *QR*. Then again *A* chooses a point *Z* ∈ *PR*. The aim of the first player is to maximize \|*XYZ*\|.
What is the largest area he can secure for himself?

10. (One-person game.) There are 1990 boxes containing 1*, ··· ,* 1990 chips, respectively, on a table. You may choose any subset of boxes and subtract the same number of chips from each box. What is the minimum number of moves you need to empty all boxes?

11. *A* and *B* alternately place +, −, · into the free places between the numbers 1 2 3 *···* 99 100. Show that *A* can make the result (a) odd, (b) even.

12. *A* and *B* start with *p* = 1. Then they alternately multiply *p* by one of the numbers 2 *A* or *B*?to 9. The winner is the one who first reaches (a) *p* ≥ 1000, (b) *p* ≥ 106. Who wins,

13. *A* crosses out any 27of the numbers 0*,* 1*, ··· ,* 255*,* 256.
Then *B* crosses out any 26numbers. Then *A* crosses out any 25numbers, and so on until finally *B* crosses out 20= 1 number. Since 27+ 26+ ...
+ 20= 28− 1 numbers are crossed out, there will be two numbers *a* and *b* left. *B* pays the difference \|*a* − *b*\| to *A*. How should *A* play to get as much as possible? How should *B* play to lose as little as possible?

How much does *A* win per game if both players use their optimal strategies?

14. *A* and *B* take turns in placing a′′+′′sign or a′′−′′sign in front of one of the numbers in the sequence 1 the absolute value of the sum. Find the best strategy for each player. How much does 2 3 4 ·
· · 19 20. After all 20 signs have been placed, *B* wins *B* win if both players use their best strategies?

15. In the equation *x*3+ ... *x*2+ ... *x* + ... = 0, *A* replaces one of the three dots by an integer unequal to 0. Then *B* replaces one of the remaining dots by an integer. Finally *A* replaces the last dots by an integer. Prove that *A* can play so that all three roots of the resulting cubic equation are integers.

364 13. Games

16. *A* and *B* alternately replace the stars in the polynomial *x*10+ ∗*x*9+ ∗*x*8+ ... +∗*x*2+ ∗*x* + 1 by real numbers. If the resulting polynomial has no real roots, then *A* wins. If it has at least one real root, then *B* wins. Can *B* win, whatever *A* does?

17. *A* and *B* alternately write positive integers ≤ *p* on the blackboard. Writing divisors of numbers that are already written is not allowed. The one who cannot move any more loses. Who wins for (a) *p* = 10? (b) *p* = 1000?

18. *Double Chess*. The rules of the chess are changed as follows:
Black and White make alternately two legal moves. Show that there exists a strategy for white which guarantees him at least a tie.
(*Note*: You need only prove the *existence* of such a strategy.)

19. On any directed graph with one highest and one lowest node, *A* puts a chip on any node. Than *B* puts a chip on a an unoccupied node, and so on. If a node is occupied, all lower nodes are forbidden. The player who is forced to place a chip on the highest node loses. Prove that the first player wins if he plays correctly. (*Note*: You are not asked to find the winning strategy. You only need to prove that it exists.)

20. *Even Wins*. Initially there is a supply of (2*n*+1) chips. *A* and *B* take turns to remove any number of chips from 1 to *k*. At the end, one of the players winds up with an even number of chips, the other with an odd number. The winner is the one who possesses an even number of chips. Find the losing position for (a) *k* = 3, (b) *k* = 4, (c) even *k*, (d) odd *k*.

Consider also the case that *Odd Wins*. See \[28\].

21. Initially there is a chip at the corner of an *n* ×
*n*-chessboard. *A* and *B* alternately move the chip one step in any direction. They may not move to a square already visited. The loser is the one who cannot move. (a) Who wins for even *n*? (b) Who wins for odd *n*? (c) Who wins if the chip starts on a square, which is neighbor to a corner square?

22. *A* places a knight onto an 8 × 8 board. Then *B* makes a legal chess move. Then *A* makes a move, but he may not place it on a square visited before, and so on. The loser is the one who cannot move any more. Who wins?

23. A king is placed at the upper left corner of an *m* × *n* chessboard. *A* and *B* move the king alternately, but the king may not move to a square occupied earlier. The loser is the one who cannot move. Who has a winning strategy?

24. Start with a pile of *n* chips. *A* and *B* move alternately. At his first move, *A* takes any number *s* so that 0 *\< s \< n*. From then on, a player may take any number which is a divisor of the number of chips taken at the preceding move. The winner is the one who makes the last move. Which initial positions are winning for *A* or *B*?

25. Let *n* be a positive integer and *M* = {1*,* 2*,* 3*,* 4*,* 5*,* 6}. *A* starts with any digit from *M*. Then *B* appends to it a digit from *M*, and so on, until they get a number with 2*n* digits. If the result is a multiple of 9, then *A* wins; otherwise *B* wins. Who wins, depending on *n*?

26. Start with two piles of *p* and *q* chips, respectively. *A* and *B* move alternately. A move consists in taking a chip from any pile, taking a chip from each pile, or moving a chip from one pile to the other. The winner is the one to take the last chip. Who wins, depending on the initial conditions?

13. Games 365

27. Start with two piles of *p* and *q* chips, respectively. *A* and *B* move alternately. A move consists in removing any pile and splitting the other pile into two piles. The loser is the one who cannot move any more. Who wins, depending on the initial conditions?

28. Start with *n* ≥ 12 successive positive integers. *A* and *B* alternately take one integer, until only two integers *a* and *b* are left. *A* wins if gcd(*a, b*) = 1, and *B* wins if gcd(*a, b*) *\>* 1.
Who wins?

29. Two players *A* and *B* alternately color lattice squares of a 19
× 94 square. Who has a winning strategy? A lattice square is any square of the board whose vertices are lattice points of the 19 × 94 board (MMO 1994).

30. *A* and *B* alternately move a knight on a 1994 × 1994 chessboard. *A* makes only horizontal moves (*x, y*) =→ (*x* ± 2*, y*
± 1), *B* makes only vertical moves (*x, y*) =→(*x* ± 1*, y* ± 2). *A* starts by choosing a square and making a move. Visiting a square for a second time is not permitted. The loser is the one who cannot move.
Prove that *A* has a winning strategy (ARO 1994).

31. *A* calls out a digit. Then *B* places that digit into one of the empty cells, until all 8 cells are filled by digits. *A* wants to maximize the difference. *B* tries to make it as small as possible.
Prove that *B* can place the digits so that the difference is at most 4000. *A* can call digits such that the difference is at least 4000.

  ----------------- ----------------- ----------------- -----------------
                                                        

  ----------------- ----------------- ----------------- -----------------

--

32. *A* and *B* alternately color squares of a 4 × 4 chessboard. The loser is the one who first completes a colored 2 × 2 subsquare. Who can force a win?

33. *A* and *B* alternately replace the stars in *x*4+ *⋆x*3+ *⋆x*2+ *⋆x* + *⋆* = 0 by integers of their choice. *A* wins if he gets a polynomial without integral roots after the fourth step. Otherwise *B* wins. Who wins, *A* or *B*?

34. Two players *A* and *B* alternately take chips from two piles with *a* and *b* chips, respectively. Initially *a \> b*. A move consists in taking a multiple of the other pile from a pile. The winner is the one who takes the last chip in one of the piles. Show that\ (a) If *a \>* 2*b*, then the first player *A* can force a win.

\(b\) For what *α* can *A* force a win, if initially *a \> αb*. (This game of Euclid is due to Cole and Davie, *Math. Gaz*. LIII, 354--7 (1969).)

35. *A* marks any free cell of a 2*n* × 2*n* board. Then *B* places a 1 × 2 domino on the board so that it covers 2 free cells, one of which is marked. *A* wins if it is possible to cover the whole board by dominos, otherwise *B* wins. Who wins?

36. A solitaire game. Each edge of a 1997-polyhedron is assigned the number +1 or−1. Show that there exists a vertex such that the product of the numbers on all edges meeting in that vertex must be +1.

Solutions

1. The table of the first 13 losing positions is

13. Games 369

17. In both cases *A* wins. (a) *A* writes 6. Then *B* writes one of the numbers of the pairs (4*,* 5), (7*,* 8), (9*,* 10). *A* responds with the other number of the pair.

\(b\) We consider a new game: the rules are the same, but among the numbers, the number 1 is missing. If *A* has a winning strategy in this case, then he uses it immediately. If not, then first he writes 1 and then uses the winning strategy of the second player. Note that in this case we do not explicitly describe the winning strategy of *A*.
Rather we prove its existence.

18. Suppose *B* can win no matter what *A* does. On his first move, *A* moves one of his knights to any one of the two possible squares and then back to its original position. Now all the pieces are in their original position, but *A* has become the second player and must win. Contradiction!

19. We consider a new game: the rules are the same, but the lowest node is forbidden. If *A* has a winning strategy in this case, then he uses it immediately. If not, then he first puts a chip on the lowest node and then uses the winning strategy of *B*.

20. (c) Check that for even *k* the losing positions are (*k*+1 mod *k*+2*, odd*), (0 mod *k*+ 2*, odd*), (1 mod *k* + 2*, even*).

\(d\) Check that for odd *k* the losing positions are (1 mod 2*k* + 2*, even*), (*k* + 2 mod 2*k* + 2*, odd*), (0 mod 2*k* + 2*, odd*), (*k* + 1 mod 2*k* + 2*, even*).

21. (a) If *n* is even, then one can always partition the board into 2 × 1 dominoes. *A* can always make a move. If the chip is on one square of a domino, he moves to the other square.

\(b\) For odd *n*, one can split the board into 2 × 1 dominoes, except the corner square. Then a similar strategy is winning for *B*.

\(c\) In this case, *A* always wins. For even *n*, the strategy is the same as in a). For odd *n*, we partition the board into dominoes except the corner square. Now we color the board in the usual way. It is easy to see that *B* can never move to a corner square. Thus, *A* wins by the strategy of moving to the second square of a domino.

22. Split the board into eight 4 × 2 rectangles. On each such rectangle, there is a unique move to another square of this rectangle.
Then *B* can win as follows. For each move of *A*, he moves the knight to the only possible square of the same rectangle.

23. Subdivide the chessboard into 2 × 1 dominoes. Whenever *A* places the king on a domino, *B* should move it to the other square of the same domino. In this way *B* wins the game.

24. We will prove that, for *n \>* 1, *B* wins if *n* = 2*m*. Let *n* = 2*m*(*n \>* 1). *A* takes first he takes 2*a*chips, and from then on he uses as many as *A* has taken before. *A* wins 2*a*(2*b* +1) chips (*a* ≥ 0*, b* ≥ 0). Then *B* wins if he uses the following strategy.
First he mimicks his opponent.if initially there are *n* = 2*a*(2*b* + 1) chips. First he takes 2*a*chips and from then on

25. *Answer*: If *n* is a multiple of 9, then *B* wins; otherwise *A* wins.

Suppose 9\|*n*. If *A* appends any digit *x*, then *B* appends 7−*x*.
At the end, the resulting number has digital sum 7*n*. Thus the resulting number is divisible by 9. So *B* wins. If 7*n* is not a multiple of 9, then 7(*n* − 1) ≡ 2 mod 9 = *r* with *r* ̸= 2. Thus *r*
∈ {0*,* 1*,* 3*,* 4*,* 5*,* 6*,* 7*,* 8}. Let *s* ≡ 9 − *r* mod 7;
that is, *s* = 9 − *r* if 9 − *r \<* 7, otherwise *s* = 2−*r*. The strategy of *A* is as follows. *A* writes down a number *s* ∈ *M*. To each move *x* of *B*, he responds with 7−*x*. If it is *B*′*s* last move, we have a number

![](media/image12.png){width="2.2222222222222223in" height="1.0in"}

370 13. Games

of (2*n* − 1) digits with digital sum *s* + 7(*n* − 1), which is congruent to *s* + *r* mod 9. But we have *s* + *r* = 9 or *s* + *r* = 2. To get a number divisible by, 9 *B* would have to add 0 or 7.
Neither is permissible. Thus *A* wins (BWM 1984).

26. *A* can force a win by making *p* and *q* both even if initially at least one of *p* and *q* is odd. *B* is forced to make at least one of *p* or *q* odd. *A* restores the losing position for *B*.

27. Two odd piles are losing. From any other position, one can move to two odd piles. From two odd piles, one is forced to move to even or odd. From this position one throws away the odd pile and splits the even pile into two odd piles. Finally, we move to (1*,* 1) and win.

28. Suppose that *n* = 2*k* + 1. In that case *A* wins by subdividing the numbers into successive pairs and taking the lonely remaining number. If *B* takes any number of a pair, then *A* takes the other element of the pair.

Now suppose that *n* = 2*k*. In that case *B* wins by always taking odd numbers except two odd numbers *r, s* divisible by 3. *A* is always forced to take even numbers. At the next to last move, there will remain two even numbers *e*1*, e*2 and the odd numbers *r, s*. If *A* takes an odd number, then *B* takes the other odd number and wins.
Otherwise *A* sticks to taking an even number, in which case *B* takes the other even number and wins again since gcd(*r, s*) ≥ 3.

29. Symmetry is the most important strategy in games. Look at the center of the board. For a small odd height and a large even length it will be as indicated in Fig. 13.1. Unfortunately the center of the board is not a lattice point. The first move should be to color the square in Fig. 13.1. Now the board is split into two parts which are symmetric with respect to the line *s*. *B* is forced to color a square on one side of *s*. *A* responds by removing the square which is symmetric to *B*′*s* choice with respect to *s*.

  -----------------------------------------------------------------------
  H        H        H        H                 H                    -------- -------- -------- -------- -------- -------- -------- --------
                                                                 

           H        H                 H                 H        

                                                                 

  H        H                 H                 H                 

                                                                    -----------------------------------------------------------------------

r

*s*\ Fig. 13.1 Fig. 13.2\ 30. We place arrows on the board as in Fig. 13.2. *A* starts by placing the knight on a cell from which an arrow starts and he moves in the direction of the arrow. Then *B* can only move to the start of another arrow, and *A* moves to the end of that arrow.

31. Denote the positions from left to right by *p*1*, p*2*, p*3*, p*4. The game splits into two parts: the beginning and the endgame.
The endgame starts as soon as *B* puts a digit into the first position.
It is clear that, in the beginning, *A* must not call digits 1 to 3 or digits 6 to 9, since *B* would place them into *p*1, a small digit into the upper cell and a large digit into the lower cell, and would go over to the endgame. If the difference of the first digits is not greater than 3, then the difference of the numbers is at most 3999. If *A* first calls 4 (or 5), then *B* can secure a difference for himself not less than 4000 by immediately starting the endgame with the move *p*1 =and then put all digits 0 (9) into positions *p*2*, p*3*, p*4 until they are filled.= 4=or *p*1 == ∗=,

14

Further Strategies

In this chapter we collect further important strategies of somewhat lesser scope, except the first one on graph theory, which became quite important in recent IMOs. They will be illustrated by a few examples followed by problems with solutions. All of these ideas occurred in preceding problems and solutions. But still, it is useful to stress them again. By separate treatment, they will be better remembered.

14.1 Graph Theory

Graphs are important objects of discrete mathematics. *A graph* is an object consisting a set of *points* or *vertices*, some of which are connected by *lines* or *edges*. If you can visit all vertices by walking on edges, the graph is *connected*. A connected graph without closed *paths* or *cycles* is called a *tree*. Usually the edges of a graph are not oriented. But if the edges are oriented, then we have a *digraph*. An example is a one-way road system. The directed cycles are often called *circuits*. A vertex *v* has *degree* or *valency m* if *m* edges end at *v*. The mapping *f* of a set *A* into itself is usually represented by a digraph, where we draw an arrow from the vertex *a* to its image *f* (*a*). Points with *a* = *f* (*a*) are the *fixed points* of the mapping. A permutation of a set *A* is a one-to-one mapping of *A* onto itself. Since *a* ̸= *b* ⇒ *f* (*a*) ̸= *f* (*b*), the graph of *f* splits into cycles. Most of the problems in this section belong to the box principle, some to combinatorics.

374 14. Further Strategies

Problems

1. At an international meeting, 1985 persons participated. In each subset of three participants, there were at least two persons, who spoke the same language. If each person speaks at most five languages, then at least 200 persons spoke the same language (BMO 1987).

2. Can you draw a triangular map inside a pentagon, so that each vertex has an even degree?

3. In how many ways can you triangulate a convex *n*-gon by (*n* − 3) nonintersecting diagonals, so that every triangle has at least one side in common with the *n*-gon?

4. Prove that, in any set of 17 persons, in which every person is acqainted with exactly four other persons, there exist two persons, who do not know each other and have no common acquaintances (AUO 1992).

5. Consider nine points in space, no four of which are coplanar. Each pair of points is joined by an edge (that is, a line segment), and each edge is either colored blue or red or left uncolored. Find the smallest value of *n* such that whenever exactly *n* edges are colored, the set of colored edges necessarily contains a triangle all of whose edges have the same color (IMO 1992).

6. We assign an arrow to each edge of a convex polyhedron, so that at least one arrow starts at each vertex, and at least one arrow arrives.
Prove that there exist two faces of the polyhedron, so that you can trace their perimeters in the direction of the arrows (BWM).

7. Let *S* be a set of *n* points in space (*n* ≥ 3). The segments joining these segments are of distinct length, and *r* of these segments are colored *red*. Let *m* be the smallest integer for which *m* ≥ 2·*r/n*. Prove that there always exists a path of *m* red segments with their lengths sorted increasingly (BWM).

8. In a set of *n* persons, any subset of four contains a person who knows the other three persons. Prove that there exists a person who knows all the others. (If A knows B then B knows A.)

9. Two black knights stand on the lower corners of a 3 × 3 chessboard, and two white knights on the upper corners. White and black knights must be interchanged by legal moves onto free squares.
Find the minimum number of moves needed (quoted by Lucas in 1894 from an earlier source in 1512).

10. In a set *S* of 2*n* persons there are two with an even number of common friends.

14.2 Infinite Descent

We consider one of the oldest proof strategies going back to the Pythagoreans in the fifth century b.c. It is an *impossibility proof* especially useful in *Number Theory*. The main idea is as follows: We want to prove that (usually) a polynomial equation\ *f* (*x, y, z, ···*) = 0 (1)has no solution in positive integers. One shows: *If (1) is true for some positive integers a, b, c, ···, then* (1) *would be true for the smaller positive integers*

14.3 Working Backwards 377

Similarly, one proves that

*x*2 *s*+ *y*2 *s*+ *z*2 *s*+ *u*2 *s*= 22*s*+1*xsyszsus,* for every *s* ∈ N*,* (4)

that is, for every *s* ∈ N *x/*2*s, y/*2*s, z/*2*s, u/*2*s*are positive integers. Contradiction!

Problems

11. 2*n* + 1 (*n* ≥ 1) integral weights are given. If we remove any of the weights, the remaining 2*n* weights can be split into two heaps of equal weights. Prove that all weights are equal.

12. Can a cube be partitioned into finitely many cubes of different sizes?

13. The equation 8*x*4+ 4*y*4+ 2*z*4= *t*4has no solutions in positive integers.

14. Find the integral solutions of

\(a\) *x*3− 3*y*3− 9*z*3= 0, (b) 5*x*3+ 11*y*3+ 13*z*3= 0, (c) *x*4+ *y*4= *z*4.

15. Let (*x, y*) be a solution *x*2+ *xy* − *y*2= 1 in positive integers. Prove that

\(a\) gcd(*x, y*) = 1; (b) if *x* = *y* then *x* = *y* = 1; (c) *x* ≤
*y \<* 2*x*;

\(d\) (*x* + *y, x* + 2*y*) and (2*x* − *y,* −*x* + *y*) are also solutions. Construct an infinite sequence of solutions, and prove that they comprise all solutions.

16. Find all integral solutions of 10*x*3+ 20*y*3+ 1992*xyz* = 1993*z*3.

14.3 Working Backwards

*Working Backwards* is one of the oldest problem-solving strategies, used since antiquity. The ancient Greeks used the method in *construction problems*. They assumed that an object is already constructed, and they worked backwards to the data, which were actually given. The idea works well if the problem does not branch too much in backstepping. What was the situation one step before? What was the situation two steps before? There should be few possibilities before each backward step.

We will illustrate the method by some typical problems. Jacobi in the last century used to stress: *You must always invert*! His dictum proved very fruitful to him. At that time the most popular subject was *Elliptic Integrals*. By applying his dictum, he inverted elliptic integrals and so made his greatest discovery, the *elliptic functions*, which were far easier to handle than their inverses, the elliptic integrals. A very free interpretation of his dictum allows us to progress in hopeless situations. In fact, we used this method whenever we assumed the existence a solution and derived a contradiction from it.
So this method is used in innumerable instances without mentioning its name. It is closely related to **Infinite Descent**.

384 14. Further Strategies

Solutions

1. The proposition is certainly true, if one person speaks a common language with the other 1984, since 1984*/*4 *\>* 200. Hence we assume that there is a pair {*P*1*, P*2}, with no common language. This pair forms 1983 triples with the remaining 1983 persons, of which each one has a common language with *P*1 or *P*2 (or both). Hence one of the pair, say *P*1, has a common language with 992 persons. Since *P*1 speaks at most 5 languages, one of these is spoken at least by 199 of the 992. Then the language is spoken at least by 199+1=200 persons, including *P*1.

2. Suppose there exists such a map. Since the degree of each vertex is even, we can color the plane *red* or *blue* so that countries with a common boundary are colored differently. Let the outside of the pentagon be colored red, and suppose *r* and *b* are the numbers of red and blue triangles, respectively. We count the number of edges in two ways:\ Every blue triangle is bounded by three edges. In this way the edges are counted exacly once, that is, *k* = 3*b*.

Theredcountriesareboundedby*k* = 3*r*+5edges.Thus3*b* = 3*r*+5,acontradiction.

3. Let *n \>* 4. One vertex *v*1 can be chosen in *n* ways. We connect its neighbors by a diagonal *d*1. The next diagonal can be chosen in 2 ways: *d*2 = *v*3*en*, or *d*2 = *e*2*en*−1.

Similarly, we can choose each of the diagonals *d*3*, ··· , dn*−3 in two ways. Thus there triangulation contains triangles belonging to two neighboring sides of the *n*-gon. are *n* · 2*n*−4ways to choose vertex *v*1 and the diagonals *d*1*,* ... *, dn*−3. Each such Hence we have counted each triangulation twice. The final result is *n* ·
2*n*−5. For *n* = 4, the formula is also correct.

4. Every person is represented by a point in the plane. Two points are joined by a line, if the corresponding persons know each other. We get a graph with vertices as persons and edges as acquaintances.

We proceed by contradiction. Suppose that every vertex *A* is joined with each of the 16 others either directly or via a third person. *A* is joined by edges with exactly four other vertices, of which each is joined with exactly three additional vertices. Thus in the graph there are no additional vertices, and all 17 vertices are distinct. All other edges, of which there are 17 · 4*/*2 − 16 = 18, can join only outer points in Fig. 14.4. Everyone of these 18 edges defines a cycle through *A* consisting of 5 edges. Because of the arbitrary choice of *A*, 18 such cycles also pass through each of the other 16 points.
Each cycle passes through 5 vertices. Hence there are altogether 18 ·
17*/*5 cycles. But this is impossible, since the number of cycles is an integer.

5. The answer is *n* = 33. It is easy to check that 9 points are joined by 36 edges. If 33 edges are colored, then 3 edges remain uncolored. Choose 3 points of the 9 which are endpoints of the three uncolored edges. Then the remaining 6 points are joined with colored edges. We will show that among them there exists a monochromatic triangle. Choose any of the 6 points, say *A*. Of the 5 edges with endpoint *A*, at least 3 have the same color, for instance *AB*, *AC*, *AD*. Then one of the four triangles *ABC*, *ACD*, *ABD* and *BCD* is monochromatic.

On the other hand, there exists a coloring of 32 edges (Fig. 14.5, where the thick lines are red, and the thin lines are blue) without a monochromatic triangle. Hence *n* = 33 is the minimum number of edges, such that, for any of their coloring with two colors, there exists a monochromatic triangle.

+-------------+-------------+-------------+-------------+-------------+
| <table>     | > pppppppp  |             |             |             |
| <colgroup>  | ppppppppppp |             |             |             |
| <col        | ppppppppppp |             |             |             |
|  style="wid | ppppppppppp |             |             |             |
| th: 50%" /> | ppppppppppp |             |             |             |
| <col        | ppppppppppp |             |             |             |
|  style="wid | ppppppppppp |             |             |             |
| th: 50%" /> | ppppppppppp |             |             |             |
| </colgroup> | ppppppppppp |             |             |             |
| <thead>     | ppppppppppp |             |             |             |
| <tr clas    | ppppppppppp |             |             |             |
| s="header"> | ppppppppppp |             |             |             |
| <th><       | ppppppppppp |             |             |             |
| blockquote> | ppppppppppp |             |             |             |
| <p><strong> | ppppppppppp |             |             |             |
| q</strong>  | ppppppppppp |             |             |             |
| <strong>q</ | ppppppppppp |             |             |             |
| strong></p> | ppppppppppp |             |             |             |
| </block     | ppppppppppp |             |             |             |
| quote></th> | ppppppppppp |             |             |             |
| <t          | ppppppppppp |             |             |             |
| h><strong>q | ppppppppppp |             |             |             |
| </strong> < | ppppppppppp |             |             |             |
| strong>q</s | > **PP      |             |             |             |
| trong></th> | > \         |             |             |             |
| </tr>       | "\"\"\"\"** |             |             |             |
| </thead>    |             |             |             |             |
| <tbody>     |             |             |             |             |
| <tr c       |             |             |             |             |
| lass="odd"> |             |             |             |             |
| <td co      |             |             |             |             |
| lspan="2">< |             |             |             |             |
| blockquote> |             |             |             |             |
| <p>Fig.     |             |             |             |             |
| 14.4<strong |             |             |             |             |
| >q</strong> |             |             |             |             |
|  <strong>q  |             |             |             |             |
| q</strong>  |             |             |             |             |
| <strong>q</ |             |             |             |             |
| strong></p> |             |             |             |             |
| </block     |             |             |             |             |
| quote></td> |             |             |             |             |
| </tr>       |             |             |             |             |
| </tbody>    |             |             |             |             |
| </table>    |             |             |             |             |
|             |             |             |             |             |
| **q**       |             |             |             |             |
+=============+=============+=============+=============+=============+
|             |             |             |             |             |
+-------------+-------------+-------------+-------------+-------------+
|             |             |             |             |             |
+-------------+-------------+-------------+-------------+-------------+

386 14. Further Strategies

11. Let *w*1*, ··· , w*2*n*+1 be the integral weights. Since any 2*n* of the weights balance, the sum of any of the 2*n* weights must be even. This implies that all the weights have the same parity. If they are even, we set *wi* ← *wi/*2, if they are odd we set *wi* ←(*wi*−1)*/*2. In each case we get a new set of weights with the same balancing property. Applying this reduction repeatedly, we see that the *wi* are congruent mod 2*k*for all *k*. This implies that all *wi* are equal.

Generalize the result to rational weights, which is easy, and to irrational weights, which is more difficult.

12. (a) Suppose a square *Q* is partitioned into different squares.
Then the smallest square cannot touch the boundary of the square.

\(b\) Suppose a cube *C* has a decomposition into different subcubes *Ci*. Let *Q* be the bottom of *C*. The subcubes standing on *Q* generate a partition of *Q* into different subsquares. Let *Q*1 be the smallest of these squares, and let *C*1 be the corresponding cube. Now *Q*1 is surrounded by larger squares. The corresponding cubes form a"well" and *C*1 lies in the bottom of the well. No other cube will fit into this well.

\(c\) Construct on *C*1 an infinite tower of ever smaller cubes.
Contradiction!13. Use infinite descent.

14. In (a) and (c) use infinite descent. (c) is nontrivial but easily accessible. In (b) any three numbers *x, y, z* satisfying the equation are divisible by 13.

15. The hints should suffice to solve the problem.

16. Use infinite descent.

17. This sounds like a problem that can be treated by invariance.
Starting with some distribution around the circle and using the transformation, we get a sequence

011101000 → 011000111 → 010110110 → 000100101 ... *.*

A superficial look does not reveal an invariant. So we think of the strategy of **working backwards**. It is often applicable if invariance does not work. Suppose the aim is attainable. We have 9 ones (for the first time). One step before we must have 9 zeros, (9), this is not possible.and still one step before we have 9 changes 0−1−0 −1−.... With an odd number

18. This is a difficult problem. It is not clear how to tackle it, except that we think of Jacobi's dictum: **You must always invert!** Instead of putting the weights on the pans we take them from the pan.
Instead of the word *W=RRL··· RRL* we must generate the transposed word *WT=LRR··· LRR*. This is considerably simpler. We can assume that *WT*starts with *L*. In the other case, we interchange the pans.
Onto the left pan we put *m*1 *\> m*3 *\> m*5 *\>* ... and onto the right pan *m*2 *\> m*4 *\> m*6 .... Then initially the left pan outweighs, independently of where the lightest weight is. *If, during the removing process, the scale changes, then take away the heaviest weight; otherwise take away the lightest weight*! The realization of a word is generated as follows: *change of letters* → *remove heaviest weight. No change*→ *remove lightest m*5 *\> m*7 *\> m*9 on the left pan and *m*2 *\> m*4 *\> m*6 *\> m*8 *\> m*10 on the right pan, *weight*. For example, *W=RLLRRRLRRL*→ *WT*=*LRRLRRRLLR*. With *m*1 *\> m*3 *\> WT*leads to the sequence of removals *m*1*, m*10*, m*2*, m*3*, m*9*, m*8*, m*4*, m*7*, m*5*, m*6. One gets *W* by taking away the weights in reverse order.

References

\[1\] E.J. Barbeau, *Polynomials*, Springer-Verlag, New York, 1989.

\[2\] E.J. Barbeau, M.S. Klamkin, O.J. Moser, *Five Hundred Mathematical Chal* *lenges*, Mathematical Association of America, Washington, DC, 1995.

\[3\] O. Bottema et al., *Geometric Inequalities*, Nordhoff, Groningen, 1969.

\[4\] D. Cohen, *Basic Techniques of Combinatorial Theory*, John Wiley
& Sons, New York, 1978.

\[5\] H.S.M. Coxeter, S.L. Greitzer, *Geometry Revisited*, NML-19, Mathematical Association of America, Washington, DC, 1967.

\[6\] H. D¨orrie, *100 Great Problems With Elementary Solutions*, Dover, New York, 1987.

\[7\] A. Engel, *Exploring Mathematics With Your Computer*, NML-35, Mathemat ical Association of America, Washington, DC, 1993.

\[8\] All books by Martin Gardner.

\[9\] R.L. Graham, N. Patashnik, and D. Knuth, *Concrete Mathematics*, Addison-- Wesley, Reading, MA, 1989.

\[10\] S.L. Greitzer, *International Mathematical Olympiads 1959--1977*, Mathe matical Association of America, Washington, DC, 1978.

\[11\] D. Fomin, S. Genkin, I. Itenberg, *Mathematical Circles*, Mathematical Worlds, Vol. 7, American Mathematical Society, Boston, MA, 1966.

398 References

\[12\] D. Fomin, A. Kirichenko, *Leningrad Mathematical Olympiads 1987--1991*, MathPro Press, Westford, MA, 1994.

\[13\] G.H. Hardy and E.M. Wright, *An Introduction to the Theory of Numbers*, Oxford University Press, Oxford, 1983.

\[14\] D. Hilbert, S. Cohn--Vossen, *Geometry and the Imagination*, Chelsea, New York, 1952.

\[15\] All books by Ross Honsberger, Mathematical Association of America, Wash ington, DC.

\[16\] M.S. Klamkin, *International Mathematical Olympiads 1979--1985*, Mathe matical Association of America, Washington, DC, 1986.

\[17\] M.S. Klamkin, *USA Mathematical Olympiads 1972--1986*, Mathematical As sociation of America„ Washington, DC, 1986.

\[18\] L. Larson, *Problem Solving Through Problems*, Springer-Verlag, New York, 1983.

\[19\] E. Lozansky, C. Rousseau, *Winning Solutions*, Springer-Verlag, New York, 1996.

\[20\] D.S. Mitrinovic, *Elementary Inequalities*, Nordhoff, Groningen, 1964.

\[21\] D.J. Newman, *A Problem Seminar*, Springer-Verlag, New York, 1982.

\[22\] G. Polya, *How To Solve It*, Princeton University Press, Princeton, NJ, 1945.

\[23\] G. Polya, *Mathematics and Plausible Reasoning*, Princeton University Press, Princeton, NJ, 1954.

\[24\] G. Polya, *Mathematical Discovery*, John Wiley & Sons, New York, 1962.

\[25\] H. Rademacher, O. Toeplitz, *The Enjoinment of Mathematics*, Princeton Uni versity Press, Princeton, NJ, 1957.

\[26\] D.O. Shklarsky, N.N. Chentzov, I.M. Yaglom, *The USSR Olympiad Problem* *Book*, W.H. Freeman, San Francisco, CA, 1962.

\[27\] W. Sierpinski, *A Selection of Problems in the Theory of Numbers*, Pergamon Press, New York, 1964.

\[28\] R. Sprague, *Recreation in Mathematics*, Blackie, London 1963.

\[29\] H. Steinhaus, *One Hundred Problems In Elementary Mathematics*, Basic Books, New York, 1964.

\[30\] P.J. Taylor, ed., *Tournament of the Towns*, Australian Mathematics Trust, University of Canberra, Belconnen ACT.

References 399

\[31\] B.L. van der Waerden, Einfall und ¨Uberlegung, Birkh¨auser, 1973.

\[32\] A. and I. Yaglom, *Challenging Mathematical Problems With Elementary* *Solutions*, Vol. I and Vol. II, Dover, New York, 1987.

Index

**A**lgorithm 1, 2--5, 7, 14, 87\ Coding 93\ Decoding 93\ Euclidean 117, 118, 147\ Andr´e, Desir´e 97\ Arithmetic progression 12, 19, 46 Automatic solution 85, 129, 145

**B**arlotti, A. 301\ Bijective proof 87, 89, 95 Binet's formula 205\ Box principle 59--83\ de Bruijn, G.N. 241

**C**arlson's inequality 175--176\ Catalan numbers 99, 101\ Cauchy-Schwarz inequality 167, 175, 178, 188, 192, 196, 199--201, 203\ Cayley's formula 92, 116\ Characteristic equation 107, 221--222, 231--232, 243\ Chebyshev inequality 168, 186, 188, 198, 203\ Coloring proofs 25--37\ Combinatorial proof 87\ Complex numbers 294--298, 306--309

Concavity 177--179\ Conjugate numbers 365--367, 375--377 Convergence rate 223, 229, 231, 232 Convexity 172, 176--179, 197--198, 200 Counting by bijection 89, 95, 99

**D**escent 125, 129, 157, 374, 386\ Difference equations 97--98, 107, 221 Dilworth 57\ Dirichlet 59\ Discriminant 19, 22\ Divide and conquer 87, 94, 105

**E**numerative combinatorics 85--116 Erd˝os 61, 70, 152, 340, 353\ Erd˝os-Mordell inequality 353\ Extremal principle 7, 39--57

**F**ermat's theorem 119--120, 128, 149 Fermat-Euler theorem 120, 239\ Fibonacci sequence 205, 209, 223, 285 Frobenius problem 156--157\ Functional equation 221--222, 256, 271--288\ Cauchy's 271\ d'Alambert's 271\ Jensen's 271

402 Index

**G**allai, T. 43\ Game 1, 361--371\ Bachet's 362\ Wytthoff's 362, 366\ of Euclid 365\ Greedy algorithm 46, 167\ Graph 92, 97, 113--115, 384--385 complete 64--65, 77

**H**adwiger-Finsler inequality 173--174 Heuristic principle 1, 4, 39

**I**nduction principle 205--220 Inequalities 161--204\ Integer part 120, 382--383 Involution 101, 107

**J**acobi, C.G.J. 70, 377, 386, 387 Josephus problem 226

**K**elly, L.M. 43, 50\ Kuczma, M. 241

**L**emoine point 306, 356

**M**orse-Thue sequence 227, 237

**N**apoleonic triangles 296, 309 Nesbitt's inequality 163, 169 Number theory 117--159

**P**arity 2, 14--15, 19--22, 25, 35, 62,\ 75, 139, 151, 212, 281, 347, 367, 375 Pell-Fermat equation 128, 140, 145, 153 Permutation 88, 96, 99, 227, 237--238, 273\ fixed point free 100\ Polynomials 245--269\ antisymmetric 254\ degree 245, 249\ elementary symmetric 165, 167,\ 251, 253--254\ monic 246\ reciprocal 250--251\ symmetric 251--252\ Pompeiu's theorem 332\ Position 361\ losing 361\ winning 361

Principle of inclusion and exclusion (PIE) 99, 102, 114\ Probabilistic interpretation 96--97, 210 Product rule 87, 88, 96\ Product-sum rule 88, 90, 91\ Pr¨ufer code 93\ Ptolemy's inequality 297, 357\ theorem 319, 332

**R**amsey, F.P. 59\ Numbers 59, 63, 66, 67\ Rearrangement inequality 167, 178, 188, 193--194, 203\ Reﬂection principle 99\ Recursion 40, 87, 90, 91, 97, 108 Rooks 44--45, 48, 51, 72, 100, 104 Roots 246\ of unity 126, 154, 247--249\ 259--263\ multiplicity 246\ rational 246

**S**chur, I. 63, 66, 78\ Sequences 221--243\ Shrinking squares 7, 15\ Sieve formula 99\ Stirling numbers 91, 102\ Sum free sets 63--67, 70, 78\ Sum rule 87, 89, 99\ Sylvester 43, 50, 156--157\ Symmedian 356\ Symmetry 7, 97, 115, 292, 370\ System\ binary 46, 226, 234, 237, 242, 280, 286\ ternary 46\ Szekeres 61

**T**ree 92\ labeled 92\ Transformation geometry 309--317 triangle inequality 42, 51, 164--166, 177--178, 187, 189, 192--193\ Trigonometric substitution 177, 179

**V**an der Waerden 342\ Vectors 289--294, 298--299, 301--306

**W**eierstraß 52, 176

  -----------------------------------------------------------------------
  Weitzenb¨ock 170 Weyl,  Index                   403   H. 71                                              ----------------------- ----------------------- -----------------------
                          Working backwards 15,                              377, 386--387           

  -----------------------------------------------------------------------

**Z**eckendorf's theorem 209, 285

![](media/image13.png){width="5.025in" height="8.391683070866142in"}

Problem Books in Mathematics *(continued)*

**An Outline of Set Theory**\ by *James M. Henle*

**Demography Through Problems**\ by *Nathan Keyfitz and John A. Beekman*

**Theorems and Problems in Functional Analysis** by *A.A. Kirillov and A.D. Gvishiani*

**Exercises in Classical Ring Theory** by *T.Y. Lam*

**Problem-Solving Through Problems** by *Loren C. Larson*

**Winning Solutions**\ by *Edward Lozansky and Cecil Rosseau*

**A Problem Seminar**\ by *Donald J. Newman*

**Exercises in Number Theory**\ by *D.P. Parent*

**Contests in Higher Mathematics:**\ **Miklos Schweitzer Competitions 1962-1991** by *Gdbor J. Szekely (editor)*

**Berkeley Problems in Mathematics**\ by *Paulo Ney de Souza and Jorge-Nuno Silva*
